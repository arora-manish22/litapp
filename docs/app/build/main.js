webpackJsonp([22],{134:function(t,e,n){"use strict";n.d(e,"a",function(){return s});n(0);var r=n(61),o=(n.n(r),n(42),n(397)),a=(n(71),n(66),n(53),n(38),n(69)),s=function(){function t(t,e,n,r,o){var s=this;this.api=t,this.s=e,this.settings=n,this.user=r,this.storage=o,this.ready=new Promise(function(t,e){Promise.all([s.settings.load(),s.user.onReady(),s.s.onReady(),s.storage.get(a.d)]).then(function(e){if(!s.settings.allSettings.cachelists||!s.user.isLoggedIn())return t(),void(e[3]&&s.storage.remove(a.d));e[3]&&(s.lists=e[3]),s.query(!0).subscribe(function(e){var n=0;e.forEach(function(r,o){s.getById(r.urlname,!0).subscribe(function(r){++n==e.length&&t()})})})})})}return t.prototype.onReady=function(){return this.ready},t.prototype.query=function(t){var e=this;if(this.lists)return r.Observable.of(this.lists);var n;return t||(n=this.api.showLoader()),this.api.get("3/users/"+this.user.getId()+"/lists").map(function(t){return n&&n.dismiss(),t.error?(e.api.showToast(),[]):(e.lists=t.map(function(t){return new o.a({id:t.id,urlname:t.urlname,name:t.title,description:t.description,visibility:!t.is_private,size:t.stories_count,isdeletable:t.is_deletable,createtimestamp:t.created_at,updatetimestamp:t.updated_at})}),e.storage.set(a.d,e.lists),e.lists)}).catch(function(t){return n&&n.dismiss(),e.api.showToast(),console.error(t),r.Observable.of([])})},t.prototype.getById=function(t,e){var n=this,o=this.lists.find(function(e){return e.urlname==t});if(o.stories)return r.Observable.of(o);var s;return e||(s=this.api.showLoader()),r.Observable.create(function(e){var r=function(i,u){n.getListPage(t,s,Object.assign({},u),i).subscribe(function(t){if(t)if(u.stories?u.stories=u.stories.concat(t.stories):u=t,t.size>u.stories.length){var l=i+1;n.api.updateLoader(Math.round(u.stories.length/t.size*100)+"%"),r(l,u)}else n.lists[n.lists.indexOf(o)]=u,n.storage.set(a.d,n.lists),s&&s.dismiss(),e.next(u),e.complete()})};r(1,o)})},t.prototype.getListPage=function(t,e,n,a){var s=this;void 0===a&&(a=1);var i={page:a,sort:"dateadd"};return this.api.get("3/users/"+this.user.getId()+"/lists/"+t,{params:JSON.stringify(i)}).map(function(t){return t.works.data?(n||(n=new o.a({id:t.list.id,urlname:t.list.urlname,name:t.list.title,description:t.list.description,visibility:!t.list.is_private,size:t.list.stories_count,isdeletable:t.list.is_deletable,createtimestamp:t.list.created_at,updatetimestamp:t.list.updated_at})),n.stories=t.works.data.map(function(t){return s.s.extactFromList(t)}),n):(s.api.showToast(),null)}).catch(function(t){return e&&e.dismiss(),s.api.showToast(),console.error(t),r.Observable.of(null)})},t.prototype.addStory=function(t,e){var n=this;return this.api.put("3/stories/"+e.id+"/lists/"+t.id,{}).map(function(t){return t.success||n.api.showToast(),t.success}).catch(function(t){return n.api.showToast(),console.error(t),r.Observable.of(!1)}).subscribe(function(r){r&&(t.stories||(t.stories=[]),t.stories.push(e),t.size++,n.storage.set(a.d,n.lists))})},t.prototype.removeStory=function(t,e){var n=this;return this.api.delete("3/stories/"+e.id+"/lists/"+t.id).map(function(t){return t.success||n.api.showToast(),t.success}).catch(function(t){return n.api.showToast(),console.error(t),r.Observable.of(!1)}).subscribe(function(r){if(r){if(!t.stories)return;t.stories.forEach(function(n,r){n.id==e.id&&t.stories.splice(r,1)}),t.size--,n.storage.set(a.d,n.lists)}})},t.prototype.add=function(t){var e=this,n={title:t.name,description:t.description,isPrivate:t.visibility?0:1};return this.api.post("3/users/"+this.user.getId()+"/lists",n,void 0,!1).map(function(t){return t.success?(e.lists.push(new o.a({id:t.list.id,urlname:t.list.urlname,name:t.list.title,description:t.list.description,visibility:!t.list.is_private,size:t.list.stories_count,isdeletable:t.list.is_deletable,createtimestamp:t.list.created_at})),e.storage.set(a.d,e.lists),!0):(e.api.showToast(),!1)}).catch(function(t){return e.api.showToast(),console.error(t),r.Observable.of(!1)})},t.prototype.edit=function(t){var e=this;return this.api.patch("3/lists/"+t.id,{title:t.name,description:t.description,isPrivate:t.visibility?0:1}).map(function(n){return n.success?(e.lists.forEach(function(e){e.id==t.id&&(e.name=n.list.title,e.description=n.list.description,e.visibility=!n.list.is_private)}),e.storage.set(a.d,e.lists),!0):(e.api.showToast(n.error),!1)}).catch(function(t){return e.api.showToast(),console.error(t),r.Observable.of(!1)})},t.prototype.delete=function(t){var e=this;return this.api.delete("3/lists/"+t.id).map(function(n){return n.success?(e.lists.forEach(function(n,r){n.urlname==t.urlname&&e.lists.splice(r,1)}),e.storage.set(a.d,e.lists),!0):(e.api.showToast(n.error),!1)}).catch(function(t){return e.api.showToast(),console.error(t),r.Observable.of(!1)})},t.prototype.refresh=function(){return this.storage.remove(a.d),this.lists=null,this.query()},t}()},141:function(t,e,n){"use strict";n.d(e,"a",function(){return r});n(0),n(172),n(68);var r=function(){function t(t,e){var n=this;this.g=t,this.googleAnalytics=e,Promise.all([this.g.onReady()]).then(function(){try{Promise.all([n.googleAnalytics.startTrackerWithId("UA-142185587-2",120),n.googleAnalytics.setAnonymizeIp(!0),n.googleAnalytics.setAllowIDFACollection(!1),n.googleAnalytics.setAppVersion(n.g.getVersion().toString())]).then(function(){n.track("Startup")}).catch(function(t){return console.error("Error starting GoogleAnalytics",t)})}catch(t){console.error("Error starting GoogleAnalytics",t)}})}return t.prototype.track=function(t){this.googleAnalytics.trackView(t),console.log("Track",t)},t}()},142:function(t,e,n){"use strict";n(0),n(1);var r=n(61),o=(n(42),function(){return function(t){for(var e in t)this[e]=t[e]}}()),a=(n(66),n(95),n(53),n(71),n(69));n(38);n.d(e,"a",function(){return s});var s=function(){function t(t,e,n,r,o,s){var i=this;this.api=t,this.s=e,this.a=n,this.user=r,this.settings=o,this.storage=s,this.timeout=6e5,this.feedtimeout=(new Date).getTime()+this.timeout,this.feedbadge="",this.ready=new Promise(function(t,e){Promise.all([i.settings.load(),i.user.onReady()]).then(function(){i.settings.allSettings.checkforfeedupdates&&i.user.isLoggedIn()?(i.feedbadge="Â·",i.query().subscribe(function(e){e?i.storage.get(a.a).then(function(n){for(var r=0;r<e.length;r++)if(n==e[r].id){i.feedbadge=String(r);break}""==i.feedbadge&&(i.feedbadge="15+"),t()}):t()})):t()})})}return t.prototype.onReady=function(){return this.ready},t.prototype.query=function(t,e,n){var a=this;if(void 0===n&&(n=!1),!n&&!t&&this.feed&&(new Date).getTime()<this.feedtimeout)return r.Observable.of(this.feed);t&&this.feed||(this.feed=[]);var s;e&&(s=this.api.showLoader());var i={chunked:1,limit:10};return t&&(i.last_id=t),this.api.get("3/activity/wall?params="+JSON.stringify(i)).map(function(t){if(s&&s.dismiss(),!t.data)return a.api.showToast(),[];var e=t.data.map(function(t){var e="published-story"===t.action;try{return new o({id:t.id,timestamp:t.when,author:a.a.extractFromFeed(t.who),text:e?[]:Array.isArray(t.what)?t.what:["their profile"],story:e?a.s.extractFromFeed(t):void 0})}catch(t){return new o(null)}});return e.forEach(function(t){return a.feed.push(t)}),a.feedtimeout=(new Date).getTime()+a.timeout,e}).catch(function(t){return s&&s.dismiss(),a.api.showToast(),console.error(t),r.Observable.of([])})},t}()},241:function(t,e){function n(t){return Promise.resolve().then(function(){throw new Error("Cannot find module '"+t+"'.")})}n.keys=function(){return[]},n.resolve=n,t.exports=n,n.id=241},28:function(t,e,n){"use strict";n(141),n(38),n(66),n(95),n(134),n(142),n(68);var r=n(71);n(53);n.d(e,"a",function(){return r.a})},283:function(t,e,n){function r(t){var e=o[t];return e?n.e(e[1]).then(function(){return n(e[0])}):Promise.reject(new Error("Cannot find module '"+t+"'."))}var o={"../pages/account/account.module.ngfactory":[679,20],"../pages/author/author.module.ngfactory":[680,7],"../pages/explore/explore.module.ngfactory":[682,17],"../pages/feed/feed.module.ngfactory":[681,6],"../pages/following/following.module.ngfactory":[683,10],"../pages/history/history.module.ngfactory":[684,5],"../pages/list-create/list-create.module.ngfactory":[685,13],"../pages/list-list/list-list.module.ngfactory":[686,12],"../pages/list-view/list-view.module.ngfactory":[687,0],"../pages/login/login.module.ngfactory":[688,19],"../pages/search/search-popover.module.ngfactory":[689,15],"../pages/search/search.module.ngfactory":[690,1],"../pages/settings/settings.module.ngfactory":[691,18],"../pages/story-detail/story-detail.module.ngfactory":[692,9],"../pages/story-related/story-related.module.ngfactory":[693,4],"../pages/story-series/story-series.module.ngfactory":[694,3],"../pages/story-view/story-popover.module.ngfactory":[695,14],"../pages/story-view/story-view.module.ngfactory":[696,8],"../pages/tabs/tabs.module.ngfactory":[697,21],"../pages/top-list/top-list.module.ngfactory":[698,2],"../parts/bookmark-popover/bookmark-popover.module.ngfactory":[699,11],"../parts/export-popover/export-popover.module.ngfactory":[700,16]};r.keys=function(){return Object.keys(o)},r.id=283,t.exports=r},38:function(t,e,n){"use strict";n(0);var r=n(153),o=(n(1),n(57),n(51),{CORS_PROXY:"https://litapp-cors.herokuapp.com/"});n.d(e,"a",function(){return a});var a=function(){function t(t,e,n,r){this.http=t,this.translate=e,this.loadingCtrl=n,this.toastCtrl=r,this.apikey="70b3a71911b398a98d3dac695f34cf279c270ea0",this.appid="24b7c3f9d904ebd679299b1ce5506bc305a5ab40",this.corsProxy=o.CORS_PROXY||"",this.urls=this.getUrls();try{var a=location.search.substring(1),s=JSON.parse('{"'+decodeURI(a).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')+'"}');s.proxy&&(this.corsProxy=s.proxy,this.urls=this.getUrls())}catch(t){}}return t.prototype.getUrls=function(){return[this.corsProxy+"https://literotica.com/api",this.corsProxy+"https://search.literotica.com/api",this.corsProxy+"https://www.literotica.com",this.corsProxy+"https://raw.githubusercontent.com/theilluminatus/litapp/master",this.corsProxy+"https://literotica.com"]},t.prototype.get=function(t,e,n,o,a){if(n||(n={params:new r.g({encoder:new s})}),e){n.params=new r.g({encoder:new s});for(var i in e)n.params=n.params.set(i,e[i])}n.withCredentials=!0,n.params=n.params.set("apikey",this.apikey),n.params=n.params.set("appid",this.appid);var u=this.http.get(this.urls[o||0]+"/"+t,n);return a?u.timeout(a):u},t.prototype.post=function(t,e,n,r,o){return r&&(t.indexOf("?")>-1?t+="&apikey="+this.apikey+"&appid="+this.appid:t+="?apikey="+this.apikey+"&appid="+this.appid),this.http.post(this.urls[o||0]+"/"+t,e,n)},t.prototype.put=function(t,e,n){return this.http.put(this.urls[0]+"/"+t,e,n)},t.prototype.delete=function(t,e,n){return this.http.delete(this.urls[n||0]+"/"+t,e)},t.prototype.patch=function(t,e,n){return this.http.patch(this.urls[0]+"/"+t,e,n)},t.prototype.showLoader=function(){var t=this;return this.loader?this.loader:(this.loader=this.loadingCtrl.create({spinner:"crescent"}),this.loader.present(),this.loader.onDidDismiss(function(){t.loader=void 0}),this.loader)},t.prototype.updateLoader=function(t){this.loader&&this.loader.setContent(t)},t.prototype.hideLoader=function(){this.loader&&this.loader.dismiss().catch(function(){})},t.prototype.showToast=function(t,e,n){var r=this;return new Promise(function(o){r.translate.get(["LOAD_ERROR","CLOSE_BUTTON"]).subscribe(function(a){r.translations=a;var s=r.toastCtrl.create({message:t||r.translations.LOAD_ERROR,showCloseButton:!0,closeButtonText:n||r.translations.CLOSE_BUTTON,duration:e||3e3});s.present(),s.onDidDismiss(function(t){o(s)})})})},t}(),s=function(){function t(){}return t.prototype.encodeKey=function(t){return encodeURIComponent(t)},t.prototype.encodeValue=function(t){return encodeURIComponent(t)},t.prototype.decodeKey=function(t){return decodeURIComponent(t)},t.prototype.decodeValue=function(t){return decodeURIComponent(t)},t}()},392:function(t,e,n){"use strict";n.d(e,"a",function(){return r});var r=function(){return function(t){for(var e in t)this[e]=t[e]}}()},397:function(t,e,n){"use strict";n.d(e,"a",function(){return r});var r=function(){return function(t){for(var e in t)this[e]=t[e]}}()},401:function(t,e,n){"use strict";function r(t){return new N.a(t,{checkforfeedupdates:!0,checkforappupdates:!0,cachelists:!0,amoledBlackTheme:!1})}function o(t){return s._22(0,[s._18(402653184,1,{nav:0}),(t()(),s._20(-1,null,["\n\n\n    "])),(t()(),s.Z(2,0,null,null,67,"ion-menu",[["role","navigation"]],null,null,null,B.b,B.a)),s._17(6144,null,H.a,null,[j.a]),s.Y(4,245760,null,2,j.a,[Y.a,s.j,G.a,z.a,s.z,K.a,q.l,J.a,V.a],{content:[0,"content"]},null),s._18(335544320,2,{menuContent:0}),s._18(335544320,3,{menuNav:0}),(t()(),s._20(-1,0,["\n      "])),(t()(),s.Z(8,0,null,0,12,"ion-header",[],null,null,null,null,null)),s.Y(9,16384,null,0,Z.a,[G.a,s.j,s.z,[2,W.a]],null,null),(t()(),s._20(-1,null,["\n        "])),(t()(),s.Z(11,0,null,null,8,"ion-toolbar",[["class","toolbar"]],[[2,"statusbar-padding",null]],null,null,X.b,X.a)),s.Y(12,49152,null,0,Q.a,[G.a,s.j,s.z],null,null),(t()(),s._20(-1,3,["\n          "])),(t()(),s.Z(14,0,null,3,4,"ion-title",[],null,null,null,$.b,$.a)),s.Y(15,49152,null,0,tt.a,[G.a,s.j,s.z,[2,Q.a],[2,et.a]],null,null),(t()(),s._20(-1,0,["Literotica "])),(t()(),s.Z(17,0,null,0,1,"small",[],null,null,null,null,null)),(t()(),s._20(-1,null,["(unofficial)"])),(t()(),s._20(-1,3,["\n        "])),(t()(),s._20(-1,null,["\n      "])),(t()(),s._20(-1,0,["\n\n      "])),(t()(),s.Z(22,0,null,0,46,"ion-content",[],[[2,"statusbar-padding",null],[2,"has-refresher",null]],null,null,nt.b,nt.a)),s.Y(23,4374528,[[2,4]],0,rt.a,[G.a,z.a,J.a,s.j,s.z,V.a,K.a,s.u,[2,W.a],[2,ot.a]],null,null),(t()(),s._20(-1,1,["\n        "])),(t()(),s.Z(25,0,null,1,42,"ion-list",[],null,null,null,null,null)),s.Y(26,16384,null,0,at.a,[G.a,s.j,s.z,z.a,q.l,J.a],null,null),(t()(),s._20(-1,null,["\n\n          "])),(t()(),s.Z(28,0,null,null,8,"button",[["class","item item-block"],["ion-item",""],["menuClose",""]],null,[[null,"click"]],function(t,e,n){var r=!0,o=t.component;if("click"===e){r=!1!==s._13(t,34).close()&&r}if("click"===e){r=!1!==o.openPage("TabsPage")&&r}return r},st.b,st.a)),s.Y(29,1097728,null,3,it.a,[ut.a,G.a,s.j,s.z,[2,lt.a]],null,null),s._18(335544320,4,{contentLabel:0}),s._18(603979776,5,{_buttons:1}),s._18(603979776,6,{_icons:1}),s.Y(33,16384,null,0,ct.a,[],null,null),s.Y(34,16384,null,0,pt.a,[Y.a],{menuClose:[0,"menuClose"]},null),(t()(),s._20(35,2,["\n            ","\n          "])),s._14(131072,dt.a,[ht.a,s.g]),(t()(),s._20(-1,null,["\n\n          "])),(t()(),s.Z(38,0,null,null,8,"button",[["class","item item-block"],["ion-item",""],["menuClose",""]],null,[[null,"click"]],function(t,e,n){var r=!0,o=t.component;if("click"===e){r=!1!==s._13(t,44).close()&&r}if("click"===e){r=!1!==o.openLinkDialog()&&r}return r},st.b,st.a)),s.Y(39,1097728,null,3,it.a,[ut.a,G.a,s.j,s.z,[2,lt.a]],null,null),s._18(335544320,7,{contentLabel:0}),s._18(603979776,8,{_buttons:1}),s._18(603979776,9,{_icons:1}),s.Y(43,16384,null,0,ct.a,[],null,null),s.Y(44,16384,null,0,pt.a,[Y.a],{menuClose:[0,"menuClose"]},null),(t()(),s._20(45,2,["\n            ","\n          "])),s._14(131072,dt.a,[ht.a,s.g]),(t()(),s._20(-1,null,["\n\n          "])),(t()(),s.Z(48,0,null,null,8,"button",[["class","item item-block"],["ion-item",""],["menuClose",""]],null,[[null,"click"]],function(t,e,n){var r=!0,o=t.component;if("click"===e){r=!1!==s._13(t,54).close()&&r}if("click"===e){r=!1!==o.openPage("AccountPage")&&r}return r},st.b,st.a)),s.Y(49,1097728,null,3,it.a,[ut.a,G.a,s.j,s.z,[2,lt.a]],null,null),s._18(335544320,10,{contentLabel:0}),s._18(603979776,11,{_buttons:1}),s._18(603979776,12,{_icons:1}),s.Y(53,16384,null,0,ct.a,[],null,null),s.Y(54,16384,null,0,pt.a,[Y.a],{menuClose:[0,"menuClose"]},null),(t()(),s._20(55,2,["\n            ","\n          "])),s._14(131072,dt.a,[ht.a,s.g]),(t()(),s._20(-1,null,["\n\n          "])),(t()(),s.Z(58,0,null,null,8,"button",[["class","item item-block"],["ion-item",""],["menuClose",""]],null,[[null,"click"]],function(t,e,n){var r=!0,o=t.component;if("click"===e){r=!1!==s._13(t,64).close()&&r}if("click"===e){r=!1!==o.openPage("SettingsPage")&&r}return r},st.b,st.a)),s.Y(59,1097728,null,3,it.a,[ut.a,G.a,s.j,s.z,[2,lt.a]],null,null),s._18(335544320,13,{contentLabel:0}),s._18(603979776,14,{_buttons:1}),s._18(603979776,15,{_icons:1}),s.Y(63,16384,null,0,ct.a,[],null,null),s.Y(64,16384,null,0,pt.a,[Y.a],{menuClose:[0,"menuClose"]},null),(t()(),s._20(65,2,["\n            ","\n          "])),s._14(131072,dt.a,[ht.a,s.g]),(t()(),s._20(-1,null,["\n\n        "])),(t()(),s._20(-1,1,["\n      "])),(t()(),s._20(-1,0,["\n\n    "])),(t()(),s._20(-1,null,["\n    "])),(t()(),s.Z(71,0,null,null,2,"ion-nav",[["root","TabsPage"]],null,null,null,gt.b,gt.a)),s._17(6144,null,H.a,null,[ft.a]),s.Y(73,4374528,[[1,4],["content",4]],0,ft.a,[[2,W.a],[2,ot.a],V.a,G.a,z.a,s.j,s.u,s.z,s.i,q.l,mt.a,[2,yt.a],J.a,s.k],{root:[0,"root"]},null),(t()(),s._20(-1,null,["\n\n\n  "]))],function(t,e){t(e,4,0,s._13(e,73));t(e,34,0,"");t(e,44,0,"");t(e,54,0,"");t(e,64,0,"");t(e,73,0,"TabsPage")},function(t,e){t(e,11,0,s._13(e,12)._sbPadding);t(e,22,0,s._13(e,23).statusbarPadding,s._13(e,23)._hasRefresher);t(e,35,0,s._21(e,35,0,s._13(e,36).transform("MENU_HOME")));t(e,45,0,s._21(e,45,0,s._13(e,46).transform("MENU_OPENLINK")));t(e,55,0,s._21(e,55,0,s._13(e,56).transform("MENU_ACCOUNT")));t(e,65,0,s._21(e,65,0,s._13(e,66).transform("MENU_SETTINGS")))})}Object.defineProperty(e,"__esModule",{value:!0});var a=n(45),s=n(1),i=(n(0),n(153)),u=n(244),l=n(213),c=n(138),p=n(204),d=n(214),h=n(215),g=n(248),f=n(249),m=n(250),y=n(42),_=n(51),v=n(414),b=(n(57),n(198)),w=n(222),T=n(223),S=n(125),O=n(172),N=n(28),P=function(){function t(t,e,n,r,o,a,s,i,u,l,c,p,d,h){var g=this;this.platform=t,this.app=e,this.translate=n,this.webIntent=r,this.config=o,this.alertCtrl=a,this.toastCtrl=s,this.settings=i,this.analytics=u,this.api=l,this.g=c,this.s=p,this.l=d,this.f=h,this.initTranslate(),this.settings.load().then(function(){if(g.settings.allSettings.checkforappupdates&&g.g.checkForUpdates(),g.settings.allSettings.amoledBlackTheme){var t=document.createElement("link");t.setAttribute("href","./assets/black-theme.css"),t.setAttribute("rel","stylesheet"),document.head.appendChild(t)}}),this.catchShareIntent(),this.platform.resume.subscribe(function(){g.catchShareIntent()})}return t.prototype.catchShareIntent=function(){var t=this;this.platform.is("cordova")&&this.webIntent.getIntent().then(function(e){"android.intent.action.SEND"==e.action&&e.extras&&t.openURL(e.extras["android.intent.extra.TEXT"])})},t.prototype.initTranslate=function(){var t=this;this.translate.setDefaultLang("en");var e=this.translate.getBrowserLang();if(e)if("zh"===e){var n=this.translate.getBrowserCultureLang();n.match(/-CN|CHS|Hans/i)?this.translate.use("zh-cmn-Hans"):n.match(/-TW|CHT|Hant/i)&&this.translate.use("zh-cmn-Hant")}else this.translate.use(this.translate.getBrowserLang());else this.translate.use("en");this.translate.get(["BACK_BUTTON_TEXT"]).subscribe(function(e){t.config.set("ios","backButtonText",e.BACK_BUTTON_TEXT)})},t.prototype.openPage=function(t){"TabsPage"==t.title?this.nav.setRoot(t):this.nav.push(t)},t.prototype.openLinkDialog=function(t){var e=this;this.translate.get(["MENU_OPENLINK","OPENLINK_DESCRIPTION","OK_BUTTON","CANCEL_BUTTON"]).subscribe(function(t){e.alertCtrl.create({title:t.MENU_OPENLINK,message:t.OPENLINK_DESCRIPTION,inputs:[{name:"url",placeholder:"https://www.literotica.com/..."}],buttons:[{text:t.OK_BUTTON,handler:function(t){e.openURL(t.url)}},{text:t.CANCEL_BUTTON}]}).present()})},t.prototype.openURL=function(t){var e=this,n=/literotica\.com\/s\/([-a-zA-Z0-9._+]*)/g.exec(t);if(n)return this.nav.push("SearchPage",{storyurl:n[1]}),void this.translate.get(["OPENLINK_STORYWARNING"]).subscribe(function(t){e.toastCtrl.create({message:t.OPENLINK_STORYWARNING,duration:2e3,position:"bottom"}).present()});var r=/literotica\.com\/stories\/memberpage\.php\?.*uid=([0-9]*)/g.exec(t);if(r){this.nav.push("AuthorPage",{author:{id:r[1]}})}else this.translate.get(["OPENLINK_UNSUPPORTED"]).subscribe(function(t){e.toastCtrl.create({message:t.OPENLINK_UNSUPPORTED,duration:2e3,position:"bottom"}).present()})},t}(),C=function(t){return new v.a(t,"./assets/i18n/",".json")},L=function(){return function(){}}(),k=n(79),E=n(380),I=n(381),F=n(382),x=n(383),M=n(384),A=n(385),D=n(386),R=n(387),U=n(388),B=n(400),H=n(44),j=n(97),Y=n(34),G=n(3),z=n(6),K=n(37),q=n(10),J=n(12),V=n(13),Z=n(129),W=n(7),X=n(398),Q=n(54),$=n(389),tt=n(91),et=n(52),nt=n(390),rt=n(32),ot=n(31),at=n(64),st=n(190),it=n(25),ut=n(22),lt=n(58),ct=n(86),pt=n(170),dt=n(126),ht=n(40),gt=n(399),ft=n(70),mt=n(43),yt=n(23),_t=n(94),vt=n(96),bt=n(71),wt=n(141),Tt=n(38),St=n(68),Ot=n(66),Nt=n(134),Pt=n(142),Ct=s.X({encapsulation:2,styles:[],data:{}}),Lt=s.V("ng-component",P,function(t){return s._22(0,[(t()(),s.Z(0,0,null,null,1,"ng-component",[],null,null,null,o,Ct)),s.Y(1,49152,null,0,P,[z.a,V.a,ht.a,S.a,G.a,_t.a,vt.a,bt.a,wt.a,Tt.a,St.a,Ot.a,Nt.a,Pt.a],null,null)],null,null)},{},{},[]),kt=n(19),Et=n(180),It=n(245),Ft=n(133),xt=n(27),Mt=n(87),At=n(88),Dt=n(90),Rt=n(89),Ut=n(127),Bt=n(166),Ht=n(179),jt=n(41),Yt=n(132),Gt=n(191),zt=n(81),Kt=n(59),qt=n(184),Jt=n(109),Vt=n(128),Zt=n(182),Wt=n(203),Xt=n(53),Qt=n(95),$t=n(379),te=n(181),ee=n(171),ne=n(183),re=s.W(L,[k.b],function(t){return s._10([s._11(512,s.i,s.S,[[8,[E.a,I.a,F.a,x.a,M.a,A.a,D.a,R.a,U.a,Lt]],[3,s.i],s.s]),s._11(5120,s.r,s._9,[[3,s.r]]),s._11(4608,kt.l,kt.k,[s.r,[2,kt.t]]),s._11(5120,s.b,s._0,[]),s._11(5120,s.p,s._6,[]),s._11(5120,s.q,s._7,[]),s._11(4608,a.c,a.q,[kt.c]),s._11(6144,s.D,null,[a.c]),s._11(4608,a.f,Et.a,[]),s._11(5120,a.d,function(t,e,n,r,o){return[new a.k(t,e),new a.o(n),new a.n(r,o)]},[kt.c,s.u,kt.c,kt.c,a.f]),s._11(4608,a.e,a.e,[a.d,s.u]),s._11(135680,a.m,a.m,[kt.c]),s._11(4608,a.l,a.l,[a.e,a.m]),s._11(5120,It.a,u.d,[]),s._11(5120,It.c,u.e,[]),s._11(4608,It.b,u.c,[It.a,It.c]),s._11(5120,s.B,u.f,[a.l,It.b,s.u]),s._11(6144,a.p,null,[a.m]),s._11(4608,s.G,s.G,[s.u]),s._11(4608,a.h,a.h,[kt.c]),s._11(4608,a.i,a.i,[kt.c]),s._11(4608,Ft.b,u.b,[s.B,a.b]),s._11(4608,i.i,i.n,[kt.c,s.w,i.l]),s._11(4608,i.o,i.o,[i.i,i.m]),s._11(5120,i.a,function(t){return[t]},[i.o]),s._11(4608,i.k,i.k,[]),s._11(6144,i.j,null,[i.k]),s._11(4608,i.h,i.h,[i.j]),s._11(6144,i.b,null,[i.h]),s._11(5120,i.f,i.p,[i.b,[2,i.a]]),s._11(4608,i.c,i.c,[i.f]),s._11(4608,xt.r,xt.r,[]),s._11(4608,xt.d,xt.d,[]),s._11(5120,Mt.b,C,[i.c]),s._11(4608,At.a,At.b,[]),s._11(4608,Dt.b,Dt.a,[]),s._11(4608,Rt.b,Rt.a,[]),s._11(4608,Ut.a,Ut.a,[]),s._11(4608,ht.a,ht.a,[Ut.a,Mt.b,At.a,Dt.b,Rt.b,ht.b,ht.c]),s._11(4608,Bt.a,Bt.a,[V.a,G.a]),s._11(4608,_t.a,_t.a,[V.a,G.a]),s._11(4608,Ht.a,Ht.a,[]),s._11(4608,ut.a,ut.a,[]),s._11(4608,jt.a,jt.a,[z.a]),s._11(4608,K.a,K.a,[G.a,z.a,s.u,J.a]),s._11(4608,Yt.a,Yt.a,[V.a,G.a]),s._11(5120,kt.g,Gt.c,[kt.r,[2,kt.a],G.a]),s._11(4608,kt.f,kt.f,[kt.g]),s._11(5120,zt.b,zt.d,[V.a,zt.a]),s._11(5120,yt.a,yt.b,[V.a,zt.b,kt.f,Kt.b,s.i]),s._11(4608,qt.a,qt.a,[V.a,G.a,yt.a]),s._11(4608,Jt.a,Jt.a,[V.a,G.a]),s._11(4608,Vt.a,Vt.a,[V.a,G.a,yt.a]),s._11(4608,Zt.a,Zt.a,[G.a,z.a,J.a,V.a,q.l]),s._11(4608,vt.a,vt.a,[V.a,G.a]),s._11(4608,mt.a,mt.a,[z.a,G.a]),s._11(5120,Wt.a,Wt.c,[Wt.b]),s._11(4608,Tt.a,Tt.a,[i.c,ht.a,Yt.a,vt.a]),s._11(4608,Xt.a,Xt.a,[Tt.a,Wt.a,ht.a,vt.a]),s._11(4608,c.a,c.a,[]),s._11(4608,St.a,St.a,[Tt.a,Xt.a,Wt.a,ht.a,c.a,vt.a]),s._11(4608,O.a,O.a,[]),s._11(4608,wt.a,wt.a,[St.a,O.a]),s._11(4608,Qt.a,Qt.a,[Tt.a,Xt.a,Yt.a,vt.a]),s._11(4608,Ot.a,Ot.a,[Tt.a,Qt.a,Xt.a,St.a,Wt.a,ht.a]),s._11(5120,bt.a,r,[Wt.a]),s._11(4608,Nt.a,Nt.a,[Tt.a,Ot.a,bt.a,Xt.a,Wt.a]),s._11(4608,Pt.a,Pt.a,[Tt.a,Ot.a,Qt.a,Xt.a,bt.a,Wt.a]),s._11(4608,l.a,l.a,[]),s._11(4608,p.a,p.a,[]),s._11(4608,d.a,d.a,[]),s._11(4608,h.a,h.a,[]),s._11(4608,g.a,g.a,[]),s._11(4608,f.a,f.a,[]),s._11(4608,m.a,m.a,[]),s._11(4608,b.a,b.a,[]),s._11(4608,w.a,w.a,[]),s._11(4608,T.a,T.a,[]),s._11(4608,S.a,S.a,[]),s._11(512,kt.b,kt.b,[]),s._11(512,s.k,$t.a,[]),s._11(256,G.b,{preloadModules:!0},[]),s._11(1024,te.a,te.b,[]),s._11(1024,z.a,z.b,[a.b,te.a,s.u]),s._11(1024,G.a,G.c,[G.b,z.a]),s._11(512,J.a,J.a,[z.a]),s._11(512,Y.a,Y.a,[]),s._11(512,V.a,V.a,[G.a,z.a,[2,Y.a]]),s._11(512,q.l,q.l,[V.a]),s._11(256,zt.a,{links:[{loadChildren:"../pages/account/account.module.ngfactory#AccountPageModuleNgFactory",name:"AccountPage",segment:"account",priority:"low",defaultHistory:[]},{loadChildren:"../pages/author/author.module.ngfactory#AuthorPageModuleNgFactory",name:"AuthorPage",segment:"author",priority:"low",defaultHistory:[]},{loadChildren:"../pages/feed/feed.module.ngfactory#FeedPageModuleNgFactory",name:"FeedPage",segment:"feed",priority:"high",defaultHistory:[]},{loadChildren:"../pages/explore/explore.module.ngfactory#ExplorePageModuleNgFactory",name:"ExplorePage",segment:"explore",priority:"high",defaultHistory:[]},{loadChildren:"../pages/following/following.module.ngfactory#FollowingPageModuleNgFactory",name:"FollowingPage",segment:"following",priority:"low",defaultHistory:[]},{loadChildren:"../pages/history/history.module.ngfactory#HistoryPageModuleNgFactory",name:"HistoryPage",segment:"history",priority:"high",defaultHistory:[]},{loadChildren:"../pages/list-create/list-create.module.ngfactory#ListCreatePageModuleNgFactory",name:"ListCreatePage",segment:"list-create",priority:"low",defaultHistory:[]},{loadChildren:"../pages/list-list/list-list.module.ngfactory#ListListPageModuleNgFactory",name:"ListListPage",segment:"list-list",priority:"high",defaultHistory:[]},{loadChildren:"../pages/list-view/list-view.module.ngfactory#ListViewPageModuleNgFactory",name:"ListViewPage",segment:"list-view",priority:"low",defaultHistory:[]},{loadChildren:"../pages/login/login.module.ngfactory#LoginPageModuleNgFactory",name:"LoginPage",segment:"login",priority:"low",defaultHistory:[]},{loadChildren:"../pages/search/search-popover.module.ngfactory#SearchPopoverModuleNgFactory",name:"SearchPopover",segment:"search-popover",priority:"low",defaultHistory:[]},{loadChildren:"../pages/search/search.module.ngfactory#SearchPageModuleNgFactory",name:"SearchPage",segment:"search",priority:"high",defaultHistory:[]},{loadChildren:"../pages/settings/settings.module.ngfactory#SettingsPageModuleNgFactory",name:"SettingsPage",segment:"settings",priority:"low",defaultHistory:[]},{loadChildren:"../pages/story-detail/story-detail.module.ngfactory#StoryDetailPageModuleNgFactory",name:"StoryDetailPage",segment:"story-detail",priority:"low",defaultHistory:[]},{loadChildren:"../pages/story-related/story-related.module.ngfactory#StoryRelatedPageModuleNgFactory",name:"StoryRelatedPage",segment:"story-related",priority:"low",defaultHistory:[]},{loadChildren:"../pages/story-series/story-series.module.ngfactory#StorySeriesPageModuleNgFactory",name:"StorySeriesPage",segment:"story-series",priority:"low",defaultHistory:[]},{loadChildren:"../pages/story-view/story-popover.module.ngfactory#StoryPopoverModuleNgFactory",name:"StoryPopover",segment:"story-popover",priority:"low",defaultHistory:[]},{loadChildren:"../pages/story-view/story-view.module.ngfactory#StoryViewPageModuleNgFactory",name:"StoryViewPage",segment:"story-view",priority:"low",defaultHistory:[]},{loadChildren:"../pages/tabs/tabs.module.ngfactory#TabsPageModuleNgFactory",name:"TabsPage",segment:"tabs",priority:"high",defaultHistory:[]},{loadChildren:"../pages/top-list/top-list.module.ngfactory#TopListPageModuleNgFactory",name:"TopListPage",segment:"top-list",priority:"low",defaultHistory:[]},{loadChildren:"../parts/bookmark-popover/bookmark-popover.module.ngfactory#BookmarkPopoverModuleNgFactory",name:"BookmarkPopover",segment:"bookmark-popover",priority:"low",defaultHistory:[]},{loadChildren:"../parts/export-popover/export-popover.module.ngfactory#ExportPopoverModuleNgFactory",name:"ExportPopover",segment:"export-popover",priority:"low",defaultHistory:[]}]},[]),s._11(512,s.h,s.h,[]),s._11(512,ee.a,ee.a,[s.h]),s._11(1024,Kt.b,Kt.c,[ee.a,s.o]),s._11(1024,s.c,function(t,e,n,r,o,s,i,u,l,c,p,d,h){return[a.s(t),ne.a(e),Ht.b(n,r),Zt.b(o,s,i,u,l),Kt.d(c,p,d,h)]},[[2,s.t],G.a,z.a,J.a,G.a,z.a,J.a,V.a,q.l,G.a,zt.a,Kt.b,s.u]),s._11(512,s.d,s.d,[[2,s.c]]),s._11(131584,s.f,s.f,[s.u,s.T,s.o,s.k,s.i,s.d]),s._11(512,s.e,s.e,[s.f]),s._11(512,a.a,a.a,[[3,a.a]]),s._11(512,u.a,u.a,[]),s._11(512,i.e,i.e,[]),s._11(512,i.d,i.d,[]),s._11(512,_.a,_.a,[]),s._11(512,xt.p,xt.p,[]),s._11(512,xt.g,xt.g,[]),s._11(512,xt.n,xt.n,[]),s._11(512,Gt.a,Gt.a,[]),s._11(512,y.a,y.a,[]),s._11(512,L,L,[]),s._11(256,i.l,"XSRF-TOKEN",[]),s._11(256,i.m,"X-XSRF-TOKEN",[]),s._11(256,ht.c,void 0,[]),s._11(256,ht.b,void 0,[]),s._11(256,k.a,P,[]),s._11(256,kt.a,"/",[]),s._11(256,Wt.b,null,[])])}),oe=this;window.consoleLog=[],console=new Proxy(console,{get:function(t,e){var n=t[e];return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var o=n.apply(oe,t);try{window.consoleLog.push(JSON.parse(JSON.stringify({prop:e,args:t}))),window.consoleLog.length>50&&window.consoleLog.shift()}catch(t){}return o}}}),Object(s.M)(),Object(a.j)().bootstrapModuleFactory(re)},53:function(t,e,n){"use strict";n.d(e,"a",function(){return i});n(0);var r=n(61),o=(n.n(r),n(357)),a=(n.n(o),n(678)),s=(n.n(a),n(42),n(57),n(51),n(69)),i=(n(38),function(){function t(t,e,n,r){var o=this;this.api=t,this.storage=e,this.translate=n,this.toastCtrl=r,this.ready=new Promise(function(t,e){o.storage.get(s.i).then(function(e){e&&(o.user=e,o.user.date+31104e6<(new Date).getTime()&&setTimeout(function(){o.translate.get(["SESSIONTIMEOUT_MSG","CLOSE_BUTTON"]).subscribe(function(t){o.toastCtrl.create({message:t.SESSIONTIMEOUT_MSG,showCloseButton:!0,closeButtonText:t.CLOSE_BUTTON,duration:15e3}).present(),o.removeStoredUser()})},2e3)),t()})})}return t.prototype.onReady=function(){return this.ready},t.prototype.login=function(t){var e=this,n=this.api.showLoader(),o=new FormData;return o.append("username",t.username),o.append("password",String(a.Md5.hashStr(t.password))),this.api.post("2/auth/login",o,void 0,!0).map(function(o){if(!o.success)throw n&&n.dismiss(),r.Observable.throw(o);e.processAndGetMoreInfo(o,t),n&&n.dismiss()})},t.prototype.processAndGetMoreInfo=function(t,e){this.user={id:t.login.user.user_id,username:t.login.user.username,session:t.login.session_id,date:(new Date).getTime()},this.storage.set(s.i,this.user);var n=new FormData;n.append("command","Login"),n.append("uname",e.username),n.append("pwd",e.password),this.api.post("members/login.php",n,{withCredentials:!0},void 0,2).subscribe()},t.prototype.isLoggedIn=function(){return!!this.user},t.prototype.getId=function(){return this.user.id},t.prototype.getName=function(){return this.user.username},t.prototype.getSession=function(){return this.user.session},t.prototype.getDetails=function(){return this.user},t.prototype.checkIfEverythingIsFucked=function(){var t=this;return new Promise(function(e){t.storage.get(s.i).then(function(n){JSON.stringify(t.user)!==JSON.stringify(n)?e(!0):e(!1)})})},t.prototype.removeStoredUser=function(){this.storage.remove(s.i),this.storage.remove(s.a)},t.prototype.logout=function(){this.user=null,this.removeStoredUser(),window.location.reload()},t}())},66:function(t,e,n){"use strict";n.d(e,"a",function(){return u});n(0);var r=n(61),o=(n.n(r),n(42),n(392)),a=n(69),s=(n(95),n(53),n(68),n(38),n(51),this&&this.__assign||Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t}),i=function(t){var e=document.createElement("textarea");e.innerHTML=t;return e.value},u=function(){function t(t,e,n,r,o,s){var i=this;this.api=t,this.a=e,this.user=n,this.g=r,this.storage=o,this.translate=s,this.stories=new Map,this.ready=new Promise(function(t,e){i.storage.keys().then(function(e){if(e.length<1)t();else{var n=e.length-1;i.storage.forEach(function(e,r,o){0==r.indexOf(a.h)&&i.stories.set(e.id,e),o==n&&t()})}})})}return t.prototype.onReady=function(){return this.ready},t.prototype.searchStory=function(t,e,n,r){var o=s({q:t},e);return e.astags?this.tagsearch(o,n):this.newsearch(o,n)},t.prototype.getSeries=function(t){var e=[{property:"series_id",value:parseInt(t)}];return this.search(e)},t.prototype.getRelated=function(t){var e=[{property:"related_id",value:parseInt(t)}];return this.search(e)},t.prototype.getAuthorStories=function(t,e){var n=[{property:"user_id",value:parseInt(t)},{property:"type",value:"story"}];return this.search(n,e,null,null,"1/user-submissions")},t.prototype.getAuthorFavs=function(t,e){var n=[{property:"user_id",value:parseInt(t)},{property:"type",value:"story"}];return this.search(n,e,null,null,"1/user-favorites")},t.prototype.getTop=function(t,e){var n=[{property:"type",value:"story"}];return t&&n.push({property:"category_id",value:parseInt(t)}),this.search(n,e,null,null,"1/top")},t.prototype.getNew=function(t,e){var n=[{property:"type",value:"story"},{property:"newonly",value:"yes"}];return t&&n.push({property:"category_id",value:parseInt(t)}),this.search(n,e)},t.prototype.getById=function(t,e,n){var a=this;void 0===e&&(e=!1),void 0===n&&(n=!1);var s=this.stories.get(t);if(s&&!e&&s.length)return r.Observable.of(s);var i=[{property:"submission_id",value:parseInt(t)}],u={filter:JSON.stringify(i).trim()},l=this.api.showLoader();return this.api.get("2/submissions/pages",u).map(function(t){if(l&&!n&&l.dismiss(),!t.success)return a.api.showToast(),null;s?e&&(s.title=t.pages[0].name,s.url=t.pages[0].url,s.ratingenabled=t.pages[0].allow_vote):s=new o.a({id:t.pages[0].submission_id,title:t.pages[0].name,url:t.pages[0].url,ratingenabled:t.pages[0].allow_vote});var r=t.pages[0].tags?t.pages[0].tags.sort(function(t,e){return e.submission_count-t.submission_count}).map(function(t){return t.name}):[];return s.series=t.pages[0].series_id,s.lang=t.pages[0].lang,s.length=t.total,s.tags=r,s.content=t.pages.map(function(t){return t.content}),a.stories.set(s.id,s),s}).catch(function(t){return l&&l.dismiss(),a.api.showToast(),console.error(t),r.Observable.of(null)})},t.prototype.rate=function(t,e){var n=this,o=[{property:"submission_id",value:parseInt(t.id)}],a=new FormData;a.append("user_id",this.user.getId()),a.append("session_id",this.user.getSession()),a.append("vote",String(e)),a.append("filter",JSON.stringify(o)),this.api.post("2/submissions/vote",a,void 0,!0).catch(function(t){return console.error(t),r.Observable.throw(t)}).subscribe(function(r){r.success?t.myrating=e:r.error?n.api.showToast(r.error):n.api.showToast()})},t.prototype.downloadSeries=function(t){var e=this;return this.api.showLoader(),new Promise(function(n){var r=function(o){if(o>=t.length)return e.api.hideLoader(),void n();t[o].cached?(e.download(t[o]),e.api.updateLoader(Math.round(o+1/t.length*100)+"%"),r(o+1)):e.getById(t[o].id,!1,!0).subscribe(function(n){if(!n)return e.translate.get(["SERIES_DOWNLOAD_ERROR"]).subscribe(function(t){e.api.showToast(t.SERIES_DOWNLOAD_ERROR)}),void e.api.hideLoader();e.download(n),e.api.updateLoader(Math.round(o+1/t.length*100)+"%"),r(o+1)})};r(0)})},t.prototype.search=function(t,e,n,o,a){var s,i=this,u={page:e||1,filter:JSON.stringify(t)};return(!e||e<2)&&(s=this.api.showLoader()),this.api.get(a||"1/submissions",u,null,o).map(function(t){return s&&s.dismiss(),t.success||t.submissions?[t.submissions?t.submissions.map(function(t){return i.extractFromSearch(t)}):[],t.total]:(t.hasOwnProperty("total")||i.api.showToast(),[[],0])}).catch(function(t){return s&&s.dismiss(),i.api.showToast(),console.error(t),r.Observable.of([[],0])})},t.prototype.newsearch=function(t,e,n,o,a){var i=this;void 0===a&&(a=!1),a?Array.isArray(t.category)&&(t.category=parseInt(t.category[0])):(t.category&&(t.categories=t.category.map(function(t){return parseInt(t)})),delete t.category);var u,l={params:JSON.stringify(s({page:e||1},t))};return(!e||e<2)&&(u=this.api.showLoader()),this.api.get(o||"3/search/stories",l,null,n).map(function(t){u&&u.dismiss();var e=a?t.submissions:t.data,n=a?t.meta.submissions_count:t.meta.total;return e?[e.map(function(t){return i.extractFromNewSearch(t)}),n]:(n||i.api.showToast(),[[],0])}).catch(function(t){return u&&u.dismiss(),i.api.showToast(),console.error(t),r.Observable.of([[],0])})},t.prototype.tagsearch=function(t,e,n,r){var o=this,a={params:JSON.stringify({tags:t.q.split(",").map(function(t){return t.trim()})})};return delete t.q,(!e||e<2)&&this.api.showLoader(),this.api.get(r||"3/tagsportal/by-name",a,null,n).map(function(t){return t.map(function(t){return t.id})}).mergeMap(function(n){var r=s({tags:n,sort_by:t.sort},t);return o.newsearch(r,e,0,"3/tagsportal/stories",!0)})},t.prototype.download=function(t){t.downloaded=!0,t.downloadedtimestamp=new Date,t.cached=!0,this.storage.set(a.h+"_"+t.id,t)},t.prototype.undownload=function(t){t.downloaded=!1,t.downloadedtimestamp=null,t.cached?this.storage.set(a.h+"_"+t.id,t):this.storage.remove(a.h+"_"+t.id)},t.prototype.cache=function(t){t.cached=!0,this.storage.set(a.h+"_"+t.id,t)},t.prototype.uncache=function(t){t.cached=!1,t.downloaded=!1,this.storage.remove(a.h+"_"+t.id)},t.prototype.extractFromFeed=function(t){var e=this.stories.get(t.what.id);if(e)return e;var n=this.a.extractFromFeed(t.who),r=new o.a({id:t.what.id.toString(),title:t.what.title,description:t.what.description,category:i(t.what.category_info.name),lang:this.g.getLanguage(t.what.language),timestamp:t.when,rating:t.what.rate_all,viewcount:t.what.view_count,url:t.what.url,tags:t.what.tags?t.what.tags.map(function(t){return t.tag}):[],ishot:t.what.is_hot,isnew:t.what.is_new,iswriterspick:t.what.writers_pick,iscontestwinner:t.what.contest_winner,commentsenabled:t.what.enable_comments,ratingenabled:t.what.allow_vote,author:n});return this.stories.set(r.id,r),r},t.prototype.extactFromList=function(t){var e=this.stories.get(t.id);if(e)return e;var n=this.a.extractFromFeed(t.author),r=new o.a({id:t.id.toString(),title:t.title,description:t.description,category:i(t.category_info.name),lang:this.g.getLanguage(t.language),timestamp:Math.round(Date.parse(t.date_added)/1e3),rating:t.rate_all,viewcount:t.view_count,url:t.url,tags:t.tags?t.tags.map(function(t){return t.tag}):[],ishot:t.is_hot,isnew:t.is_new,iswriterspick:t.writers_pick,iscontestwinner:t.contest_winner,commentsenabled:t.enable_comments>0,ratingenabled:t.allow_vote,author:n});return this.stories.set(r.id,r),r},t.prototype.extractFromSearch=function(t){var e=this.stories.get(t.id);if(e)return e;var n=this.a.extractFromSearch(t.user),r=new o.a({id:t.id.toString(),title:t.name,description:t.description,category:t.category.name,lang:t.lang,timestamp:t.timestamp_published,rating:t.rate,viewcount:t.view_count,url:t.url,ishot:"no"!=t.is_hot,isnew:"no"!=t.is_new,iswriterspick:"no"!=t.writers_pick,iscontestwinner:"no"!=t.contest_winner,commentsenabled:t.enable_comments>0,ratingenabled:t.allow_vote>0,author:n});return this.stories.set(r.id,r),r},t.prototype.extractFromNewSearch=function(t){var e=this.stories.get(t.id);if(e)return e;var n=t.date_approve.split("/"),r=this.a.extractFromNewSearch(t.author),a=new o.a({id:t.id.toString(),title:t.title,description:t.description,category:i(t.category_info.name),lang:this.g.getLanguage(t.language),timestamp:Math.round(Date.parse(n[2]+"-"+n[0]+"-"+n[1]+"T00:00:00")/1e3),rating:t.rate_all,viewcount:t.view_count,url:t.url,ishot:t.is_hot,isnew:t.is_new,iswriterspick:t.writers_pick,iscontestwinner:t.contest_winner>0,commentsenabled:t.enable_comments>0,ratingenabled:t.allow_vote>0,author:r});return this.stories.set(a.id,a),a},t}()},68:function(t,e,n){"use strict";n.d(e,"a",function(){return a});n(0);var r=n(61),o=(n.n(r),n(42),n(51),n(138),n(38),n(53),n(69)),a=(n(57),function(){function t(t,e,n,r,a,s){var i=this;this.api=t,this.user=e,this.storage=n,this.translate=r,this.browser=a,this.toastCtrl=s,this.version=14,this.storage.get(o.j).then(function(t){t&&t!=i.version&&setTimeout(function(){i.translate.get(["UPDATED_MSG","CLOSE_BUTTON"]).subscribe(function(t){i.toastCtrl.create({message:t.UPDATED_MSG,showCloseButton:!0,closeButtonText:t.CLOSE_BUTTON,duration:15e3}).present(),i.user.removeStoredUser()})},2e3),i.storage.set(o.j,i.version)}),this.ready=new Promise(function(t,e){i.storage.get(o.b).then(function(e){e?(i.globals=e,t()):i.query().subscribe(function(){t()})})})}return t.prototype.onReady=function(){return this.ready},t.prototype.getCategories=function(){return[{id:"37",name:"Anal"},{id:"31",name:"BDSM"},{id:"27",name:"Celebrities & Fan Fiction"},{id:"28",name:"Chain Stories"},{id:"2",name:"Erotic Couplings"},{id:"51",name:"Erotic Horror"},{id:"4",name:"Exhibitionist & Voyeur"},{id:"5",name:"Fetish"},{id:"40",name:"First Time"},{id:"6",name:"Gay Male"},{id:"7",name:"Group Sex"},{id:"8",name:"How To"},{id:"34",name:"Humor & Satire"},{id:"45",name:"Illustrated"},{id:"9",name:"Incest/Taboo"},{id:"10",name:"Interracial Love"},{id:"11",name:"Lesbian Sex"},{id:"53",name:"Letters & Transcripts"},{id:"12",name:"Loving Wives"},{id:"26",name:"Mature"},{id:"29",name:"Mind Control"},{id:"32",name:"Non-English"},{id:"35",name:"Non-Erotic"},{id:"13",name:"NonConsent/Reluctance"},{id:"14",name:"NonHuman"},{id:"33",name:"Novels and Novellas"},{id:"3",name:"Reviews & Essays"},{id:"15",name:"Romance"},{id:"38",name:"Sci-Fi & Fantasy"},{id:"39",name:"Text With Audio"},{id:"16",name:"Toys & Masturbation"},{id:"48",name:"Transsexuals & Crossdressers"}]},t.prototype.getLanguage=function(t){var e=this;return this.globals.languages?Object.keys(this.globals.languages).filter(function(n){var r=e.globals.languages[n];if(parseInt(r.id)==t)return r.shortname})[0]:null},t.prototype.getPopularTags=function(){return this.api.get("3/tagsportal/top",{limit:100,periodCheck:!1,period:"all"})},t.prototype.getVersion=function(){return this.version},t.prototype.checkForUpdates=function(){var t=this;this.api.get("app.json",void 0,void 0,3).catch(function(t){return console.error(t),r.Observable.of(!1)}).subscribe(function(e){t.translate.get(["UPDATE_FAILEDMSG","UPDATE_MSG","DOWNLOAD_BUTTON"]).subscribe(function(n){e?(e.appid!=t.api.appid&&(t.api.appid=e.appid),e.apikey!=t.api.apikey&&(t.api.apikey=e.apikey),e.version>t.version&&t.api.showToast(n.UPDATE_MSG,15e3,n.DOWNLOAD_BUTTON).then(function(n){t.browser.openUrl(e.updatelink||"https://theilluminatus.github.io/litapp")})):t.api.showToast(n.UPDATE_FAILEDMSG)})})},t.prototype.query=function(){var t=this;if(this.globals)return r.Observable.of(this.globals);var e=this.api.showLoader();return this.api.get("3/constants",null,null,null,1e4).map(function(n){return e&&e.dismiss(),n?(t.globals=n,t.storage.set(o.b,t.globals),t.globals):(t.api.showToast(),null)}).catch(function(n){return e&&e.dismiss(),t.api.showToast(),console.error(n),r.Observable.of(null)})},t}())},69:function(t,e,n){"use strict";n.d(e,"f",function(){return r}),n.d(e,"e",function(){return o}),n.d(e,"g",function(){return a}),n.d(e,"c",function(){return s}),n.d(e,"h",function(){return i}),n.d(e,"i",function(){return u}),n.d(e,"a",function(){return l}),n.d(e,"d",function(){return c}),n.d(e,"b",function(){return p}),n.d(e,"j",function(){return d});var r="_queries",o="_recentqueries",a="_storystyle",s="_history",i="_story",u="_user",l="_feed",c="_list",p="_globals",d="_version"},71:function(t,e,n){"use strict";n.d(e,"a",function(){return r});n(0),n(42);var r=function(){function t(t,e){this.storage=t,this.SETTINGS_KEY="_settings",this._defaults=e}return t.prototype.load=function(){var t=this;return this.storage.get(this.SETTINGS_KEY).then(function(e){return e?(t.settings=e,t._mergeDefaults(t._defaults)):t.setAll(t._defaults).then(function(e){t.settings=e})})},t.prototype._mergeDefaults=function(t){for(var e in t)e in this.settings||(this.settings[e]=t[e]);return this.setAll(this.settings)},t.prototype.merge=function(t){for(var e in t)this.settings[e]=t[e];return this.save()},t.prototype.setValue=function(t,e){return this.settings[t]=e,this.storage.set(this.SETTINGS_KEY,this.settings)},t.prototype.setAll=function(t){return this.storage.set(this.SETTINGS_KEY,t)},t.prototype.getValue=function(t){return this.storage.get(this.SETTINGS_KEY).then(function(e){return e[t]})},t.prototype.save=function(){return this.setAll(this.settings)},Object.defineProperty(t.prototype,"allSettings",{get:function(){return this.settings},enumerable:!0,configurable:!0}),t}()},95:function(t,e,n){"use strict";n(0),n(1),n(57);var r=n(61),o=function(){return function(t){for(var e in t)this[e]=t[e]}}();n(53),n(38);n.d(e,"a",function(){return a});var a=function(){function t(t,e,n,r){this.api=t,this.user=e,this.loadingCtrl=n,this.toastCtrl=r,this.authors=new Map}return t.prototype.getDetails=function(t){var e=this,n=[{property:"user_id",value:t}],a={filter:JSON.stringify(n).trim()},s=this.authors.get(t);if(s&&s.bio)return r.Observable.of(s);var i=this.api.showLoader();return this.api.get("1/user-bio",a).map(function(t){return i&&i.dismiss(),t.success?(s||(s=new o({id:t.user.profile.id,picture:t.user.profile.userpic,name:t.user.profile.username})),s.storycount=t.user.profile.submissions_count,s.bio=t.user.profile.description,e.authors.set(s.id,s),s):(e.api.showToast(),null)}).catch(function(t){return i&&i.dismiss(),e.api.showToast(),console.error(t),r.Observable.of(null)})},t.prototype.getFollowing=function(){var t=this,e=this.api.showLoader();return this.api.get("3/users/"+this.user.getId()+"/favorite/authors?params={%22nocache%22:true}").map(function(n){return e&&e.dismiss(),n.length?n.map(function(e){return t.extractFromFeed(e)}):(t.api.showToast(),[])}).catch(function(n){return e&&e.dismiss(),t.api.showToast(),console.error(n),r.Observable.of([])})},t.prototype.follow=function(t){var e=this,n=new FormData;return n.append("type","member"),n.append("id",t.id),this.api.post("3/users/follow/"+t.id,{}).map(function(t){return t.success||e.api.showToast(),t.success}).catch(function(t){return e.api.showToast(),console.error(t),r.Observable.of(!1)}).subscribe(function(n){n?t.following=!0:e.api.showToast()})},t.prototype.unfollow=function(t){var e=this;return this.api.delete("3/users/follow/"+t.id).map(function(t){return t.success||e.api.showToast(),t.success}).catch(function(t){return e.api.showToast(),console.error(t),r.Observable.of(!1)}).subscribe(function(e){e&&(t.following=!1)})},t.prototype.extractFromFeed=function(t){var e=this.authors.get(t.id);return e&&e.updatetimestamp?e:(e||(e=new o({id:t.userid,name:t.username,picture:t.userpic})),e.jointimestamp=t.joindate,e.following=!0,this.authors.set(e.id,e),e)},t.prototype.extractFromSearch=function(t){var e=this.authors.get(t.id);if(e)return e;var n=new o({id:t.id,name:t.username,picture:t.userpic});return this.authors.set(n.id,n),n},t.prototype.extractFromNewSearch=function(t){var e=this.authors.get(t.userid);if(e)return e;var n=new o({id:t.userid,name:t.username,picture:t.userpic});return this.authors.set(n.id,n),n},t}()}},[401]);