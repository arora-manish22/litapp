webpackJsonp([23],{134:function(t,e,n){"use strict";n.d(e,"a",function(){return i});n(0);var r=n(57),o=(n.n(r),n(44),n(401)),s=(n(42),n(67),n(53),n(34),n(68)),i=function(){function t(t,e,n,r,o){var i=this;this.api=t,this.s=e,this.settings=n,this.user=r,this.storage=o,this.ready=new Promise(function(t,e){Promise.all([i.settings.load(),i.user.onReady(),i.s.onReady(),i.storage.get(s.d)]).then(function(e){if(!i.settings.allSettings.cachelists||i.settings.allSettings.offlineMode||!i.user.isLoggedIn())return t(),void(e[3]&&i.storage.remove(s.d));e[3]&&(i.lists=e[3]),i.query(!0).subscribe(function(e){var n=0;e.forEach(function(r,o){i.getById(r.urlname,!0).subscribe(function(r){(n+=1)===e.length&&t()})})})})})}return t.prototype.onReady=function(){return this.ready},t.prototype.query=function(t){var e=this;if(this.lists)return r.Observable.of(this.lists);var n;return t||(n=this.api.showLoader()),this.api.get("3/users/"+this.user.getId()+"/lists").map(function(t){return n&&n.dismiss(),t.error?(e.api.showToast(),[]):(e.lists=t.map(function(t){return new o.a({id:t.id,urlname:t.urlname,name:t.title,description:t.description,visibility:!t.is_private,size:t.stories_count,isdeletable:t.is_deletable,createtimestamp:t.created_at,updatetimestamp:t.updated_at,lastPage:-1})}),e.storage.set(s.d,e.lists),e.lists)}).catch(function(t){return n&&n.dismiss(),e.api.showToast(),console.error("lists.query",t),r.Observable.of([])})},t.prototype.getById=function(t,e){var n=this,o=this.lists.find(function(e){return e.urlname===t});if(o.stories)return r.Observable.of(o);var i;return e||(i=this.api.showLoader()),r.Observable.create(function(e){var r=function(a,l){n.getListPage(t,i,Object.assign({},l),a).subscribe(function(t){if(t){var u=l;if(l.stories?u.stories=u.stories.concat(t.stories):u=t,t.size>u.stories.length&&a<u.lastPage){var c=a+1;n.api.updateLoader(Math.round(u.stories.length/t.size*100)+"%"),r(c,u)}else n.lists[n.lists.indexOf(o)]=u,n.storage.set(s.d,n.lists),i&&i.dismiss(),e.next(u),e.complete()}})};r(1,o)})},t.prototype.getListPage=function(t,e,n,s){var i=this;void 0===s&&(s=1);var a={page:s,sort:"dateadd"};return this.api.get("3/users/"+this.user.getId()+"/lists/"+t,{params:JSON.stringify(a)}).map(function(t){if(!t.works.data)return i.api.showToast(),null;var e=n;return n||(e=new o.a({id:t.list.id,urlname:t.list.urlname,name:t.list.title,description:t.list.description,visibility:!t.list.is_private,size:t.list.stories_count,isdeletable:t.list.is_deletable,createtimestamp:t.list.created_at,updatetimestamp:t.list.updated_at})),e.lastPage=t.works.meta.last_page,e.stories=t.works.data.map(function(t){return i.s.extactFromList(t)}),e}).catch(function(o){return e&&e.dismiss(),i.api.showToast(),console.error("lists.getListPage",[t,n,s],o),r.Observable.of(null)})},t.prototype.addStory=function(t,e){var n=this;return this.api.put("3/stories/"+e.id+"/lists/"+t.id,{}).map(function(t){return t.success||n.api.showToast(),t.success}).catch(function(o){return n.api.showToast(),console.error("lists.addStory",[t,e],o),r.Observable.of(!1)}).subscribe(function(r){r&&(t.stories||(t.stories=[]),t.stories.push(e),t.size+=1,n.storage.set(s.d,n.lists))})},t.prototype.removeStory=function(t,e){var n=this;return this.api.delete("3/stories/"+e.id+"/lists/"+t.id).map(function(t){return t.success||n.api.showToast(),t.success}).catch(function(o){return n.api.showToast(),console.error("lists.removeStory",[t,e],o),r.Observable.of(!1)}).subscribe(function(r){if(r){if(!t.stories)return;t.stories.forEach(function(n,r){n.id===e.id&&t.stories.splice(r,1)}),t.size-=1,n.storage.set(s.d,n.lists)}})},t.prototype.add=function(t){var e=this,n={title:t.name,description:t.description,isPrivate:t.visibility?0:1};return this.api.post("3/users/"+this.user.getId()+"/lists",n,void 0,!1).map(function(t){return t.success?(e.lists.push(new o.a({id:t.list.id,urlname:t.list.urlname,name:t.list.title,description:t.list.description,visibility:!t.list.is_private,size:t.list.stories_count,isdeletable:t.list.is_deletable,createtimestamp:t.list.created_at})),e.storage.set(s.d,e.lists),!0):(e.api.showToast(),!1)}).catch(function(n){return e.api.showToast(),console.error("lists.add",[t],n),r.Observable.of(!1)})},t.prototype.edit=function(t){var e=this;return this.api.patch("3/lists/"+t.id,{title:t.name,description:t.description,isPrivate:t.visibility?0:1}).map(function(n){return n.success?(e.lists.forEach(function(e){e.id===t.id&&(e.name=n.list.title,e.description=n.list.description,e.visibility=!n.list.is_private)}),e.storage.set(s.d,e.lists),!0):(e.api.showToast(n.error),!1)}).catch(function(n){return e.api.showToast(),console.error("lists.edit",[t],n),r.Observable.of(!1)})},t.prototype.delete=function(t){var e=this;return this.api.delete("3/lists/"+t.id).map(function(n){return n.success?(e.lists.forEach(function(n,r){n.urlname===t.urlname&&e.lists.splice(r,1)}),e.storage.set(s.d,e.lists),!0):(e.api.showToast(n.error),!1)}).catch(function(n){return e.api.showToast(),console.error("lists.delete",[t],n),r.Observable.of(!1)})},t.prototype.refresh=function(){return this.storage.remove(s.d),this.lists=null,this.query()},t}()},141:function(t,e,n){"use strict";n.d(e,"a",function(){return o});n(0),n(172),n(69);var r=n(397),o=(n(42),function(){function t(t,e,n){var o=this;this.g=t,this.settings=e,this.googleAnalytics=n,Promise.all([this.settings.load(),this.g.onReady()]).then(function(){if(!o.settings.allSettings.offlineMode)try{Promise.all([o.googleAnalytics.startTrackerWithId("UA-142185587-2",120),o.googleAnalytics.setAnonymizeIp(!0),o.googleAnalytics.setAllowIDFACollection(!1),o.googleAnalytics.setAppVersion(o.g.getVersion().toString())]).then(function(){o.track("Startup")}).catch(function(t){return Object(r.a)(t)})}catch(t){Object(r.a)(t)}})}return t.prototype.track=function(t){console.info("Track",t),this.settings.allSettings.offlineMode||this.googleAnalytics.trackView(t)},t}())},142:function(t,e,n){"use strict";n(0),n(1);var r=n(57),o=(n(44),function(){return function(t){for(var e in t)this[e]=t[e]}}()),s=(n(67),n(94),n(53),n(42),n(68));n(34);n.d(e,"a",function(){return i});var i=function(){function t(t,e,n,r,o,i){var a=this;this.api=t,this.s=e,this.a=n,this.user=r,this.settings=o,this.storage=i,this.timeout=6e5,this.feedtimeout=(new Date).getTime()+this.timeout,this.feedbadge="",this.ready=new Promise(function(t,e){Promise.all([a.settings.load(),a.user.onReady()]).then(function(){a.settings.allSettings.checkforfeedupdates&&!a.settings.allSettings.offlineMode&&a.user.isLoggedIn()?(a.feedbadge="Â·",a.query().subscribe(function(e){e?a.storage.get(s.a).then(function(n){for(var r=0;r<e.length;r+=1)if(n===e[r].id){a.feedbadge=String(r);break}""===a.feedbadge&&(a.feedbadge="15+"),t()}):t()})):t()})})}return t.prototype.onReady=function(){return this.ready},t.prototype.query=function(t,e,n){var s=this;if(void 0===n&&(n=!1),!n&&!t&&this.feed&&(new Date).getTime()<this.feedtimeout)return r.Observable.of(this.feed);t&&this.feed||(this.feed=[]);var i;e&&(i=this.api.showLoader());var a={chunked:1,limit:10};return t&&(a.last_id=t),this.api.get("3/activity/wall?params="+JSON.stringify(a)).map(function(t){if(i&&i.dismiss(),!t.data)return s.api.showToast(),[];var e=t.data.map(function(t){var e="published-story"===t.action;try{return new o({id:t.id,timestamp:t.when,author:s.a.extractFromFeed(t.who),text:e?[]:Array.isArray(t.what)?t.what:["their profile"],story:e?s.s.extractFromFeed(t):void 0})}catch(t){return new o(null)}});return e.forEach(function(t){return s.feed.push(t)}),s.feedtimeout=(new Date).getTime()+s.timeout,e}).catch(function(e){return i&&i.dismiss(),s.api.showToast(),console.error("feed.query",[t],e),r.Observable.of([])})},t}()},190:function(t,e,n){"use strict";n(141),n(34),n(67),n(94),n(134),n(205),n(142),n(69);var r=n(42);n(53);n.d(e,"a",function(){return r.a})},205:function(t,e,n){"use strict";n.d(e,"a",function(){return s});n(0),n(40);var r=n(38),o=(n.n(r),n(402)),s=(n(34),function(){function t(t,e){var n=this;this.api=t,this.translate=e,this.categories=[],this.sortMap=new Map,this.categories=this.api.get("3/tagsportal/categories",null).map(function(t){var e=[];return t.forEach(function(t){e.push(new o.a({id:t.id,name:t.name,description:t.ldesc,type:t.type,url:t.pageUrl}))}),n.translate.get(["EXPLORE_ALLCAT","EXPLORE_ALLCATDESCR"]).subscribe(function(t){e.push(new o.a({id:0,name:t.EXPLORE_ALLCAT,description:t.EXPLORE_ALLCATDESCR,type:"master",url:""}))}),e}),this.sortMap.set("master",0),this.sortMap.set("story",1),this.sortMap.set("poem",2)}return t.prototype.mapSorter=function(t){return function(e,n){return t.get(e.type)>t.get(n.type)?1:t.get(e.type)<t.get(n.type)?-1:e.name>n.name?1:e.name<n.name?-1:void 0}},t.prototype.get=function(t){return this.categories.map(function(e){return e.find(function(e){return e.id===t})})},t.prototype.getAll=function(){return this.categories.map(function(t){return t.filter(function(t){return["master","story","poem"].includes(t.type)})})},t.prototype.getAllSorted=function(){var t=this;return this.getAll().map(function(e){return e.sort(t.mapSorter(t.sortMap))})},t.prototype.getAllSortedGrouped=function(){var t=this;return this.getAllSorted().map(function(e){var n=[];return t.sortMap.forEach(function(t,r){n.push(e.filter(function(t){return t.type===r}))}),n})},t.prototype.getClosestCategory=function(t){return this.getAll().map(function(e){return e.find(function(e){return!(!e.id||e.id.toString()!==t)||(!(!e.name||e.name!==t)||!!(e.name&&e.name.toLowerCase().indexOf(t.toLowerCase())>-1))})})},t.prototype.getType=function(t){return this.sortMap.has(t)?this.getAllSorted().map(function(e){return e.filter(function(e){return e.type===t})}):(console.error("categories.getType",[t],"Unsupported Category Type"),new r.EmptyObservable)},t}())},245:function(t,e){function n(t){return Promise.resolve().then(function(){throw new Error("Cannot find module '"+t+"'.")})}n.keys=function(){return[]},n.resolve=n,t.exports=n,n.id=245},286:function(t,e,n){function r(t){var e=o[t];return e?n.e(e[1]).then(function(){return n(e[0])}):Promise.reject(new Error("Cannot find module '"+t+"'."))}var o={"../pages/account/account.module.ngfactory":[684,21],"../pages/author/author.module.ngfactory":[686,7],"../pages/explore/explore.module.ngfactory":[685,18],"../pages/feed/feed.module.ngfactory":[687,6],"../pages/following/following.module.ngfactory":[688,10],"../pages/history/history.module.ngfactory":[689,2],"../pages/history/sort-popover.module.ngfactory":[690,15],"../pages/list-create/list-create.module.ngfactory":[691,13],"../pages/list-list/list-list.module.ngfactory":[692,12],"../pages/list-view/list-view.module.ngfactory":[693,1],"../pages/login/login.module.ngfactory":[694,20],"../pages/search/search-popover.module.ngfactory":[695,14],"../pages/search/search.module.ngfactory":[696,0],"../pages/settings/settings.module.ngfactory":[697,19],"../pages/story-detail/story-detail.module.ngfactory":[698,9],"../pages/story-related/story-related.module.ngfactory":[699,5],"../pages/story-series/story-series.module.ngfactory":[700,4],"../pages/story-view/story-popover.module.ngfactory":[701,16],"../pages/story-view/story-view.module.ngfactory":[702,8],"../pages/tabs/tabs.module.ngfactory":[703,22],"../pages/top-list/top-list.module.ngfactory":[704,3],"../parts/bookmark-popover/bookmark-popover.module.ngfactory":[705,11],"../parts/export-popover/export-popover.module.ngfactory":[706,17]};r.keys=function(){return Object.keys(o)},r.id=286,t.exports=r},34:function(t,e,n){"use strict";n(0);var r=n(153),o=(n(1),n(58),n(40),{CORS_PROXY:"https://litapp-cors.herokuapp.com/"}),s=(n(42),n(57));n.d(e,"a",function(){return a});var i=function(t,e,n,r){throw console.info({url:e,method:r,data:n,type:"API_Error",name:t.name,message:t.message,stack:t.stack}),t},a=function(){function t(t,e,n,r,s){this.http=t,this.translate=e,this.loadingCtrl=n,this.toastCtrl=r,this.settings=s,this.apikey="70b3a71911b398a98d3dac695f34cf279c270ea0",this.appid="24b7c3f9d904ebd679299b1ce5506bc305a5ab40",this.corsProxy=o.CORS_PROXY||"",this.urls=this.getUrls();try{var i=location.search.substring(1),a=JSON.parse('{"'+decodeURI(i).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')+'"}');a.proxy&&(this.corsProxy=a.proxy,this.urls=this.getUrls())}catch(t){}}return t.prototype.getUrls=function(){return[this.corsProxy+"https://literotica.com/api",this.corsProxy+"https://search.literotica.com/api",this.corsProxy+"https://www.literotica.com",this.corsProxy+"https://raw.githubusercontent.com/theilluminatus/litapp/master",this.corsProxy+"https://literotica.com"]},t.prototype.get=function(t,e,n,o,s){if(this.settings.allSettings.offlineMode)return this.showOfflineModeError();var a=n;if(n||(a={params:new r.g({encoder:new l})}),e){a.params=new r.g({encoder:new l});for(var u in e)a.params=a.params.set(u,e[u])}a.withCredentials=!0,a.params=a.params.set("apikey",this.apikey),a.params=a.params.set("appid",this.appid);var c=this.urls[o||0]+"/"+t,p=this.http.get(c,a).catch(function(t){return i(t,c,a.params,"GET")});return s?p.timeout(s):p},t.prototype.post=function(t,e,n,r,o){if(this.settings.allSettings.offlineMode)return this.showOfflineModeError();var s=t;r&&(t.indexOf("?")>-1?s+="&apikey="+this.apikey+"&appid="+this.appid:s+="?apikey="+this.apikey+"&appid="+this.appid);var a=this.urls[o||0]+"/"+s;return this.http.post(a,e,n).catch(function(t){return i(t,a,e,"POST")})},t.prototype.put=function(t,e,n){if(this.settings.allSettings.offlineMode)return this.showOfflineModeError();var r=this.urls[0]+"/"+t;return this.http.put(r,e,n).catch(function(t){return i(t,r,e,"PUT")})},t.prototype.delete=function(t,e,n){if(this.settings.allSettings.offlineMode)return this.showOfflineModeError();var r=this.urls[n||0]+"/"+t;return this.http.delete(r,e).catch(function(t){return i(t,r,{},"DELETE")})},t.prototype.patch=function(t,e,n){if(this.settings.allSettings.offlineMode)return this.showOfflineModeError();var r=this.urls[0]+"/"+t;return this.http.patch(r,e,n).catch(function(t){return i(t,r,e,"PATCH")})},t.prototype.showLoader=function(){var t=this;return this.loader?this.loader:(this.loader=this.loadingCtrl.create({spinner:"crescent"}),this.loader.present(),this.loader.onDidDismiss(function(){t.loader=void 0}),this.loader)},t.prototype.updateLoader=function(t){this.loader&&this.loader.setContent(t)},t.prototype.hideLoader=function(){this.loader&&this.loader.dismiss().catch(function(){})},t.prototype.showToast=function(t,e,n){var r=this;return new Promise(function(o){r.translate.get(["LOAD_ERROR","CLOSE_BUTTON"]).subscribe(function(s){r.translations=s;var i=r.toastCtrl.create({message:t||r.translations.LOAD_ERROR,showCloseButton:!0,closeButtonText:n||r.translations.CLOSE_BUTTON,duration:e||3e3});i.present(),i.onDidDismiss(function(t){o(i)})})})},t.prototype.showOfflineModeError=function(){var t=this;return this.translate.get(["OFFLINE_ERROR"]).subscribe(function(e){t.showToast(e.OFFLINE_ERROR)}),this.hideLoader(),s.Observable.of()},t}(),l=function(){function t(){}return t.prototype.encodeKey=function(t){return encodeURIComponent(t)},t.prototype.encodeValue=function(t){return encodeURIComponent(t)},t.prototype.decodeKey=function(t){return decodeURIComponent(t)},t.prototype.decodeValue=function(t){return decodeURIComponent(t)},t}()},396:function(t,e,n){"use strict";n.d(e,"a",function(){return r});var r=function(){return function(t){for(var e in t)this[e]=t[e]}}()},397:function(t,e,n){"use strict";n.d(e,"a",function(){return r});var r=function(t,e){if("cordova_not_available"!==t)throw t;e&&e(t)}},401:function(t,e,n){"use strict";n.d(e,"a",function(){return r});var r=function(){return function(t){for(var e in t)this[e]=t[e]}}()},402:function(t,e,n){"use strict";n.d(e,"a",function(){return r});var r=function(){return function(t){for(var e in t)this[e]=t[e]}}()},406:function(t,e,n){"use strict";function r(t){return new T.a(t,"./assets/i18n/",".json")}function o(t){return new I.a(t,{checkforfeedupdates:!0,checkforappupdates:!0,cachelists:!0,amoledBlackTheme:!1,offlineMode:!1,enableLock:!1,forceNormalList:!1})}function s(t){return c._22(0,[(t()(),c.Z(0,0,null,null,8,"button",[["class","item item-block"],["ion-item",""],["menuClose",""]],null,[[null,"click"]],function(t,e,n){var r=!0,o=t.component;if("click"===e){r=!1!==c._13(t,6).close()&&r}if("click"===e){r=!1!==o.openLinkDialog()&&r}return r},G.b,G.a)),c.Y(1,1097728,null,3,K.a,[q.a,Z.a,c.j,c.z,[2,J.a]],null,null),c._18(335544320,7,{contentLabel:0}),c._18(603979776,8,{_buttons:1}),c._18(603979776,9,{_icons:1}),c.Y(5,16384,null,0,V.a,[],null,null),c.Y(6,16384,null,0,X.a,[W.a],{menuClose:[0,"menuClose"]},null),(t()(),c._20(7,2,["\n              ","\n            "])),c._14(131072,Q.a,[$.a,c.g])],function(t,e){t(e,6,0,"")},function(t,e){t(e,7,0,c._21(e,7,0,c._13(e,8).transform("MENU_OPENLINK")))})}function i(t){return c._22(0,[(t()(),c.Z(0,0,null,null,8,"button",[["class","item item-block"],["ion-item",""],["menuClose",""]],null,[[null,"click"]],function(t,e,n){var r=!0,o=t.component;if("click"===e){r=!1!==c._13(t,6).close()&&r}if("click"===e){r=!1!==o.openPage("AccountPage")&&r}return r},G.b,G.a)),c.Y(1,1097728,null,3,K.a,[q.a,Z.a,c.j,c.z,[2,J.a]],null,null),c._18(335544320,10,{contentLabel:0}),c._18(603979776,11,{_buttons:1}),c._18(603979776,12,{_icons:1}),c.Y(5,16384,null,0,V.a,[],null,null),c.Y(6,16384,null,0,X.a,[W.a],{menuClose:[0,"menuClose"]},null),(t()(),c._20(7,2,["\n              ","\n            "])),c._14(131072,Q.a,[$.a,c.g])],function(t,e){t(e,6,0,"")},function(t,e){t(e,7,0,c._21(e,7,0,c._13(e,8).transform("MENU_ACCOUNT")))})}function a(t){return c._22(0,[(t()(),c.Z(0,0,null,null,60,null,null,null,null,null,null,null)),(t()(),c._20(-1,null,["\n      "])),(t()(),c.Z(2,0,null,null,53,"ion-menu",[["role","navigation"]],null,null,null,tt.b,tt.a)),c._17(6144,null,et.a,null,[nt.a]),c.Y(4,245760,null,2,nt.a,[W.a,c.j,Z.a,rt.a,c.z,ot.a,st.l,it.a,at.a],{content:[0,"content"]},null),c._18(335544320,2,{menuContent:0}),c._18(335544320,3,{menuNav:0}),(t()(),c._20(-1,0,["\n        "])),(t()(),c.Z(8,0,null,0,12,"ion-header",[],null,null,null,null,null)),c.Y(9,16384,null,0,lt.a,[Z.a,c.j,c.z,[2,ut.a]],null,null),(t()(),c._20(-1,null,["\n          "])),(t()(),c.Z(11,0,null,null,8,"ion-toolbar",[["class","toolbar"]],[[2,"statusbar-padding",null]],null,null,ct.b,ct.a)),c.Y(12,49152,null,0,pt.a,[Z.a,c.j,c.z],null,null),(t()(),c._20(-1,3,["\n            "])),(t()(),c.Z(14,0,null,3,4,"ion-title",[],null,null,null,ht.b,ht.a)),c.Y(15,49152,null,0,dt.a,[Z.a,c.j,c.z,[2,pt.a],[2,gt.a]],null,null),(t()(),c._20(-1,0,["Literotica "])),(t()(),c.Z(17,0,null,0,1,"small",[],null,null,null,null,null)),(t()(),c._20(-1,null,["(unofficial)"])),(t()(),c._20(-1,3,["\n          "])),(t()(),c._20(-1,null,["\n        "])),(t()(),c._20(-1,0,["\n\n        "])),(t()(),c.Z(22,0,null,0,32,"ion-content",[],[[2,"statusbar-padding",null],[2,"has-refresher",null]],null,null,ft.b,ft.a)),c.Y(23,4374528,[[2,4]],0,mt.a,[Z.a,rt.a,it.a,c.j,c.z,at.a,ot.a,c.u,[2,ut.a],[2,yt.a]],null,null),(t()(),c._20(-1,1,["\n          "])),(t()(),c.Z(25,0,null,1,28,"ion-list",[],null,null,null,null,null)),c.Y(26,16384,null,0,_t.a,[Z.a,c.j,c.z,rt.a,st.l,it.a],null,null),(t()(),c._20(-1,null,["\n            "])),(t()(),c.Z(28,0,null,null,8,"button",[["class","item item-block"],["ion-item",""],["menuClose",""]],null,[[null,"click"]],function(t,e,n){var r=!0,o=t.component;if("click"===e){r=!1!==c._13(t,34).close()&&r}if("click"===e){r=!1!==o.openPage("TabsPage")&&r}return r},G.b,G.a)),c.Y(29,1097728,null,3,K.a,[q.a,Z.a,c.j,c.z,[2,J.a]],null,null),c._18(335544320,4,{contentLabel:0}),c._18(603979776,5,{_buttons:1}),c._18(603979776,6,{_icons:1}),c.Y(33,16384,null,0,V.a,[],null,null),c.Y(34,16384,null,0,X.a,[W.a],{menuClose:[0,"menuClose"]},null),(t()(),c._20(35,2,["\n              ","\n            "])),c._14(131072,Q.a,[$.a,c.g]),(t()(),c._20(-1,null,["\n\n            "])),(t()(),c.U(16777216,null,null,1,null,s)),c.Y(39,16384,null,0,vt.j,[c.I,c.F],{ngIf:[0,"ngIf"]},null),(t()(),c._20(-1,null,["\n\n            "])),(t()(),c.U(16777216,null,null,1,null,i)),c.Y(42,16384,null,0,vt.j,[c.I,c.F],{ngIf:[0,"ngIf"]},null),(t()(),c._20(-1,null,["\n\n            "])),(t()(),c.Z(44,0,null,null,8,"button",[["class","item item-block"],["ion-item",""],["menuClose",""]],null,[[null,"click"]],function(t,e,n){var r=!0,o=t.component;if("click"===e){r=!1!==c._13(t,50).close()&&r}if("click"===e){r=!1!==o.openPage("SettingsPage")&&r}return r},G.b,G.a)),c.Y(45,1097728,null,3,K.a,[q.a,Z.a,c.j,c.z,[2,J.a]],null,null),c._18(335544320,13,{contentLabel:0}),c._18(603979776,14,{_buttons:1}),c._18(603979776,15,{_icons:1}),c.Y(49,16384,null,0,V.a,[],null,null),c.Y(50,16384,null,0,X.a,[W.a],{menuClose:[0,"menuClose"]},null),(t()(),c._20(51,2,["\n              ","\n            "])),c._14(131072,Q.a,[$.a,c.g]),(t()(),c._20(-1,null,["\n          "])),(t()(),c._20(-1,1,["\n        "])),(t()(),c._20(-1,0,["\n      "])),(t()(),c._20(-1,null,["\n      "])),(t()(),c.Z(57,0,null,null,2,"ion-nav",[["root","TabsPage"]],null,null,null,bt.b,bt.a)),c._17(6144,null,et.a,null,[wt.a]),c.Y(59,4374528,[[1,4],["content",4]],0,wt.a,[[2,ut.a],[2,yt.a],at.a,Z.a,rt.a,c.j,c.u,c.z,c.i,st.l,St.a,[2,Tt.a],it.a,c.k],{root:[0,"root"]},null),(t()(),c._20(-1,null,["\n    "]))],function(t,e){var n=e.component;t(e,4,0,c._13(e,59));t(e,34,0,"");t(e,39,0,!n.settings.allSettings.offlineMode);t(e,42,0,!n.settings.allSettings.offlineMode);t(e,50,0,"");t(e,59,0,"TabsPage")},function(t,e){t(e,11,0,c._13(e,12)._sbPadding);t(e,22,0,c._13(e,23).statusbarPadding,c._13(e,23)._hasRefresher);t(e,35,0,c._21(e,35,0,c._13(e,36).transform("MENU_HOME")));t(e,51,0,c._21(e,51,0,c._13(e,52).transform("MENU_SETTINGS")))})}function l(t){return c._22(0,[c._18(671088640,1,{nav:0}),(t()(),c._20(-1,null,["\n    "])),(t()(),c.U(16777216,null,null,1,null,a)),c.Y(3,16384,null,0,vt.j,[c.I,c.F],{ngIf:[0,"ngIf"]},null),(t()(),c._20(-1,null,["\n  "]))],function(t,e){t(e,3,0,e.component.loggedIn)},null)}Object.defineProperty(e,"__esModule",{value:!0});var u=n(47),c=n(1),p=(n(0),n(153)),h=n(248),d=n(215),g=n(138),f=n(206),m=n(216),y=n(217),_=n(252),v=n(253),b=n(254),w=n(44),S=n(40),T=n(419),O=(n(58),n(200)),P=n(224),L=n(225),N=n(124),E=n(172),C=n(226),k=n(125),I=n(190),M=function(){function t(t,e,n,r,o,s,i,a,l,u,c,p,h,d,g){var f=this;this.platform=t,this.app=e,this.translate=n,this.webIntent=r,this.config=o,this.alertCtrl=s,this.toastCtrl=i,this.settings=a,this.analytics=l,this.api=u,this.g=c,this.s=p,this.l=h,this.f=d,this.faio=g,this.loggedIn=!1,this.initTranslate(),this.settings.load().then(function(){if(f.platform.is("cordova")&&f.settings.allSettings.enableLock&&!f.loggedIn?f.showLockScreen():f.loggedIn=!0,f.settings.allSettings.checkforappupdates&&!f.settings.allSettings.offlineMode&&f.platform.is("cordova")&&f.g.checkForUpdates(),f.settings.allSettings.amoledBlackTheme){var t=document.createElement("link");t.setAttribute("href","./assets/black-theme.css"),t.setAttribute("rel","stylesheet"),document.head.appendChild(t)}}),this.catchShareIntent(),this.platform.resume.subscribe(function(){f.catchShareIntent()})}return t.prototype.showLockScreen=function(){var t=this;this.faio.isAvailable().then(function(e){e?t.faio.show({clientId:"litapp",clientSecret:"3}D+v862s4a6c>y5elLFj4xA",disableBackup:!1}).then(function(e){e&&(t.loggedIn=e)}).catch(function(){return t.platform.exitApp()}):t.loggedIn=!0}).catch(function(){return t.loggedIn=!0})},t.prototype.catchShareIntent=function(){var t=this;this.platform.is("cordova")&&this.webIntent.getIntent().then(function(e){"android.intent.action.SEND"===e.action&&e.extras&&t.openURL(e.extras["android.intent.extra.TEXT"])})},t.prototype.initTranslate=function(){var t=this;this.translate.setDefaultLang("en");var e=this.translate.getBrowserLang();if(e)if("zh"===e){var n=this.translate.getBrowserCultureLang();n.match(/-CN|CHS|Hans/i)?this.translate.use("zh-cmn-Hans"):n.match(/-TW|CHT|Hant/i)&&this.translate.use("zh-cmn-Hant")}else this.translate.use(this.translate.getBrowserLang());else this.translate.use("en");this.translate.get(["BACK_BUTTON_TEXT"]).subscribe(function(e){t.config.set("ios","backButtonText",e.BACK_BUTTON_TEXT)})},t.prototype.openPage=function(t){"TabsPage"===t.title?this.nav.setRoot(t):this.nav.push(t)},t.prototype.openLinkDialog=function(t){var e=this;this.translate.get(["MENU_OPENLINK","OPENLINK_DESCRIPTION","OK_BUTTON","CANCEL_BUTTON"]).subscribe(function(t){e.alertCtrl.create({title:t.MENU_OPENLINK,message:t.OPENLINK_DESCRIPTION,inputs:[{name:"url",placeholder:"https://www.literotica.com/..."}],buttons:[{text:t.OK_BUTTON,handler:function(t){e.openURL(t.url)}},{text:t.CANCEL_BUTTON}]}).present()})},t.prototype.openURL=function(t){var e=this,n=/literotica\.com\/s\/([-a-zA-Z0-9._+]*)/g.exec(t);if(n)return this.nav.push("SearchPage",{storyurl:n[1]}),void this.translate.get(["OPENLINK_STORYWARNING"]).subscribe(function(t){e.toastCtrl.create({message:t.OPENLINK_STORYWARNING,duration:2e3,position:"bottom"}).present()});var r=/literotica\.com\/stories\/memberpage\.php\?.*uid=([0-9]*)/g.exec(t);if(r){this.nav.push("AuthorPage",{author:{id:r[1]}})}else this.translate.get(["OPENLINK_UNSUPPORTED"]).subscribe(function(t){e.toastCtrl.create({message:t.OPENLINK_UNSUPPORTED,duration:2e3,position:"bottom"}).present()})},t}(),F=function(){return function(){}}(),A=n(78),x=n(383),D=n(384),R=n(385),U=n(386),B=n(387),j=n(388),H=n(389),Y=n(390),z=n(391),G=n(191),K=n(26),q=n(22),Z=n(3),J=n(59),V=n(85),X=n(170),W=n(33),Q=n(126),$=n(41),tt=n(405),et=n(46),nt=n(96),rt=n(6),ot=n(37),st=n(10),it=n(12),at=n(13),lt=n(130),ut=n(7),ct=n(403),pt=n(54),ht=n(392),dt=n(90),gt=n(52),ft=n(393),mt=n(31),yt=n(30),_t=n(64),vt=n(18),bt=n(404),wt=n(70),St=n(45),Tt=n(23),Ot=n(93),Pt=n(95),Lt=n(42),Nt=n(141),Et=n(34),Ct=n(69),kt=n(67),It=n(134),Mt=n(142),Ft=c.X({encapsulation:2,styles:[],data:{}}),At=c.V("ng-component",M,function(t){return c._22(0,[(t()(),c.Z(0,0,null,null,1,"ng-component",[],null,null,null,l,Ft)),c.Y(1,49152,null,0,M,[rt.a,at.a,$.a,N.a,Z.a,Ot.a,Pt.a,Lt.a,Nt.a,Et.a,Ct.a,kt.a,It.a,Mt.a,k.a],null,null)],null,null)},{},{},[]),xt=n(180),Dt=n(249),Rt=n(133),Ut=n(28),Bt=n(86),jt=n(87),Ht=n(89),Yt=n(88),zt=n(127),Gt=n(166),Kt=n(179),qt=n(43),Zt=n(132),Jt=n(192),Vt=n(80),Xt=n(60),Wt=n(184),Qt=n(108),$t=n(128),te=n(182),ee=n(204),ne=n(53),re=n(94),oe=n(205),se=n(382),ie=n(181),ae=n(171),le=n(183),ue=c.W(F,[A.b],function(t){return c._10([c._11(512,c.i,c.S,[[8,[x.a,D.a,R.a,U.a,B.a,j.a,H.a,Y.a,z.a,At]],[3,c.i],c.s]),c._11(5120,c.r,c._9,[[3,c.r]]),c._11(4608,vt.l,vt.k,[c.r,[2,vt.t]]),c._11(5120,c.b,c._0,[]),c._11(5120,c.p,c._6,[]),c._11(5120,c.q,c._7,[]),c._11(4608,u.c,u.q,[vt.c]),c._11(6144,c.D,null,[u.c]),c._11(4608,u.f,xt.a,[]),c._11(5120,u.d,function(t,e,n,r,o){return[new u.k(t,e),new u.o(n),new u.n(r,o)]},[vt.c,c.u,vt.c,vt.c,u.f]),c._11(4608,u.e,u.e,[u.d,c.u]),c._11(135680,u.m,u.m,[vt.c]),c._11(4608,u.l,u.l,[u.e,u.m]),c._11(5120,Dt.a,h.d,[]),c._11(5120,Dt.c,h.e,[]),c._11(4608,Dt.b,h.c,[Dt.a,Dt.c]),c._11(5120,c.B,h.f,[u.l,Dt.b,c.u]),c._11(6144,u.p,null,[u.m]),c._11(4608,c.G,c.G,[c.u]),c._11(4608,u.h,u.h,[vt.c]),c._11(4608,u.i,u.i,[vt.c]),c._11(4608,Rt.b,h.b,[c.B,u.b]),c._11(4608,p.i,p.n,[vt.c,c.w,p.l]),c._11(4608,p.o,p.o,[p.i,p.m]),c._11(5120,p.a,function(t){return[t]},[p.o]),c._11(4608,p.k,p.k,[]),c._11(6144,p.j,null,[p.k]),c._11(4608,p.h,p.h,[p.j]),c._11(6144,p.b,null,[p.h]),c._11(5120,p.f,p.p,[p.b,[2,p.a]]),c._11(4608,p.c,p.c,[p.f]),c._11(4608,Ut.r,Ut.r,[]),c._11(4608,Ut.d,Ut.d,[]),c._11(5120,Bt.b,r,[p.c]),c._11(4608,jt.a,jt.b,[]),c._11(4608,Ht.b,Ht.a,[]),c._11(4608,Yt.b,Yt.a,[]),c._11(4608,zt.a,zt.a,[]),c._11(4608,$.a,$.a,[zt.a,Bt.b,jt.a,Ht.b,Yt.b,$.b,$.c]),c._11(4608,Gt.a,Gt.a,[at.a,Z.a]),c._11(4608,Ot.a,Ot.a,[at.a,Z.a]),c._11(4608,Kt.a,Kt.a,[]),c._11(4608,q.a,q.a,[]),c._11(4608,qt.a,qt.a,[rt.a]),c._11(4608,ot.a,ot.a,[Z.a,rt.a,c.u,it.a]),c._11(4608,Zt.a,Zt.a,[at.a,Z.a]),c._11(5120,vt.g,Jt.c,[vt.r,[2,vt.a],Z.a]),c._11(4608,vt.f,vt.f,[vt.g]),c._11(5120,Vt.b,Vt.d,[at.a,Vt.a]),c._11(5120,Tt.a,Tt.b,[at.a,Vt.b,vt.f,Xt.b,c.i]),c._11(4608,Wt.a,Wt.a,[at.a,Z.a,Tt.a]),c._11(4608,Qt.a,Qt.a,[at.a,Z.a]),c._11(4608,$t.a,$t.a,[at.a,Z.a,Tt.a]),c._11(4608,te.a,te.a,[Z.a,rt.a,it.a,at.a,st.l]),c._11(4608,Pt.a,Pt.a,[at.a,Z.a]),c._11(4608,St.a,St.a,[rt.a,Z.a]),c._11(5120,ee.a,ee.c,[ee.b]),c._11(5120,Lt.a,o,[ee.a]),c._11(4608,Et.a,Et.a,[p.c,$.a,Zt.a,Pt.a,Lt.a]),c._11(4608,ne.a,ne.a,[Et.a,Lt.a,ee.a,$.a,Pt.a]),c._11(4608,g.a,g.a,[]),c._11(4608,Ct.a,Ct.a,[Et.a,rt.a,ne.a,ee.a,$.a,g.a,Pt.a]),c._11(4608,E.a,E.a,[]),c._11(4608,Nt.a,Nt.a,[Ct.a,Lt.a,E.a]),c._11(4608,re.a,re.a,[Et.a,ne.a,Zt.a,Pt.a]),c._11(4608,kt.a,kt.a,[Et.a,re.a,ne.a,Ct.a,ee.a,$.a]),c._11(4608,oe.a,oe.a,[Et.a,$.a]),c._11(4608,It.a,It.a,[Et.a,kt.a,Lt.a,ne.a,ee.a]),c._11(4608,Mt.a,Mt.a,[Et.a,kt.a,re.a,ne.a,Lt.a,ee.a]),c._11(4608,d.a,d.a,[]),c._11(4608,f.a,f.a,[]),c._11(4608,m.a,m.a,[]),c._11(4608,y.a,y.a,[]),c._11(4608,_.a,_.a,[]),c._11(4608,v.a,v.a,[]),c._11(4608,b.a,b.a,[]),c._11(4608,O.a,O.a,[]),c._11(4608,P.a,P.a,[]),c._11(4608,L.a,L.a,[]),c._11(4608,N.a,N.a,[]),c._11(4608,C.a,C.a,[]),c._11(4608,k.a,k.a,[]),c._11(512,vt.b,vt.b,[]),c._11(512,c.k,se.a,[]),c._11(256,Z.b,{preloadModules:!0},[]),c._11(1024,ie.a,ie.b,[]),c._11(1024,rt.a,rt.b,[u.b,ie.a,c.u]),c._11(1024,Z.a,Z.c,[Z.b,rt.a]),c._11(512,it.a,it.a,[rt.a]),c._11(512,W.a,W.a,[]),c._11(512,at.a,at.a,[Z.a,rt.a,[2,W.a]]),c._11(512,st.l,st.l,[at.a]),c._11(256,Vt.a,{links:[{loadChildren:"../pages/account/account.module.ngfactory#AccountPageModuleNgFactory",name:"AccountPage",segment:"account",priority:"low",defaultHistory:[]},{loadChildren:"../pages/explore/explore.module.ngfactory#ExplorePageModuleNgFactory",name:"ExplorePage",segment:"explore",priority:"high",defaultHistory:[]},{loadChildren:"../pages/author/author.module.ngfactory#AuthorPageModuleNgFactory",name:"AuthorPage",segment:"author",priority:"low",defaultHistory:[]},{loadChildren:"../pages/feed/feed.module.ngfactory#FeedPageModuleNgFactory",name:"FeedPage",segment:"feed",priority:"high",defaultHistory:[]},{loadChildren:"../pages/following/following.module.ngfactory#FollowingPageModuleNgFactory",name:"FollowingPage",segment:"following",priority:"low",defaultHistory:[]},{loadChildren:"../pages/history/history.module.ngfactory#HistoryPageModuleNgFactory",name:"HistoryPage",segment:"history",priority:"high",defaultHistory:[]},{loadChildren:"../pages/history/sort-popover.module.ngfactory#SortPopoverModuleNgFactory",name:"SortPopover",segment:"sort-popover",priority:"low",defaultHistory:[]},{loadChildren:"../pages/list-create/list-create.module.ngfactory#ListCreatePageModuleNgFactory",name:"ListCreatePage",segment:"list-create",priority:"low",defaultHistory:[]},{loadChildren:"../pages/list-list/list-list.module.ngfactory#ListListPageModuleNgFactory",name:"ListListPage",segment:"list-list",priority:"high",defaultHistory:[]},{loadChildren:"../pages/list-view/list-view.module.ngfactory#ListViewPageModuleNgFactory",name:"ListViewPage",segment:"list-view",priority:"low",defaultHistory:[]},{loadChildren:"../pages/login/login.module.ngfactory#LoginPageModuleNgFactory",name:"LoginPage",segment:"login",priority:"low",defaultHistory:[]},{loadChildren:"../pages/search/search-popover.module.ngfactory#SearchPopoverModuleNgFactory",name:"SearchPopover",segment:"search-popover",priority:"low",defaultHistory:[]},{loadChildren:"../pages/search/search.module.ngfactory#SearchPageModuleNgFactory",name:"SearchPage",segment:"search",priority:"high",defaultHistory:[]},{loadChildren:"../pages/settings/settings.module.ngfactory#SettingsPageModuleNgFactory",name:"SettingsPage",segment:"settings",priority:"low",defaultHistory:[]},{loadChildren:"../pages/story-detail/story-detail.module.ngfactory#StoryDetailPageModuleNgFactory",name:"StoryDetailPage",segment:"story-detail",priority:"low",defaultHistory:[]},{loadChildren:"../pages/story-related/story-related.module.ngfactory#StoryRelatedPageModuleNgFactory",name:"StoryRelatedPage",segment:"story-related",priority:"low",defaultHistory:[]},{loadChildren:"../pages/story-series/story-series.module.ngfactory#StorySeriesPageModuleNgFactory",name:"StorySeriesPage",segment:"story-series",priority:"low",defaultHistory:[]},{loadChildren:"../pages/story-view/story-popover.module.ngfactory#StoryPopoverModuleNgFactory",name:"StoryPopover",segment:"story-popover",priority:"low",defaultHistory:[]},{loadChildren:"../pages/story-view/story-view.module.ngfactory#StoryViewPageModuleNgFactory",name:"StoryViewPage",segment:"story-view",priority:"low",defaultHistory:[]},{loadChildren:"../pages/tabs/tabs.module.ngfactory#TabsPageModuleNgFactory",name:"TabsPage",segment:"tabs",priority:"high",defaultHistory:[]},{loadChildren:"../pages/top-list/top-list.module.ngfactory#TopListPageModuleNgFactory",name:"TopListPage",segment:"top-list",priority:"low",defaultHistory:[]},{loadChildren:"../parts/bookmark-popover/bookmark-popover.module.ngfactory#BookmarkPopoverModuleNgFactory",name:"BookmarkPopover",segment:"bookmark-popover",priority:"low",defaultHistory:[]},{loadChildren:"../parts/export-popover/export-popover.module.ngfactory#ExportPopoverModuleNgFactory",name:"ExportPopover",segment:"export-popover",priority:"low",defaultHistory:[]}]},[]),c._11(512,c.h,c.h,[]),c._11(512,ae.a,ae.a,[c.h]),c._11(1024,Xt.b,Xt.c,[ae.a,c.o]),c._11(1024,c.c,function(t,e,n,r,o,s,i,a,l,c,p,h,d){return[u.s(t),le.a(e),Kt.b(n,r),te.b(o,s,i,a,l),Xt.d(c,p,h,d)]},[[2,c.t],Z.a,rt.a,it.a,Z.a,rt.a,it.a,at.a,st.l,Z.a,Vt.a,Xt.b,c.u]),c._11(512,c.d,c.d,[[2,c.c]]),c._11(131584,c.f,c.f,[c.u,c.T,c.o,c.k,c.i,c.d]),c._11(512,c.e,c.e,[c.f]),c._11(512,u.a,u.a,[[3,u.a]]),c._11(512,h.a,h.a,[]),c._11(512,p.e,p.e,[]),c._11(512,p.d,p.d,[]),c._11(512,S.a,S.a,[]),c._11(512,Ut.p,Ut.p,[]),c._11(512,Ut.g,Ut.g,[]),c._11(512,Ut.n,Ut.n,[]),c._11(512,Jt.a,Jt.a,[]),c._11(512,w.a,w.a,[]),c._11(512,F,F,[]),c._11(256,p.l,"XSRF-TOKEN",[]),c._11(256,p.m,"X-XSRF-TOKEN",[]),c._11(256,$.c,void 0,[]),c._11(256,$.b,void 0,[]),c._11(256,A.a,M,[]),c._11(256,vt.a,"/",[]),c._11(256,ee.b,null,[])])}),ce=this;window.consoleLog=[],console=new Proxy(console,{get:function(t,e){var n=t[e];return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var o=n.apply(ce,t);try{window.consoleLog.push(JSON.parse(JSON.stringify({prop:e,args:t}))),window.consoleLog.length>75&&window.consoleLog.shift()}catch(t){}return o}}}),console.info("App started",(new Date).getTime()),Object(c.M)(),Object(u.j)().bootstrapModuleFactory(ue)},42:function(t,e,n){"use strict";n.d(e,"a",function(){return r});n(0),n(44);var r=function(){function t(t,e){this.storage=t,this.SETTINGS_KEY="_settings",this.settings={},this._defaults=e}return t.prototype.load=function(){var t=this;return this.storage.get(this.SETTINGS_KEY).then(function(e){return e?(t.settings=e,t._mergeDefaults(t._defaults)):t.setAll(t._defaults).then(function(e){t.settings=e})})},t.prototype._mergeDefaults=function(t){for(var e in t)e in this.settings||(this.settings[e]=t[e]);return this.setAll(this.settings)},t.prototype.merge=function(t){for(var e in t)this.settings[e]=t[e];return this.save()},t.prototype.setValue=function(t,e){return this.settings[t]=e,this.storage.set(this.SETTINGS_KEY,this.settings)},t.prototype.setAll=function(t){return this.storage.set(this.SETTINGS_KEY,t)},t.prototype.getValue=function(t){return this.storage.get(this.SETTINGS_KEY).then(function(e){return e[t]})},t.prototype.save=function(){return this.setAll(this.settings)},Object.defineProperty(t.prototype,"allSettings",{get:function(){return this.settings},enumerable:!0,configurable:!0}),t}()},53:function(t,e,n){"use strict";n.d(e,"a",function(){return a});n(0);var r=n(57),o=(n.n(r),n(360)),s=(n.n(o),n(683)),i=(n.n(s),n(44),n(58),n(40),n(68)),a=(n(34),n(42),function(){function t(t,e,n,r,o){var s=this;this.api=t,this.settings=e,this.storage=n,this.translate=r,this.toastCtrl=o,this.ready=new Promise(function(t,e){Promise.all([s.settings.load(),s.storage.get(i.i)]).then(function(e){!s.settings.allSettings.offlineMode&&e[1]&&(s.user=e[1],s.user.date+31104e6<(new Date).getTime()&&setTimeout(function(){s.translate.get(["SESSIONTIMEOUT_MSG","CLOSE_BUTTON"]).subscribe(function(t){s.toastCtrl.create({message:t.SESSIONTIMEOUT_MSG,showCloseButton:!0,closeButtonText:t.CLOSE_BUTTON,duration:15e3}).present(),s.removeStoredUser()})},2e3)),t()})})}return t.prototype.onReady=function(){return this.ready},t.prototype.login=function(t){var e=this,n=this.api.showLoader(),o=new FormData;return o.append("username",t.username),o.append("password",String(s.Md5.hashStr(t.password))),this.api.post("2/auth/login",o,void 0,!0).map(function(o){if(!o.success)throw n&&n.dismiss(),r.Observable.throw(o);e.processAndGetMoreInfo(o,t),n&&n.dismiss()})},t.prototype.processAndGetMoreInfo=function(t,e){this.user={id:t.login.user.user_id,username:t.login.user.username,session:t.login.session_id,date:(new Date).getTime()},this.storage.set(i.i,this.user);var n=new FormData;n.append("command","Login"),n.append("uname",e.username),n.append("pwd",e.password),this.api.post("members/login.php",n,{withCredentials:!0},void 0,2).subscribe()},t.prototype.isLoggedIn=function(){return this.user&&!this.settings.allSettings.offlineMode},t.prototype.getId=function(){return this.user.id},t.prototype.getName=function(){return this.user.username},t.prototype.getSession=function(){return this.user.session},t.prototype.getDetails=function(){return this.user},t.prototype.checkIfEverythingIsFucked=function(){var t=this;return new Promise(function(e){t.storage.get(i.i).then(function(n){JSON.stringify(t.user)!==JSON.stringify(n)?e(!0):e(!1)})})},t.prototype.removeStoredUser=function(){this.storage.remove(i.i),this.storage.remove(i.a)},t.prototype.logout=function(){this.user=null,this.removeStoredUser(),window.location.reload()},t}())},67:function(t,e,n){"use strict";n.d(e,"a",function(){return l});n(0);var r=n(57),o=(n.n(r),n(44),n(40),n(396)),s=n(68),i=(n(94),n(53),n(69),n(34),this&&this.__assign||Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t}),a=function(t){var e=document.createElement("textarea");e.innerHTML=t;return e.value},l=function(){function t(t,e,n,r,o,i){var a=this;this.api=t,this.a=e,this.user=n,this.g=r,this.storage=o,this.translate=i,this.stories=new Map,this.ready=new Promise(function(t,e){a.storage.keys().then(function(e){if(e.length<1)t();else{var n=e.length-1;a.storage.forEach(function(e,r,o){0===r.indexOf(s.h)&&a.stories.set(e.id,e),o===n&&t()})}})})}return t.prototype.onReady=function(){return this.ready},t.prototype.searchStory=function(t,e,n,r){var o=i({q:t},e);return e.astags?this.tagsearch(o,n):this.newsearch(o,n)},t.prototype.getSeries=function(t){var e=[{property:"series_id",value:parseInt(t)}];return this.search(e)},t.prototype.getRelated=function(t){var e=[{property:"related_id",value:parseInt(t)}];return this.search(e)},t.prototype.getAuthorStories=function(t,e){var n=[{property:"user_id",value:parseInt(t)},{property:"type",value:"story"}];return this.search(n,e,null,null,"1/user-submissions")},t.prototype.getAuthorFavs=function(t,e){var n=[{property:"user_id",value:parseInt(t)},{property:"type",value:"story"}];return this.search(n,e,null,null,"1/user-favorites")},t.prototype.getTop=function(t,e){var n=[{property:"type",value:"story"}];return t&&n.push({property:"category_id",value:parseInt(t)}),this.search(n,e,null,null,"1/top")},t.prototype.getNew=function(t,e){var n=[{property:"type",value:"story"},{property:"newonly",value:"yes"}];return t&&n.push({property:"category_id",value:parseInt(t)}),this.search(n,e)},t.prototype.getById=function(t,e,n){var s=this;void 0===e&&(e=!1),void 0===n&&(n=!1);var i=this.stories.get(t);if(i&&!e&&i.length)return r.Observable.of(i);var a=[{property:"submission_id",value:parseInt(t)}],l={filter:JSON.stringify(a).trim()},u=this.api.showLoader();return this.api.get("2/submissions/pages",l).map(function(t){if(u&&!n&&u.dismiss(),!t.success)return s.api.showToast(),null;i?e&&(i.title=t.pages[0].name,i.url=t.pages[0].url,i.ratingenabled=t.pages[0].allow_vote):i=new o.a({id:t.pages[0].submission_id,title:t.pages[0].name,url:t.pages[0].url,ratingenabled:t.pages[0].allow_vote});var r=t.pages[0].tags?t.pages[0].tags.sort(function(t,e){return e.submission_count-t.submission_count}).map(function(t){return t.name}):[];return i.series=t.pages[0].series_id,i.lang=t.pages[0].lang,i.length=t.total,i.tags=r,i.content=t.pages.map(function(t){return t.content}),s.stories.set(i.id,i),i}).catch(function(e){return u&&u.dismiss(),s.api.showToast(),console.error("stories.getById",[t],e),r.Observable.of(null)})},t.prototype.rate=function(t,e){var n=this,o=[{property:"submission_id",value:parseInt(t.id)}],s=new FormData;s.append("user_id",this.user.getId()),s.append("session_id",this.user.getSession()),s.append("vote",String(e)),s.append("filter",JSON.stringify(o)),this.api.post("2/submissions/vote",s,void 0,!0).catch(function(n){return console.error("stories.rate",[t,e],n),r.Observable.throw(n)}).subscribe(function(r){r.success?t.myrating=e:r.error?n.api.showToast(r.error):n.api.showToast()})},t.prototype.downloadSeries=function(t){var e=this;return this.api.showLoader(),new Promise(function(n){var r=function(o){if(o>=t.length)return e.api.hideLoader(),void n();t[o].cached?(e.download(t[o]),e.api.updateLoader(Math.round(o+1/t.length*100)+"%"),r(o+1)):e.getById(t[o].id,!1,!0).subscribe(function(n){if(!n)return e.translate.get(["SERIES_DOWNLOAD_ERROR"]).subscribe(function(t){e.api.showToast(t.SERIES_DOWNLOAD_ERROR)}),void e.api.hideLoader();e.download(n),e.api.updateLoader(Math.round(o+1/t.length*100)+"%"),r(o+1)})};r(0)})},t.prototype.search=function(t,e,n,o,s){var i,a=this,l={page:e||1,filter:JSON.stringify(t)};return(!e||e<2)&&(i=this.api.showLoader()),this.api.get(s||"1/submissions",l,null,o).map(function(t){return i&&i.dismiss(),t.success||t.submissions?[t.submissions?t.submissions.map(function(t){return a.extractFromSearch(t)}):[],t.total]:(t.hasOwnProperty("total")||a.api.showToast(),[[],0])}).catch(function(o){return i&&i.dismiss(),a.api.showToast(),console.error("stories.search",[t,e,n],o),r.Observable.of([[],0])})},t.prototype.newsearch=function(t,e,n,o,s){var a=this;void 0===s&&(s=!1),s?Array.isArray(t.category)&&(t.category=parseInt(t.category[0])):(t.category&&(t.categories=t.category.map(function(t){return parseInt(t)})),delete t.category);var l,u={params:JSON.stringify(i({page:e||1},t))};return(!e||e<2)&&(l=this.api.showLoader()),this.api.get(o||"3/search/stories",u,null,n).map(function(t){l&&l.dismiss();var e=s?t.submissions:t.data,n=s?t.meta.submissions_count:t.meta.total;return e?[e.map(function(t){return a.extractFromNewSearch(t)}),n]:(n||a.api.showToast(),[[],0])}).catch(function(n){return l&&l.dismiss(),a.api.showToast(),console.error("stories.newsearch",[t,e,s],n),r.Observable.of([[],0])})},t.prototype.tagsearch=function(t,e,n,r){var o=this,s={params:JSON.stringify({tags:t.q.split(",").map(function(t){return t.trim()})})};return delete t.q,(!e||e<2)&&this.api.showLoader(),this.api.get(r||"3/tagsportal/by-name",s,null,n).map(function(t){return t.map(function(t){return t.id})}).mergeMap(function(n){var r=i({tags:n,sort_by:t.sort},t);return o.newsearch(r,e,0,"3/tagsportal/stories",!0)})},t.prototype.download=function(t){t.downloaded=!0,t.downloadedtimestamp=new Date,t.cached=!0,this.storage.set(s.h+"_"+t.id,t)},t.prototype.undownload=function(t){t.downloaded=!1,t.downloadedtimestamp=null,t.cached?this.storage.set(s.h+"_"+t.id,t):this.storage.remove(s.h+"_"+t.id)},t.prototype.cache=function(t){t.cached=!0,this.storage.set(s.h+"_"+t.id,t)},t.prototype.uncache=function(t){t.cached=!1,this.undownload(t)},t.prototype.uncacheAll=function(t){var e=this;this.stories.forEach(function(n){t&&n.downloaded||e.uncache(n)})},t.prototype.extractFromFeed=function(t){var e=this.stories.get(t.what.id);if(e)return e;var n=this.a.extractFromFeed(t.who),r=new o.a({author:n,id:t.what.id.toString(),title:t.what.title,description:t.what.description,category:a(t.what.category_info.name),categoryID:t.what.category,lang:this.g.getLanguage(t.what.language),timestamp:t.when,rating:t.what.rate_all,viewcount:t.what.view_count,url:t.what.url,tags:t.what.tags?t.what.tags.map(function(t){return t.tag}):[],ishot:t.what.is_hot,isnew:t.what.is_new,iswriterspick:t.what.writers_pick,iscontestwinner:t.what.contest_winner,commentsenabled:t.what.enable_comments,ratingenabled:t.what.allow_vote});return this.stories.set(r.id,r),r},t.prototype.extactFromList=function(t){var e=this.stories.get(t.id);if(e)return e;var n=this.a.extractFromFeed(t.author),r=new o.a({author:n,id:t.id.toString(),title:t.title,description:t.description,category:a(t.category_info.name),categoryID:t.category,lang:this.g.getLanguage(t.language),timestamp:Math.round(Date.parse(t.date_added)/1e3),rating:t.rate_all,viewcount:t.view_count,url:t.url,tags:t.tags?t.tags.map(function(t){return t.tag}):[],ishot:t.is_hot,isnew:t.is_new,iswriterspick:t.writers_pick,iscontestwinner:t.contest_winner,commentsenabled:t.enable_comments>0,ratingenabled:t.allow_vote});return this.stories.set(r.id,r),r},t.prototype.extractFromSearch=function(t){var e=this.stories.get(t.id);if(e)return e;var n=this.a.extractFromSearch(t.user),r=new o.a({author:n,id:t.id.toString(),title:t.name,description:t.description,category:t.category.name,categoryID:t.category.id,lang:t.lang,timestamp:t.timestamp_published,rating:t.rate,viewcount:t.view_count,url:t.url,ishot:"no"!==t.is_hot,isnew:"no"!==t.is_new,iswriterspick:"no"!==t.writers_pick,iscontestwinner:"no"!==t.contest_winner,commentsenabled:t.enable_comments>0,ratingenabled:t.allow_vote>0});return this.stories.set(r.id,r),r},t.prototype.extractFromNewSearch=function(t){var e=this.stories.get(t.id);if(e)return e;var n=t.date_approve.split("/"),r=this.a.extractFromNewSearch(t.author),s=new o.a({author:r,id:t.id.toString(),title:t.title,description:t.description,category:a(t.category_info.name),categoryID:t.category,lang:this.g.getLanguage(t.language),timestamp:Math.round(Date.parse(n[2]+"-"+n[0]+"-"+n[1]+"T00:00:00")/1e3),rating:t.rate_all,viewcount:t.view_count,url:t.url,ishot:t.is_hot,isnew:t.is_new,iswriterspick:t.writers_pick,iscontestwinner:t.contest_winner>0,commentsenabled:t.enable_comments>0,ratingenabled:t.allow_vote>0});return this.stories.set(s.id,s),s},t}()},68:function(t,e,n){"use strict";n.d(e,"f",function(){return r}),n.d(e,"e",function(){return o}),n.d(e,"g",function(){return s}),n.d(e,"c",function(){return i}),n.d(e,"h",function(){return a}),n.d(e,"i",function(){return l}),n.d(e,"a",function(){return u}),n.d(e,"d",function(){return c}),n.d(e,"b",function(){return p}),n.d(e,"j",function(){return h});var r="_queries",o="_recentqueries",s="_storystyle",i="_history",a="_story",l="_user",u="_feed",c="_list",p="_globals",h="_version"},69:function(t,e,n){"use strict";n.d(e,"a",function(){return s});n(0);var r=n(57),o=(n.n(r),n(44),n(40),n(138),n(58),n(34),n(53),n(68)),s=function(){function t(t,e,n,r,s,i,a){var l=this;this.api=t,this.platform=e,this.user=n,this.storage=r,this.translate=s,this.browser=i,this.toastCtrl=a,this.version=18,this.storage.get(o.j).then(function(t){t&&t!==l.version&&setTimeout(function(){l.translate.get(["UPDATED_MSG","CLOSE_BUTTON"]).subscribe(function(t){l.toastCtrl.create({message:t.UPDATED_MSG,showCloseButton:!0,closeButtonText:t.CLOSE_BUTTON,duration:15e3}).present(),l.user.removeStoredUser()})},2e3),l.storage.set(o.j,l.version)}),this.ready=new Promise(function(t,e){l.storage.get(o.b).then(function(e){e?(l.globals=e,t()):l.query().subscribe(function(){t()})})})}return t.prototype.onReady=function(){return this.ready},t.prototype.getLanguage=function(t){var e=this;return this.globals.languages?Object.keys(this.globals.languages).filter(function(n){var r=e.globals.languages[n];if(parseInt(r.id)===t)return r.shortname})[0]:null},t.prototype.getPopularTags=function(){return this.api.get("3/tagsportal/top",{limit:100,periodCheck:!1,period:"all"})},t.prototype.getVersion=function(){return this.version},t.prototype.checkForUpdates=function(){var t=this;this.api.get("app.json",void 0,void 0,3).catch(function(t){return console.error("globals.checkForUpdates",t),r.Observable.of(!1)}).subscribe(function(e){t.translate.get(["UPDATE_FAILEDMSG","UPDATE_MSG","DOWNLOAD_BUTTON"]).subscribe(function(n){e?(e.appid!==t.api.appid&&(t.api.appid=e.appid),e.apikey!==t.api.apikey&&(t.api.apikey=e.apikey),e.version>t.version&&t.platform.is("cordova")&&t.api.showToast(n.UPDATE_MSG,15e3,n.DOWNLOAD_BUTTON).then(function(n){t.browser.openUrl(e.updatelink||"https://theilluminatus.github.io/litapp")})):t.api.showToast(n.UPDATE_FAILEDMSG)})})},t.prototype.query=function(){var t=this;if(this.globals)return r.Observable.of(this.globals);var e=this.api.showLoader();return this.api.get("3/constants",null,null,null,1e4).map(function(n){return e&&e.dismiss(),n?(t.globals=n,t.storage.set(o.b,t.globals),t.globals):(t.api.showToast(),null)}).catch(function(n){return e&&e.dismiss(),t.api.showToast(),console.error("globals.query",n),r.Observable.of(null)})},t}()},94:function(t,e,n){"use strict";n(0),n(1),n(58);var r=n(57),o=function(){return function(t){for(var e in t)this[e]=t[e]}}();n(53),n(34);n.d(e,"a",function(){return s});var s=function(){function t(t,e,n,r){this.api=t,this.user=e,this.loadingCtrl=n,this.toastCtrl=r,this.authors=new Map}return t.prototype.getDetails=function(t){var e=this,n=[{property:"user_id",value:t}],s={filter:JSON.stringify(n).trim()},i=this.authors.get(t);if(i&&i.bio)return r.Observable.of(i);var a=this.api.showLoader();return this.api.get("1/user-bio",s).map(function(t){return a&&a.dismiss(),t.success?(i||(i=new o({id:t.user.profile.id,picture:t.user.profile.userpic,name:t.user.profile.username})),i.storycount=t.user.profile.submissions_count,i.bio=t.user.profile.description,e.authors.set(i.id,i),i):(e.api.showToast(),null)}).catch(function(n){return a&&a.dismiss(),e.api.showToast(),console.error("author.getDetails",[t],n),r.Observable.of(null)})},t.prototype.getFollowing=function(){var t=this,e=this.api.showLoader();return this.api.get("3/users/"+this.user.getId()+"/favorite/authors?params={%22nocache%22:true}").map(function(n){return e&&e.dismiss(),n.length?n.map(function(e){return t.extractFromFeed(e)}):(t.api.showToast(),[])}).catch(function(n){return e&&e.dismiss(),t.api.showToast(),console.error("author.getFollowing",n),r.Observable.of([])})},t.prototype.follow=function(t){var e=this,n=new FormData;return n.append("type","member"),n.append("id",t.id),this.api.post("3/users/follow/"+t.id,{}).map(function(t){return t.success||e.api.showToast(),t.success}).catch(function(n){return e.api.showToast(),console.error("author.follow",[t],n),r.Observable.of(!1)}).subscribe(function(n){n?t.following=!0:e.api.showToast()})},t.prototype.unfollow=function(t){var e=this;return this.api.delete("3/users/follow/"+t.id).map(function(t){return t.success||e.api.showToast(),t.success}).catch(function(n){return e.api.showToast(),console.error("author.unfollow",[t],n),r.Observable.of(!1)}).subscribe(function(e){e&&(t.following=!1)})},t.prototype.extractFromFeed=function(t){var e=this.authors.get(t.id);return e&&e.updatetimestamp?e:(e||(e=new o({id:t.userid,name:t.username,picture:t.userpic})),e.jointimestamp=t.joindate,e.following=!0,this.authors.set(e.id,e),e)},t.prototype.extractFromSearch=function(t){var e=this.authors.get(t.id);if(e)return e;var n=new o({id:t.id,name:t.username,picture:t.userpic});return this.authors.set(n.id,n),n},t.prototype.extractFromNewSearch=function(t){var e=this.authors.get(t.userid);if(e)return e;var n=new o({id:t.userid,name:t.username,picture:t.userpic});return this.authors.set(n.id,n),n},t}()}},[406]);