webpackJsonp([23],{134:function(t,e,r){"use strict";r.d(e,"a",function(){return i});r(0);var o=r(53),n=(r.n(o),r(38),r(404)),s=(r(44),r(63),r(55),r(39),r(57)),i=(r(34),function(){function t(t,e,r,o,n,i){var a=this;this.api=t,this.s=e,this.settings=r,this.user=o,this.storage=n,this.ux=i,this.ready=new Promise(function(t,e){Promise.all([a.settings.load(),a.user.onReady(),a.s.onReady(),a.storage.get(s.d)]).then(function(e){if(!a.settings.allSettings.cachelists||a.settings.allSettings.offlineMode||!a.user.isLoggedIn())return t(),void(e[3]&&a.storage.remove(s.d));e[3]&&(a.lists=e[3]),a.query(!0).subscribe(function(e){var r=0;e.forEach(function(o,n){a.getById(o.urlname,!0).subscribe(function(o){(r+=1)===e.length&&t()})})})})})}return t.prototype.onReady=function(){return this.ready},t.prototype.query=function(t){var e=this;if(this.lists)return o.Observable.of(this.lists);var r;return t||(r=this.ux.showLoader()),this.api.get("3/users/"+this.user.getId()+"/lists").map(function(t){return r&&r.dismiss(),t.error?(e.ux.showToast(),console.error("lists.query",t.error),[]):(e.lists=t.map(function(t){return new n.a({id:t.id,urlname:t.urlname,name:t.title,description:t.description,visibility:!t.is_private,size:t.stories_count,isdeletable:t.is_deletable,createtimestamp:t.created_at,updatetimestamp:t.updated_at,lastPage:-1})}),e.storage.set(s.d,e.lists),e.lists)}).catch(function(t){return r&&r.dismiss(),e.ux.showToast(),console.error("lists.query",t),o.Observable.of([])})},t.prototype.getById=function(t,e){var r=this,n=this.lists.find(function(e){return e.urlname===t});if(n.stories)return o.Observable.of(n);var i;return e||(i=this.ux.showLoader()),o.Observable.create(function(e){var o=function(a,u){r.getListPage(t,i,Object.assign({},u),a).subscribe(function(t){if(t){var l=u;if(u.stories?l.stories=l.stories.concat(t.stories):l=t,t.size>l.stories.length&&a<l.lastPage){var c=a+1;r.ux.updateLoader(Math.round(l.stories.length/t.size*100)+"%"),o(c,l)}else r.lists[r.lists.indexOf(n)]=l,r.storage.set(s.d,r.lists),i&&i.dismiss(),e.next(l),e.complete()}})};o(1,n)})},t.prototype.getListPage=function(t,e,r,s){var i=this;void 0===s&&(s=1);var a={page:s,sort:"dateadd"};return this.api.get("3/users/"+this.user.getId()+"/lists/"+t,{params:JSON.stringify(a)}).map(function(e){if(!e.works.data)return i.ux.showToast(),console.error("lists.getListPage",[t,r,s]),null;var o=r;return r||(o=new n.a({id:e.list.id,urlname:e.list.urlname,name:e.list.title,description:e.list.description,visibility:!e.list.is_private,size:e.list.stories_count,isdeletable:e.list.is_deletable,createtimestamp:e.list.created_at,updatetimestamp:e.list.updated_at})),o.lastPage=e.works.meta.last_page,o.stories=e.works.data.map(function(t){return i.s.extactFromList(t)}),o}).catch(function(n){return e&&e.dismiss(),i.ux.showToast(),console.error("lists.getListPage",[t,r,s],n),o.Observable.of(null)})},t.prototype.addStory=function(t,e){var r=this;return this.api.put("3/stories/"+e.id+"/lists/"+t.id,{}).map(function(t){return t.success}).catch(function(n){return r.ux.showToast(),console.error("lists.addStory",[t,e],n),o.Observable.of(!1)}).subscribe(function(o){o?(t.stories||(t.stories=[]),t.stories.push(e),t.size+=1,r.storage.set(s.d,r.lists)):(r.ux.showToast(),console.error("lists.addStory",[t,e]))})},t.prototype.removeStory=function(t,e){var r=this;return this.api.delete("3/stories/"+e.id+"/lists/"+t.id).map(function(t){return t.success}).catch(function(n){return r.ux.showToast(),console.error("lists.removeStory",[t,e],n),o.Observable.of(!1)}).subscribe(function(o){if(o){if(!t.stories)return;t.stories.forEach(function(r,o){r.id===e.id&&t.stories.splice(o,1)}),t.size-=1,r.storage.set(s.d,r.lists)}else r.ux.showToast(),console.error("lists.removeStory",[t,e])})},t.prototype.add=function(t){var e=this,r={title:t.name,description:t.description,isPrivate:t.visibility?0:1};return this.api.post("3/users/"+this.user.getId()+"/lists",r,void 0,!1).map(function(r){return r.success?(e.lists.push(new n.a({id:r.list.id,urlname:r.list.urlname,name:r.list.title,description:r.list.description,visibility:!r.list.is_private,size:r.list.stories_count,isdeletable:r.list.is_deletable,createtimestamp:r.list.created_at})),e.storage.set(s.d,e.lists),!0):(e.ux.showToast(),console.error("lists.add",[t]),!1)}).catch(function(r){return e.ux.showToast(),console.error("lists.add",[t],r),o.Observable.of(!1)})},t.prototype.edit=function(t){var e=this;return this.api.patch("3/lists/"+t.id,{title:t.name,description:t.description,isPrivate:t.visibility?0:1}).map(function(r){return r.success?(e.lists.forEach(function(e){e.id===t.id&&(e.name=r.list.title,e.description=r.list.description,e.visibility=!r.list.is_private)}),e.storage.set(s.d,e.lists),!0):(e.ux.showToast(),console.error("lists.edit",[t]),!1)}).catch(function(r){return e.ux.showToast(),console.error("lists.edit",[t],r),o.Observable.of(!1)})},t.prototype.delete=function(t){var e=this;return this.api.delete("3/lists/"+t.id).map(function(r){return r.success?(e.lists.forEach(function(r,o){r.urlname===t.urlname&&e.lists.splice(o,1)}),e.storage.set(s.d,e.lists),!0):(e.ux.showToast(),console.error("lists.delete",[t]),!1)}).catch(function(r){return e.ux.showToast(),console.error("lists.delete",[t],r),o.Observable.of(!1)})},t.prototype.refresh=function(){return this.storage.remove(s.d),this.lists=null,this.query()},t}())},141:function(t,e,r){"use strict";r.d(e,"a",function(){return n});r(0),r(172),r(70);var o=r(204),n=(r(44),function(){function t(t,e,r){var n=this;this.g=t,this.settings=e,this.googleAnalytics=r,Promise.all([this.settings.load(),this.g.onReady()]).then(function(){if(!n.settings.allSettings.offlineMode)try{Promise.all([n.googleAnalytics.startTrackerWithId("UA-142185587-2",120),n.googleAnalytics.setAnonymizeIp(!0),n.googleAnalytics.setAllowIDFACollection(!1),n.googleAnalytics.setAppVersion(n.g.getVersion().toString())]).then(function(){n.track("Startup")}).catch(function(t){return Object(o.a)(t)})}catch(t){Object(o.a)(t)}})}return t.prototype.track=function(t){console.info("Track",t),this.settings.allSettings.offlineMode||this.googleAnalytics.trackView(t)},t}())},142:function(t,e,r){"use strict";r(0),r(1);var o=r(53),n=(r(38),function(){return function(t){for(var e in t)this[e]=t[e]}}()),s=(r(63),r(95),r(55),r(44),r(57));r(39),r(34);r.d(e,"a",function(){return i});var i=function(){function t(t,e,r,o,n,i,a){var u=this;this.api=t,this.s=e,this.a=r,this.user=o,this.settings=n,this.storage=i,this.ux=a,this.timeout=6e5,this.feedtimeout=(new Date).getTime()+this.timeout,this.feedbadge="",this.ready=new Promise(function(t,e){Promise.all([u.settings.load(),u.user.onReady()]).then(function(){u.settings.allSettings.checkforfeedupdates&&!u.settings.allSettings.offlineMode&&u.user.isLoggedIn()?(u.feedbadge="Â·",u.query().subscribe(function(e){e?u.storage.get(s.a).then(function(r){for(var o=0;o<e.length;o+=1)if(r===e[o].id){u.feedbadge=String(o);break}""===u.feedbadge&&(u.feedbadge="15+"),t()}):t()})):t()})})}return t.prototype.onReady=function(){return this.ready},t.prototype.query=function(t,e,r){var s=this;if(void 0===r&&(r=!1),!r&&!t&&this.feed&&(new Date).getTime()<this.feedtimeout)return o.Observable.of(this.feed);t&&this.feed||(this.feed=[]);var i;e&&(i=this.ux.showLoader());var a={chunked:1,limit:10};return t&&(a.last_id=t),this.api.get("3/activity/wall?params="+JSON.stringify(a)).map(function(e){if(i&&i.dismiss(),!e.data)return s.ux.showToast(),console.error("feed.query",[t]),[];var r=e.data.map(function(t){var e="published-story"===t.action;try{return new n({id:t.id,timestamp:t.when,author:s.a.extractFromFeed(t.who),text:e?[]:Array.isArray(t.what)?t.what:["their profile"],story:e?s.s.extractFromFeed(t):void 0})}catch(t){return new n(null)}});return r.forEach(function(t){return s.feed.push(t)}),s.feedtimeout=(new Date).getTime()+s.timeout,r}).catch(function(e){return i&&i.dismiss(),s.ux.showToast(),console.error("feed.query",[t],e),o.Observable.of([])})},t}()},191:function(t,e,r){"use strict";r(141),r(39),r(63),r(95),r(134),r(207),r(142),r(70),r(222);var o=r(44);r(55),r(34);r.d(e,"a",function(){return o.a})},204:function(t,e,r){"use strict";r.d(e,"a",function(){return o});var o=function(t,e){if("cordova_not_available"!==t)throw t;e&&e(t)}},207:function(t,e,r){"use strict";r.d(e,"a",function(){return s});r(0),r(42);var o=r(40),n=(r.n(o),r(405)),s=(r(39),function(){function t(t,e){var r=this;this.api=t,this.translate=e,this.categories=[],this.sortMap=new Map,this.categories=this.api.get("3/tagsportal/categories",null).map(function(t){var e=[];return t.forEach(function(t){e.push(new n.a({id:t.id,name:t.name,description:t.ldesc,type:t.type,url:t.pageUrl}))}),r.translate.get(["EXPLORE_ALLCAT","EXPLORE_ALLCATDESCR"]).subscribe(function(t){e.push(new n.a({id:0,name:t.EXPLORE_ALLCAT,description:t.EXPLORE_ALLCATDESCR,type:"master",url:""}))}),e}),this.sortMap.set("master",0),this.sortMap.set("story",1),this.sortMap.set("poem",2)}return t.prototype.mapSorter=function(t){return function(e,r){return t.get(e.type)>t.get(r.type)?1:t.get(e.type)<t.get(r.type)?-1:e.name>r.name?1:e.name<r.name?-1:void 0}},t.prototype.get=function(t){return this.categories.map(function(e){return e.find(function(e){return e.id===t})})},t.prototype.getAll=function(){return this.categories.map(function(t){return t.filter(function(t){return["master","story","poem"].includes(t.type)})})},t.prototype.getAllSorted=function(){var t=this;return this.getAll().map(function(e){return e.sort(t.mapSorter(t.sortMap))})},t.prototype.getAllSortedGrouped=function(){var t=this;return this.getAllSorted().map(function(e){var r=[];return t.sortMap.forEach(function(t,o){r.push(e.filter(function(t){return t.type===o}))}),r})},t.prototype.getClosestCategory=function(t){return this.getAll().map(function(e){return e.find(function(e){return!(!e.id||e.id.toString()!==t)||(!(!e.name||e.name!==t)||!!(e.name&&e.name.toLowerCase().indexOf(t.toLowerCase())>-1))})})},t.prototype.getType=function(t){return this.sortMap.has(t)?this.getAllSorted().map(function(e){return e.filter(function(e){return e.type===t})}):(console.error("categories.getType",[t],"Unsupported Category Type"),new o.EmptyObservable)},t}())},222:function(t,e,r){"use strict";r.d(e,"a",function(){return s});r(0);var o=r(53),n=(r.n(o),r(38),r(63),r(57)),s=function(){function t(t,e){var r=this;this.stories=t,this.storage=e,this.history=[],this.ready=new Promise(function(t,e){Promise.all([r.stories.onReady()]).then(function(){r.storage.get(n.c).then(function(e){var o=0;if(e){var n=[];e.forEach(function(s,i){r.stories.getById(s).subscribe(function(s){s&&(n[i]=s),(o+=1)===e.length&&(r.history=n,r.clean().then(function(){return t()}))})})}else r.history=[],t()})})})}return t.prototype.onReady=function(){return this.ready},t.prototype.getDownloadStories=function(){var t=this;return new Promise(function(e){t.storage.length().then(function(r){var s=[];t.storage.forEach(function(i,a,u){a.indexOf(n.i)>-1&&i.downloaded&&s.push(i.id),u>=r&&o.Observable.forkJoin(s.map(function(e){return t.stories.getById(e)})).subscribe(function(t){var r=t.sort(function(t,e){return e.downloadedtimestamp-t.downloadedtimestamp});e(r)})})})})},t.prototype.getStories=function(){return this.history.slice()},t.prototype.getIds=function(){return this.history.map(function(t){return t.id})},t.prototype.persist=function(){return this.storage.set(n.c,this.getIds())},t.prototype.add=function(t){var e=this.getIds().indexOf(t.id);return e>-1&&this.history.splice(e,1),this.history.push(t),this.persist()},t.prototype.remove=function(t){var e=this.getIds().indexOf(t.id);if(e>-1)return this.history.splice(e,1),this.stories.remove(t),this.persist()},t.prototype.reset=function(){this.history=[],this.storage.set(n.c,[]),this.stories.removeAll()},t.prototype.clean=function(){var t=this;return new Promise(function(e){var r=t.history.filter(function(t,e){if(e>49)return t});r.length<1?e():r.forEach(function(o,n){o.downloaded||t.remove(o),n>=r.length-1&&e()})})},t}()},248:function(t,e){function r(t){return Promise.resolve().then(function(){throw new Error("Cannot find module '"+t+"'.")})}r.keys=function(){return[]},r.resolve=r,t.exports=r,r.id=248},289:function(t,e,r){function o(t){var e=n[t];return e?r.e(e[1]).then(function(){return r(e[0])}):Promise.reject(new Error("Cannot find module '"+t+"'."))}var n={"../pages/account/account.module.ngfactory":[687,21],"../pages/author/author.module.ngfactory":[688,7],"../pages/explore/explore.module.ngfactory":[689,18],"../pages/feed/feed.module.ngfactory":[690,6],"../pages/following/following.module.ngfactory":[692,10],"../pages/history/history.module.ngfactory":[691,2],"../pages/history/sort-popover.module.ngfactory":[693,15],"../pages/list-create/list-create.module.ngfactory":[694,13],"../pages/list-list/list-list.module.ngfactory":[695,12],"../pages/list-view/list-view.module.ngfactory":[696,1],"../pages/login/login.module.ngfactory":[697,20],"../pages/search/search-popover.module.ngfactory":[699,14],"../pages/search/search.module.ngfactory":[698,0],"../pages/settings/settings.module.ngfactory":[700,19],"../pages/story-detail/story-detail.module.ngfactory":[701,9],"../pages/story-related/story-related.module.ngfactory":[702,5],"../pages/story-series/story-series.module.ngfactory":[703,4],"../pages/story-view/story-popover.module.ngfactory":[704,16],"../pages/story-view/story-view.module.ngfactory":[705,8],"../pages/tabs/tabs.module.ngfactory":[706,22],"../pages/top-list/top-list.module.ngfactory":[707,3],"../parts/bookmark-popover/bookmark-popover.module.ngfactory":[709,11],"../parts/export-popover/export-popover.module.ngfactory":[708,17]};o.keys=function(){return Object.keys(n)},o.id=289,t.exports=o},34:function(t,e,r){"use strict";r.d(e,"a",function(){return n});r(0),r(60),r(42);var o=r(53),n=(r.n(o),function(){function t(t,e,r){this.translate=t,this.loadingCtrl=e,this.toastCtrl=r,this.activeToasts=[],this.offlineModeErrorCount=0}return t.prototype.showLoader=function(){var t=this;return this.loader?this.loader:(this.loader=this.loadingCtrl.create({spinner:"crescent"}),this.loader.present(),this.loader.onDidDismiss(function(){t.loader=void 0}),this.loader)},t.prototype.updateLoader=function(t){this.loader&&this.loader.setContent(t)},t.prototype.hideLoader=function(){this.loader&&this.loader.dismiss().catch(function(){})},t.prototype.showToast=function(t,e,r,o,n,s){var i=this;void 0===t&&(t="ERROR");var a=t+"_TAG";return new Promise(function(u){i.translate.get([e||"LOAD_ERROR",o||"CLOSE_BUTTON",a]).subscribe(function(l){var c=i.toastCtrl.create({message:l[a]+(l[e]||e||l.LOAD_ERROR),showCloseButton:!0,closeButtonText:l[o]||o||l.CLOSE_BUTTON,duration:r||3e3,cssClass:s?"overui":""});c.present(),c.onDidDismiss(function(t){u(c),i.activeToasts.splice(i.activeToasts.indexOf(c),1)}),n||"ERROR"===t&&!e?(i.activeToasts.forEach(function(t){return t.dismiss()}),i.activeToasts=[c]):i.activeToasts.push(c)})})},t.prototype.showOfflineModeError=function(){return this.offlineModeErrorCount<3&&(this.showToast("ERROR","OFFLINE_ERROR",void 0,void 0,!0),this.offlineModeErrorCount=this.offlineModeErrorCount+1),this.hideLoader(),o.Observable.of()},t}())},375:function(t,e,r){"use strict";r.d(e,"a",function(){return o});var o={CORS_PROXY:"https://litapp-cors.herokuapp.com/",DEV:!1}},39:function(t,e,r){"use strict";r.d(e,"a",function(){return u});r(0);var o=r(153),n=r(375),s=(r(44),r(34),r(2)),i=(r.n(s),this&&this.__assign||Object.assign||function(t){for(var e,r=1,o=arguments.length;r<o;r++){e=arguments[r];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t}),a=function(){function t(){}return t.prototype.encodeKey=function(t){return encodeURIComponent(t)},t.prototype.encodeValue=function(t){return encodeURIComponent(t)},t.prototype.decodeKey=function(t){return decodeURIComponent(t)},t.prototype.decodeValue=function(t){return decodeURIComponent(t)},t}(),u=function(){function t(t,e,r){this.http=t,this.ux=e,this.settings=r,this.apikey="70b3a71911b398a98d3dac695f34cf279c270ea0",this.appid="24b7c3f9d904ebd679299b1ce5506bc305a5ab40",this.corsProxy=n.a.CORS_PROXY||"",this.urls=this.getUrls();try{var o=location.search.substring(1),s=JSON.parse('{"'+decodeURI(o).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')+'"}');s.proxy&&(this.corsProxy=s.proxy,this.urls=this.getUrls())}catch(t){}}return t.prototype.getUrls=function(){return[this.corsProxy+"https://literotica.com/api",this.corsProxy+"https://search.literotica.com/api",this.corsProxy+"https://www.literotica.com",this.corsProxy+"https://raw.githubusercontent.com/theilluminatus/litapp/master",this.corsProxy+"https://literotica.com"]},t.prototype.handleAPIError=function(t,e,r,o){return console.error(i({type:"API_Error",url:e,method:o,data:r},t)),404===t.status?this.ux.showToast("ERROR","LITEROTICA_NOTFOUND",5e3):429===t.status?this.ux.showToast("ERROR","LITEROTICA_TOOMANYREQUESTS",5e3):503===t.status&&this.ux.showToast("ERROR","LITEROTICA_TEMPOFFLINE",5e3),s.Observable.of()},t.prototype.get=function(t,e,r,n,s){var i=this;if(this.settings.allSettings.offlineMode)return this.ux.showOfflineModeError();var u=r;if(r||(u={params:new o.g({encoder:new a})}),e){u.params=new o.g({encoder:new a});for(var l in e)u.params=u.params.set(l,e[l])}u.withCredentials=!0,u.params=u.params.set("apikey",this.apikey),u.params=u.params.set("appid",this.appid);var c=this.urls[n||0]+"/"+t,p=this.http.get(c,u).catch(function(t){return i.handleAPIError(t,c,u.params,"GET")});return s?p.timeout(s):p},t.prototype.post=function(t,e,r,o,n){var s=this;if(this.settings.allSettings.offlineMode)return this.ux.showOfflineModeError();var i=t;o&&(t.indexOf("?")>-1?i+="&apikey="+this.apikey+"&appid="+this.appid:i+="?apikey="+this.apikey+"&appid="+this.appid);var a=this.urls[n||0]+"/"+i;return this.http.post(a,e,r).catch(function(t){return s.handleAPIError(t,a,e,"POST")})},t.prototype.put=function(t,e,r){var o=this;if(this.settings.allSettings.offlineMode)return this.ux.showOfflineModeError();var n=this.urls[0]+"/"+t;return this.http.put(n,e,r).catch(function(t){return o.handleAPIError(t,n,e,"PUT")})},t.prototype.delete=function(t,e,r){var o=this;if(this.settings.allSettings.offlineMode)return this.ux.showOfflineModeError();var n=this.urls[r||0]+"/"+t;return this.http.delete(n,e).catch(function(t){return o.handleAPIError(t,n,{},"DELETE")})},t.prototype.patch=function(t,e,r){var o=this;if(this.settings.allSettings.offlineMode)return this.ux.showOfflineModeError();var n=this.urls[0]+"/"+t;return this.http.patch(n,e,r).catch(function(t){return o.handleAPIError(t,n,e,"PATCH")})},t}()},400:function(t,e,r){"use strict";r.d(e,"a",function(){return o});var o=function(){return function(t){for(var e in t)this[e]=t[e]}}()},404:function(t,e,r){"use strict";r.d(e,"a",function(){return o});var o=function(){return function(t){for(var e in t)this[e]=t[e]}}()},405:function(t,e,r){"use strict";r.d(e,"a",function(){return o});var o=function(){return function(t){for(var e in t)this[e]=t[e]}}()},409:function(t,e,r){"use strict";function o(t){return new T.a(t,"./assets/i18n/",".json")}function n(t){return new C.a(t,{checkforfeedupdates:!0,checkforappupdates:!0,cachelists:!0,amoledBlackTheme:!1,offlineMode:!1,enableLock:!1,forceNormalList:!1})}function s(t){return c._22(0,[(t()(),c.Z(0,0,null,null,8,"button",[["class","item item-block"],["ion-item",""],["menuClose",""]],null,[[null,"click"]],function(t,e,r){var o=!0,n=t.component;if("click"===e){o=!1!==c._13(t,6).close()&&o}if("click"===e){o=!1!==n.openLinkDialog()&&o}return o},q.b,q.a)),c.Y(1,1097728,null,3,Z.a,[W.a,K.a,c.j,c.z,[2,G.a]],null,null),c._18(335544320,7,{contentLabel:0}),c._18(603979776,8,{_buttons:1}),c._18(603979776,9,{_icons:1}),c.Y(5,16384,null,0,J.a,[],null,null),c.Y(6,16384,null,0,V.a,[X.a],{menuClose:[0,"menuClose"]},null),(t()(),c._20(7,2,["\n              ","\n            "])),c._14(131072,Q.a,[$.a,c.g])],function(t,e){t(e,6,0,"")},function(t,e){t(e,7,0,c._21(e,7,0,c._13(e,8).transform("MENU_OPENLINK")))})}function i(t){return c._22(0,[(t()(),c.Z(0,0,null,null,8,"button",[["class","item item-block"],["ion-item",""],["menuClose",""]],null,[[null,"click"]],function(t,e,r){var o=!0,n=t.component;if("click"===e){o=!1!==c._13(t,6).close()&&o}if("click"===e){o=!1!==n.openPage("AccountPage")&&o}return o},q.b,q.a)),c.Y(1,1097728,null,3,Z.a,[W.a,K.a,c.j,c.z,[2,G.a]],null,null),c._18(335544320,10,{contentLabel:0}),c._18(603979776,11,{_buttons:1}),c._18(603979776,12,{_icons:1}),c.Y(5,16384,null,0,J.a,[],null,null),c.Y(6,16384,null,0,V.a,[X.a],{menuClose:[0,"menuClose"]},null),(t()(),c._20(7,2,["\n              ","\n            "])),c._14(131072,Q.a,[$.a,c.g])],function(t,e){t(e,6,0,"")},function(t,e){t(e,7,0,c._21(e,7,0,c._13(e,8).transform("MENU_ACCOUNT")))})}function a(t){return c._22(0,[(t()(),c.Z(0,0,null,null,60,null,null,null,null,null,null,null)),(t()(),c._20(-1,null,["\n      "])),(t()(),c.Z(2,0,null,null,53,"ion-menu",[["role","navigation"]],null,null,null,tt.b,tt.a)),c._17(6144,null,et.a,null,[rt.a]),c.Y(4,245760,null,2,rt.a,[X.a,c.j,K.a,ot.a,c.z,nt.a,st.l,it.a,at.a],{content:[0,"content"]},null),c._18(335544320,2,{menuContent:0}),c._18(335544320,3,{menuNav:0}),(t()(),c._20(-1,0,["\n        "])),(t()(),c.Z(8,0,null,0,12,"ion-header",[],null,null,null,null,null)),c.Y(9,16384,null,0,ut.a,[K.a,c.j,c.z,[2,lt.a]],null,null),(t()(),c._20(-1,null,["\n          "])),(t()(),c.Z(11,0,null,null,8,"ion-toolbar",[["class","toolbar"]],[[2,"statusbar-padding",null]],null,null,ct.b,ct.a)),c.Y(12,49152,null,0,pt.a,[K.a,c.j,c.z],null,null),(t()(),c._20(-1,3,["\n            "])),(t()(),c.Z(14,0,null,3,4,"ion-title",[],null,null,null,ht.b,ht.a)),c.Y(15,49152,null,0,dt.a,[K.a,c.j,c.z,[2,pt.a],[2,ft.a]],null,null),(t()(),c._20(-1,0,["Literotica "])),(t()(),c.Z(17,0,null,0,1,"small",[],null,null,null,null,null)),(t()(),c._20(-1,null,["(unofficial)"])),(t()(),c._20(-1,3,["\n          "])),(t()(),c._20(-1,null,["\n        "])),(t()(),c._20(-1,0,["\n\n        "])),(t()(),c.Z(22,0,null,0,32,"ion-content",[],[[2,"statusbar-padding",null],[2,"has-refresher",null]],null,null,gt.b,gt.a)),c.Y(23,4374528,[[2,4]],0,mt.a,[K.a,ot.a,it.a,c.j,c.z,at.a,nt.a,c.u,[2,lt.a],[2,yt.a]],null,null),(t()(),c._20(-1,1,["\n          "])),(t()(),c.Z(25,0,null,1,28,"ion-list",[],null,null,null,null,null)),c.Y(26,16384,null,0,vt.a,[K.a,c.j,c.z,ot.a,st.l,it.a],null,null),(t()(),c._20(-1,null,["\n            "])),(t()(),c.Z(28,0,null,null,8,"button",[["class","item item-block"],["ion-item",""],["menuClose",""]],null,[[null,"click"]],function(t,e,r){var o=!0,n=t.component;if("click"===e){o=!1!==c._13(t,34).close()&&o}if("click"===e){o=!1!==n.openPage("TabsPage")&&o}return o},q.b,q.a)),c.Y(29,1097728,null,3,Z.a,[W.a,K.a,c.j,c.z,[2,G.a]],null,null),c._18(335544320,4,{contentLabel:0}),c._18(603979776,5,{_buttons:1}),c._18(603979776,6,{_icons:1}),c.Y(33,16384,null,0,J.a,[],null,null),c.Y(34,16384,null,0,V.a,[X.a],{menuClose:[0,"menuClose"]},null),(t()(),c._20(35,2,["\n              ","\n            "])),c._14(131072,Q.a,[$.a,c.g]),(t()(),c._20(-1,null,["\n\n            "])),(t()(),c.U(16777216,null,null,1,null,s)),c.Y(39,16384,null,0,_t.j,[c.I,c.F],{ngIf:[0,"ngIf"]},null),(t()(),c._20(-1,null,["\n\n            "])),(t()(),c.U(16777216,null,null,1,null,i)),c.Y(42,16384,null,0,_t.j,[c.I,c.F],{ngIf:[0,"ngIf"]},null),(t()(),c._20(-1,null,["\n\n            "])),(t()(),c.Z(44,0,null,null,8,"button",[["class","item item-block"],["ion-item",""],["menuClose",""]],null,[[null,"click"]],function(t,e,r){var o=!0,n=t.component;if("click"===e){o=!1!==c._13(t,50).close()&&o}if("click"===e){o=!1!==n.openPage("SettingsPage")&&o}return o},q.b,q.a)),c.Y(45,1097728,null,3,Z.a,[W.a,K.a,c.j,c.z,[2,G.a]],null,null),c._18(335544320,13,{contentLabel:0}),c._18(603979776,14,{_buttons:1}),c._18(603979776,15,{_icons:1}),c.Y(49,16384,null,0,J.a,[],null,null),c.Y(50,16384,null,0,V.a,[X.a],{menuClose:[0,"menuClose"]},null),(t()(),c._20(51,2,["\n              ","\n            "])),c._14(131072,Q.a,[$.a,c.g]),(t()(),c._20(-1,null,["\n          "])),(t()(),c._20(-1,1,["\n        "])),(t()(),c._20(-1,0,["\n      "])),(t()(),c._20(-1,null,["\n      "])),(t()(),c.Z(57,0,null,null,2,"ion-nav",[["root","TabsPage"]],null,null,null,wt.b,wt.a)),c._17(6144,null,et.a,null,[bt.a]),c.Y(59,4374528,[[1,4],["content",4]],0,bt.a,[[2,lt.a],[2,yt.a],at.a,K.a,ot.a,c.j,c.u,c.z,c.i,st.l,Ot.a,[2,Tt.a],it.a,c.k],{root:[0,"root"]},null),(t()(),c._20(-1,null,["\n    "]))],function(t,e){var r=e.component;t(e,4,0,c._13(e,59));t(e,34,0,"");t(e,39,0,!r.settings.allSettings.offlineMode);t(e,42,0,!r.settings.allSettings.offlineMode);t(e,50,0,"");t(e,59,0,"TabsPage")},function(t,e){t(e,11,0,c._13(e,12)._sbPadding);t(e,22,0,c._13(e,23).statusbarPadding,c._13(e,23)._hasRefresher);t(e,35,0,c._21(e,35,0,c._13(e,36).transform("MENU_HOME")));t(e,51,0,c._21(e,51,0,c._13(e,52).transform("MENU_SETTINGS")))})}function u(t){return c._22(0,[c._18(671088640,1,{nav:0}),(t()(),c._20(-1,null,["\n    "])),(t()(),c.U(16777216,null,null,1,null,a)),c.Y(3,16384,null,0,_t.j,[c.I,c.F],{ngIf:[0,"ngIf"]},null),(t()(),c._20(-1,null,["\n  "]))],function(t,e){t(e,3,0,e.component.loggedIn)},null)}Object.defineProperty(e,"__esModule",{value:!0});var l=r(48),c=r(1),p=(r(0),r(153)),h=r(251),d=r(217),f=r(138),g=r(208),m=r(218),y=r(219),v=r(255),_=r(256),w=r(257),b=r(38),O=r(42),T=r(422),x=(r(60),r(201)),S=r(227),P=r(228),E=r(124),N=r(172),I=r(229),L=r(125),C=r(191),k=function(){function t(t,e,r,o,n,s,i,a,u,l,c,p,h,d){var f=this;this.platform=t,this.app=e,this.translate=r,this.webIntent=o,this.config=n,this.alertCtrl=s,this.settings=i,this.analytics=a,this.ux=u,this.g=l,this.s=c,this.l=p,this.f=h,this.faio=d,this.loggedIn=!1,this.initTranslate(),this.settings.load().then(function(){if(!f.settings.allSettings.enableLock||f.loggedIn||f.g.isWebApp()?f.loggedIn=!0:f.showLockScreen(),!f.settings.allSettings.checkforappupdates||f.settings.allSettings.offlineMode||f.g.isWebApp()||f.g.checkForUpdates(),f.settings.allSettings.amoledBlackTheme){var t=document.createElement("link");t.setAttribute("href","./assets/black-theme.css"),t.setAttribute("rel","stylesheet"),document.head.appendChild(t)}}),this.catchShareIntent(),this.platform.resume.subscribe(function(){f.catchShareIntent()})}return t.prototype.showLockScreen=function(){var t=this;this.faio.isAvailable().then(function(e){e?t.faio.show({clientId:"litapp",clientSecret:"3}D+v862s4a6c>y5elLFj4xA",disableBackup:!1}).then(function(e){e&&(t.loggedIn=e)}).catch(function(){return t.platform.exitApp()}):t.loggedIn=!0}).catch(function(){return t.loggedIn=!0})},t.prototype.catchShareIntent=function(){var t=this;this.g.isWebApp()||this.webIntent.getIntent().then(function(e){"android.intent.action.SEND"===e.action&&e.extras&&t.openURL(e.extras["android.intent.extra.TEXT"])}).catch(function(t){return console.warn("Native: tried webIntent:",t)})},t.prototype.initTranslate=function(){var t=this;this.translate.setDefaultLang("en");var e=this.translate.getBrowserLang();if(e)if("zh"===e){var r=this.translate.getBrowserCultureLang();r.match(/-CN|CHS|Hans/i)?this.translate.use("zh-cmn-Hans"):r.match(/-TW|CHT|Hant/i)&&this.translate.use("zh-cmn-Hant")}else this.translate.use(this.translate.getBrowserLang());else this.translate.use("en");this.translate.get(["BACK_BUTTON_TEXT"]).subscribe(function(e){t.config.set("ios","backButtonText",e.BACK_BUTTON_TEXT)})},t.prototype.openPage=function(t){"TabsPage"===t.title?this.nav.setRoot(t):this.nav.push(t)},t.prototype.openLinkDialog=function(t){var e=this;this.translate.get(["MENU_OPENLINK","OPENLINK_DESCRIPTION","OK_BUTTON","CANCEL_BUTTON"]).subscribe(function(t){e.alertCtrl.create({title:t.MENU_OPENLINK,message:t.OPENLINK_DESCRIPTION,inputs:[{name:"url",placeholder:"https://www.literotica.com/..."}],buttons:[{text:t.OK_BUTTON,handler:function(t){e.openURL(t.url)}},{text:t.CANCEL_BUTTON}]}).present()})},t.prototype.openURL=function(t){var e=/literotica\.com\/s\/([-a-zA-Z0-9._+]*)/g.exec(t);if(e)return this.nav.push("SearchPage",{storyurl:e[1]}),void this.ux.showToast("INFO","OPENLINK_STORYWARNING",2500);var r=/literotica\.com\/stories\/memberpage\.php\?.*uid=([0-9]*)/g.exec(t);if(r){this.nav.push("AuthorPage",{author:{id:r[1]}})}else{var o=/literotica\.com\/p\/([-a-zA-Z0-9._+]*)/g.exec(t);this.ux.showToast("INFO",o?"OPENLINK_UNSUPPORTED_POEM":"OPENLINK_UNSUPPORTED",2500)}},t}(),A=function(){return function(){}}(),R=r(79),M=r(387),F=r(388),D=r(389),U=r(390),j=r(391),B=r(392),H=r(393),Y=r(394),z=r(395),q=r(192),Z=r(26),W=r(22),K=r(3),G=r(61),J=r(86),V=r(170),X=r(33),Q=r(126),$=r(43),tt=r(408),et=r(47),rt=r(96),ot=r(6),nt=r(37),st=r(10),it=r(12),at=r(13),ut=r(130),lt=r(7),ct=r(406),pt=r(56),ht=r(396),dt=r(91),ft=r(54),gt=r(397),mt=r(31),yt=r(30),vt=r(67),_t=r(18),wt=r(407),bt=r(71),Ot=r(46),Tt=r(23),xt=r(94),St=r(44),Pt=r(141),Et=r(34),Nt=r(70),It=r(63),Lt=r(134),Ct=r(142),kt=c.X({encapsulation:2,styles:[],data:{}}),At=c.V("ng-component",k,function(t){return c._22(0,[(t()(),c.Z(0,0,null,null,1,"ng-component",[],null,null,null,u,kt)),c.Y(1,49152,null,0,k,[ot.a,at.a,$.a,E.a,K.a,xt.a,St.a,Pt.a,Et.a,Nt.a,It.a,Lt.a,Ct.a,L.a],null,null)],null,null)},{},{},[]),Rt=r(180),Mt=r(252),Ft=r(133),Dt=r(28),Ut=r(87),jt=r(88),Bt=r(90),Ht=r(89),Yt=r(127),zt=r(166),qt=r(179),Zt=r(45),Wt=r(132),Kt=r(193),Gt=r(81),Jt=r(62),Vt=r(184),Xt=r(108),Qt=r(128),$t=r(182),te=r(189),ee=r(206),re=r(39),oe=r(55),ne=r(95),se=r(207),ie=r(222),ae=r(386),ue=r(181),le=r(171),ce=r(183),pe=c.W(A,[R.b],function(t){return c._10([c._11(512,c.i,c.S,[[8,[M.a,F.a,D.a,U.a,j.a,B.a,H.a,Y.a,z.a,At]],[3,c.i],c.s]),c._11(5120,c.r,c._9,[[3,c.r]]),c._11(4608,_t.l,_t.k,[c.r,[2,_t.t]]),c._11(5120,c.b,c._0,[]),c._11(5120,c.p,c._6,[]),c._11(5120,c.q,c._7,[]),c._11(4608,l.c,l.q,[_t.c]),c._11(6144,c.D,null,[l.c]),c._11(4608,l.f,Rt.a,[]),c._11(5120,l.d,function(t,e,r,o,n){return[new l.k(t,e),new l.o(r),new l.n(o,n)]},[_t.c,c.u,_t.c,_t.c,l.f]),c._11(4608,l.e,l.e,[l.d,c.u]),c._11(135680,l.m,l.m,[_t.c]),c._11(4608,l.l,l.l,[l.e,l.m]),c._11(5120,Mt.a,h.d,[]),c._11(5120,Mt.c,h.e,[]),c._11(4608,Mt.b,h.c,[Mt.a,Mt.c]),c._11(5120,c.B,h.f,[l.l,Mt.b,c.u]),c._11(6144,l.p,null,[l.m]),c._11(4608,c.G,c.G,[c.u]),c._11(4608,l.h,l.h,[_t.c]),c._11(4608,l.i,l.i,[_t.c]),c._11(4608,Ft.b,h.b,[c.B,l.b]),c._11(4608,p.i,p.n,[_t.c,c.w,p.l]),c._11(4608,p.o,p.o,[p.i,p.m]),c._11(5120,p.a,function(t){return[t]},[p.o]),c._11(4608,p.k,p.k,[]),c._11(6144,p.j,null,[p.k]),c._11(4608,p.h,p.h,[p.j]),c._11(6144,p.b,null,[p.h]),c._11(5120,p.f,p.p,[p.b,[2,p.a]]),c._11(4608,p.c,p.c,[p.f]),c._11(4608,Dt.r,Dt.r,[]),c._11(4608,Dt.d,Dt.d,[]),c._11(5120,Ut.b,o,[p.c]),c._11(4608,jt.a,jt.b,[]),c._11(4608,Bt.b,Bt.a,[]),c._11(4608,Ht.b,Ht.a,[]),c._11(4608,Yt.a,Yt.a,[]),c._11(4608,$.a,$.a,[Yt.a,Ut.b,jt.a,Bt.b,Ht.b,$.b,$.c]),c._11(4608,zt.a,zt.a,[at.a,K.a]),c._11(4608,xt.a,xt.a,[at.a,K.a]),c._11(4608,qt.a,qt.a,[]),c._11(4608,W.a,W.a,[]),c._11(4608,Zt.a,Zt.a,[ot.a]),c._11(4608,nt.a,nt.a,[K.a,ot.a,c.u,it.a]),c._11(4608,Wt.a,Wt.a,[at.a,K.a]),c._11(5120,_t.g,Kt.c,[_t.r,[2,_t.a],K.a]),c._11(4608,_t.f,_t.f,[_t.g]),c._11(5120,Gt.b,Gt.d,[at.a,Gt.a]),c._11(5120,Tt.a,Tt.b,[at.a,Gt.b,_t.f,Jt.b,c.i]),c._11(4608,Vt.a,Vt.a,[at.a,K.a,Tt.a]),c._11(4608,Xt.a,Xt.a,[at.a,K.a]),c._11(4608,Qt.a,Qt.a,[at.a,K.a,Tt.a]),c._11(4608,$t.a,$t.a,[K.a,ot.a,it.a,at.a,st.l]),c._11(4608,te.a,te.a,[at.a,K.a]),c._11(4608,Ot.a,Ot.a,[ot.a,K.a]),c._11(5120,ee.a,ee.c,[ee.b]),c._11(4608,Et.a,Et.a,[$.a,Wt.a,te.a]),c._11(5120,St.a,n,[ee.a]),c._11(4608,re.a,re.a,[p.c,Et.a,St.a]),c._11(4608,oe.a,oe.a,[re.a,St.a,ee.a,$.a,Et.a]),c._11(4608,f.a,f.a,[]),c._11(4608,Nt.a,Nt.a,[re.a,ot.a,oe.a,ee.a,$.a,f.a,Et.a]),c._11(4608,N.a,N.a,[]),c._11(4608,Pt.a,Pt.a,[Nt.a,St.a,N.a]),c._11(4608,ne.a,ne.a,[re.a,oe.a,Wt.a,Et.a]),c._11(4608,It.a,It.a,[re.a,ne.a,oe.a,Nt.a,ee.a,$.a,xt.a,Et.a]),c._11(4608,se.a,se.a,[re.a,$.a]),c._11(4608,Lt.a,Lt.a,[re.a,It.a,St.a,oe.a,ee.a,Et.a]),c._11(4608,Ct.a,Ct.a,[re.a,It.a,ne.a,oe.a,St.a,ee.a,Et.a]),c._11(4608,ie.a,ie.a,[It.a,ee.a]),c._11(4608,d.a,d.a,[]),c._11(4608,g.a,g.a,[]),c._11(4608,m.a,m.a,[]),c._11(4608,y.a,y.a,[]),c._11(4608,v.a,v.a,[]),c._11(4608,_.a,_.a,[]),c._11(4608,w.a,w.a,[]),c._11(4608,x.a,x.a,[]),c._11(4608,S.a,S.a,[]),c._11(4608,P.a,P.a,[]),c._11(4608,E.a,E.a,[]),c._11(4608,I.a,I.a,[]),c._11(4608,L.a,L.a,[]),c._11(512,_t.b,_t.b,[]),c._11(512,c.k,ae.a,[]),c._11(256,K.b,{preloadModules:!0},[]),c._11(1024,ue.a,ue.b,[]),c._11(1024,ot.a,ot.b,[l.b,ue.a,c.u]),c._11(1024,K.a,K.c,[K.b,ot.a]),c._11(512,it.a,it.a,[ot.a]),c._11(512,X.a,X.a,[]),c._11(512,at.a,at.a,[K.a,ot.a,[2,X.a]]),c._11(512,st.l,st.l,[at.a]),c._11(256,Gt.a,{links:[{loadChildren:"../pages/account/account.module.ngfactory#AccountPageModuleNgFactory",name:"AccountPage",segment:"account",priority:"low",defaultHistory:[]},{loadChildren:"../pages/author/author.module.ngfactory#AuthorPageModuleNgFactory",name:"AuthorPage",segment:"author",priority:"low",defaultHistory:[]},{loadChildren:"../pages/explore/explore.module.ngfactory#ExplorePageModuleNgFactory",name:"ExplorePage",segment:"explore",priority:"high",defaultHistory:[]},{loadChildren:"../pages/feed/feed.module.ngfactory#FeedPageModuleNgFactory",name:"FeedPage",segment:"feed",priority:"high",defaultHistory:[]},{loadChildren:"../pages/history/history.module.ngfactory#HistoryPageModuleNgFactory",name:"HistoryPage",segment:"history",priority:"high",defaultHistory:[]},{loadChildren:"../pages/following/following.module.ngfactory#FollowingPageModuleNgFactory",name:"FollowingPage",segment:"following",priority:"low",defaultHistory:[]},{loadChildren:"../pages/history/sort-popover.module.ngfactory#SortPopoverModuleNgFactory",name:"SortPopover",segment:"sort-popover",priority:"low",defaultHistory:[]},{loadChildren:"../pages/list-create/list-create.module.ngfactory#ListCreatePageModuleNgFactory",name:"ListCreatePage",segment:"list-create",priority:"low",defaultHistory:[]},{loadChildren:"../pages/list-list/list-list.module.ngfactory#ListListPageModuleNgFactory",name:"ListListPage",segment:"list-list",priority:"high",defaultHistory:[]},{loadChildren:"../pages/list-view/list-view.module.ngfactory#ListViewPageModuleNgFactory",name:"ListViewPage",segment:"list-view",priority:"low",defaultHistory:[]},{loadChildren:"../pages/login/login.module.ngfactory#LoginPageModuleNgFactory",name:"LoginPage",segment:"login",priority:"low",defaultHistory:[]},{loadChildren:"../pages/search/search.module.ngfactory#SearchPageModuleNgFactory",name:"SearchPage",segment:"search",priority:"high",defaultHistory:[]},{loadChildren:"../pages/search/search-popover.module.ngfactory#SearchPopoverModuleNgFactory",name:"SearchPopover",segment:"search-popover",priority:"low",defaultHistory:[]},{loadChildren:"../pages/settings/settings.module.ngfactory#SettingsPageModuleNgFactory",name:"SettingsPage",segment:"settings",priority:"low",defaultHistory:[]},{loadChildren:"../pages/story-detail/story-detail.module.ngfactory#StoryDetailPageModuleNgFactory",name:"StoryDetailPage",segment:"story-detail",priority:"low",defaultHistory:[]},{loadChildren:"../pages/story-related/story-related.module.ngfactory#StoryRelatedPageModuleNgFactory",name:"StoryRelatedPage",segment:"story-related",priority:"low",defaultHistory:[]},{loadChildren:"../pages/story-series/story-series.module.ngfactory#StorySeriesPageModuleNgFactory",name:"StorySeriesPage",segment:"story-series",priority:"low",defaultHistory:[]},{loadChildren:"../pages/story-view/story-popover.module.ngfactory#StoryPopoverModuleNgFactory",name:"StoryPopover",segment:"story-popover",priority:"low",defaultHistory:[]},{loadChildren:"../pages/story-view/story-view.module.ngfactory#StoryViewPageModuleNgFactory",name:"StoryViewPage",segment:"story-view",priority:"low",defaultHistory:[]},{loadChildren:"../pages/tabs/tabs.module.ngfactory#TabsPageModuleNgFactory",name:"TabsPage",segment:"tabs",priority:"high",defaultHistory:[]},{loadChildren:"../pages/top-list/top-list.module.ngfactory#TopListPageModuleNgFactory",name:"TopListPage",segment:"top-list",priority:"low",defaultHistory:[]},{loadChildren:"../parts/export-popover/export-popover.module.ngfactory#ExportPopoverModuleNgFactory",name:"ExportPopover",segment:"export-popover",priority:"low",defaultHistory:[]},{loadChildren:"../parts/bookmark-popover/bookmark-popover.module.ngfactory#BookmarkPopoverModuleNgFactory",name:"BookmarkPopover",segment:"bookmark-popover",priority:"low",defaultHistory:[]}]},[]),c._11(512,c.h,c.h,[]),c._11(512,le.a,le.a,[c.h]),c._11(1024,Jt.b,Jt.c,[le.a,c.o]),c._11(1024,c.c,function(t,e,r,o,n,s,i,a,u,c,p,h,d){return[l.s(t),ce.a(e),qt.b(r,o),$t.b(n,s,i,a,u),Jt.d(c,p,h,d)]},[[2,c.t],K.a,ot.a,it.a,K.a,ot.a,it.a,at.a,st.l,K.a,Gt.a,Jt.b,c.u]),c._11(512,c.d,c.d,[[2,c.c]]),c._11(131584,c.f,c.f,[c.u,c.T,c.o,c.k,c.i,c.d]),c._11(512,c.e,c.e,[c.f]),c._11(512,l.a,l.a,[[3,l.a]]),c._11(512,h.a,h.a,[]),c._11(512,p.e,p.e,[]),c._11(512,p.d,p.d,[]),c._11(512,O.a,O.a,[]),c._11(512,Dt.p,Dt.p,[]),c._11(512,Dt.g,Dt.g,[]),c._11(512,Dt.n,Dt.n,[]),c._11(512,Kt.a,Kt.a,[]),c._11(512,b.a,b.a,[]),c._11(512,A,A,[]),c._11(256,p.l,"XSRF-TOKEN",[]),c._11(256,p.m,"X-XSRF-TOKEN",[]),c._11(256,$.c,void 0,[]),c._11(256,$.b,void 0,[]),c._11(256,R.a,k,[]),c._11(256,_t.a,"/",[]),c._11(256,ee.b,null,[])])}),he=this;window.consoleLog=[],console=new Proxy(console,{get:function(t,e){var r=t[e];return function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];var n=r.apply(he,t);try{window.consoleLog.push(JSON.parse(JSON.stringify({prop:e,args:t}))),window.consoleLog.length>75&&window.consoleLog.shift()}catch(t){}return n}}}),console.info("App started",(new Date).getTime()),Object(c.M)(),Object(l.j)().bootstrapModuleFactory(pe)},44:function(t,e,r){"use strict";r.d(e,"a",function(){return n});r(0),r(38);var o=r(57),n=function(){function t(t,e){this.storage=t,this.settings={},this._defaults=e}return t.prototype.load=function(){var t=this;return this.storage.get(o.f).then(function(e){return e?(t.settings=e,t._mergeDefaults(t._defaults)):t.setAll(t._defaults).then(function(e){t.settings=e})})},t.prototype._mergeDefaults=function(t){for(var e in t)e in this.settings||(this.settings[e]=t[e]);return this.setAll(this.settings)},t.prototype.merge=function(t){for(var e in t)this.settings[e]=t[e];return this.save()},t.prototype.setValue=function(t,e){return this.settings[t]=e,this.storage.set(o.f,this.settings)},t.prototype.setAll=function(t){return this.storage.set(o.f,t)},t.prototype.getValue=function(t){return this.storage.get(o.f).then(function(e){return e[t]})},t.prototype.save=function(){return this.setAll(this.settings)},Object.defineProperty(t.prototype,"allSettings",{get:function(){return this.settings},enumerable:!0,configurable:!0}),t}()},55:function(t,e,r){"use strict";r.d(e,"a",function(){return a});r(0);var o=r(53),n=(r.n(o),r(363)),s=(r.n(n),r(686)),i=(r.n(s),r(38),r(42),r(57)),a=(r(39),r(44),r(34),function(){function t(t,e,r,o,n){var s=this;this.api=t,this.settings=e,this.storage=r,this.translate=o,this.ux=n,this.ready=new Promise(function(t,e){Promise.all([s.settings.load(),s.storage.get(i.j)]).then(function(e){!s.settings.allSettings.offlineMode&&e[1]&&(s.user=e[1],s.user.date+31104e6<(new Date).getTime()&&setTimeout(function(){s.ux.showToast("INFO","SESSIONTIMEOUT_MSG",15e3),s.removeStoredUser()},2e3)),t()})})}return t.prototype.onReady=function(){return this.ready},t.prototype.login=function(t){var e=this,r=this.ux.showLoader(),n=new FormData;return n.append("username",t.username),n.append("password",String(s.Md5.hashStr(t.password))),this.api.post("2/auth/login",n,void 0,!0).map(function(n){if(!n.success)throw r&&r.dismiss(),o.Observable.throw(n);e.processAndGetMoreInfo(n,t),r&&r.dismiss()})},t.prototype.processAndGetMoreInfo=function(t,e){this.user={id:t.login.user.user_id,username:t.login.user.username,session:t.login.session_id,date:(new Date).getTime()},this.storage.set(i.j,this.user);var r=new FormData;r.append("command","Login"),r.append("uname",e.username),r.append("pwd",e.password),this.api.post("members/login.php",r,{withCredentials:!0},void 0,2).subscribe()},t.prototype.isLoggedIn=function(){return this.user&&!this.settings.allSettings.offlineMode},t.prototype.getId=function(){return this.user.id},t.prototype.getName=function(){return this.user.username},t.prototype.getSession=function(){return this.user.session},t.prototype.getDetails=function(){return this.user},t.prototype.checkIfEverythingIsFucked=function(){var t=this;return new Promise(function(e){t.storage.get(i.j).then(function(r){JSON.stringify(t.user)!==JSON.stringify(r)?e(!0):e(!1)})})},t.prototype.removeStoredUser=function(){this.storage.remove(i.j),this.storage.remove(i.a)},t.prototype.logout=function(){this.user=null,this.removeStoredUser(),window.location.reload()},t}())},57:function(t,e,r){"use strict";r.d(e,"g",function(){return o}),r.d(e,"e",function(){return n}),r.d(e,"h",function(){return s}),r.d(e,"c",function(){return i}),r.d(e,"i",function(){return a}),r.d(e,"j",function(){return u}),r.d(e,"a",function(){return l}),r.d(e,"d",function(){return c}),r.d(e,"b",function(){return p}),r.d(e,"k",function(){return h}),r.d(e,"f",function(){return d});var o="_queries",n="_recentqueries",s="_storystyle",i="_history",a="_story",u="_user",l="_feed",c="_list",p="_globals",h="_version",d="_settings"},63:function(t,e,r){"use strict";r.d(e,"a",function(){return u});r(0);var o=r(53),n=(r.n(o),r(38),r(42),r(60),r(400)),s=r(57),i=(r(95),r(55),r(70),r(39),r(34),this&&this.__assign||Object.assign||function(t){for(var e,r=1,o=arguments.length;r<o;r++){e=arguments[r];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t}),a=function(t){var e=document.createElement("textarea");e.innerHTML=t;return e.value},u=function(){function t(t,e,r,o,n,i,a,u){var l=this;this.api=t,this.a=e,this.user=r,this.g=o,this.storage=n,this.translate=i,this.alertCtrl=a,this.ux=u,this.stories=new Map,this.ready=new Promise(function(t,e){l.storage.keys().then(function(e){if(e.length<1)t();else{var r=e.length-1;l.storage.forEach(function(e,o,n){0===o.indexOf(s.i)&&l.stories.set(e.id,e),n===r&&t()})}})})}return t.prototype.onReady=function(){return this.ready},t.prototype.searchStory=function(t,e,r,o){var n=i({q:t},e);return e.astags?this.tagsearch(n,r):this.newsearch(n,r)},t.prototype.getSeries=function(t){var e=[{property:"series_id",value:parseInt(t)}];return this.search(e)},t.prototype.getRelated=function(t){var e=[{property:"related_id",value:parseInt(t)}];return this.search(e)},t.prototype.getAuthorStories=function(t,e){var r=[{property:"user_id",value:parseInt(t)},{property:"type",value:"story"}];return this.search(r,e,null,null,"1/user-submissions")},t.prototype.getAuthorFavs=function(t,e){var r=[{property:"user_id",value:parseInt(t)},{property:"type",value:"story"}];return this.search(r,e,null,null,"1/user-favorites")},t.prototype.getTop=function(t,e){var r=[{property:"type",value:"story"}];return t&&r.push({property:"category_id",value:parseInt(t)}),this.search(r,e,null,null,"1/top")},t.prototype.getNew=function(t,e){var r=[{property:"type",value:"story"},{property:"newonly",value:"yes"}];return t&&r.push({property:"category_id",value:parseInt(t)}),this.search(r,e)},t.prototype.getById=function(t,e,r){var s=this;void 0===e&&(e=!1),void 0===r&&(r=!1);var i=this.stories.get(t);if(i&&!e&&i.length)return o.Observable.of(i);var a=[{property:"submission_id",value:parseInt(t)}],u={filter:JSON.stringify(a).trim()},l=this.ux.showLoader();return this.api.get("2/submissions/pages",u).map(function(o){if(l&&!r&&l.dismiss(),!o.success)return console.error("stories.getById",[t]),s.ux.showToast(),null;i?e&&(i.title=o.pages[0].name,i.url=o.pages[0].url,i.ratingenabled=o.pages[0].allow_vote):i=new n.a({id:o.pages[0].submission_id,title:o.pages[0].name,url:o.pages[0].url,ratingenabled:o.pages[0].allow_vote});var a=o.pages[0].tags?o.pages[0].tags.sort(function(t,e){return e.submission_count-t.submission_count}).map(function(t){return t.name}):[];return i.series=o.pages[0].series_id,i.lang=o.pages[0].lang,i.length=o.total,i.tags=a,i.content=o.pages.map(function(t){return t.content}),s.stories.set(i.id,i),i}).catch(function(e){return l&&l.dismiss(),s.ux.showToast(),console.error("stories.getById",[t],e),o.Observable.of(null)})},t.prototype.rate=function(t,e){var r=this,n=[{property:"submission_id",value:parseInt(t.id)}],s=new FormData;s.append("user_id",this.user.getId()),s.append("session_id",this.user.getSession()),s.append("vote",String(e)),s.append("filter",JSON.stringify(n)),this.api.post("2/submissions/vote",s,void 0,!0).catch(function(r){return console.error("stories.rate",[t,e],r),o.Observable.throw(r)}).subscribe(function(o){o.success?t.myrating=e:(r.ux.showToast(),console.error("stories.rate",[t,e],o.error))})},t.prototype.downloadSeries=function(t){var e=this,r=function(o){void 0===o&&(o=0),o<1&&e.ux.showLoader(),o>=t.length?e.ux.hideLoader():t[o].cached?(e.download(t[o]),e.ux.updateLoader(Math.round(o+1/t.length*100)+"%"),r(o+1)):e.getById(t[o].id,!1,!0).subscribe(function(n){if(!n)return e.ux.showToast("ERROR","SERIES_DOWNLOAD_ERROR"),void e.ux.hideLoader();e.download(n),e.ux.updateLoader(Math.round(o+1/t.length*100)+"%"),r(o+1)})};t.length>10?this.translate.get(["CONFIRM","SERIES_DOWNLOAD_SIZEWARNING","DOWNLOAD_BUTTON","CANCEL_BUTTON"]).subscribe(function(t){e.alertCtrl.create({title:t.CONFIRM,message:t.SERIES_DOWNLOAD_SIZEWARNING,buttons:[{text:t.DOWNLOAD_BUTTON,handler:function(){r()}},{text:t.CANCEL_BUTTON}]}).present()}):r()},t.prototype.search=function(t,e,r,n,s){var i,a=this,u={page:e||1,filter:JSON.stringify(t)};return(!e||e<2)&&(i=this.ux.showLoader()),this.api.get(s||"1/submissions",u,null,n).map(function(o){return i&&i.dismiss(),o.success||o.submissions?[o.submissions?o.submissions.map(function(t){return a.extractFromSearch(t)}):[],o.total]:(o.hasOwnProperty("total")||(a.ux.showToast(),console.error("stories.search",[t,e,r])),[[],0])}).catch(function(n){return i&&i.dismiss(),a.ux.showToast(),console.error("stories.search",[t,e,r],n),o.Observable.of([[],0])})},t.prototype.newsearch=function(t,e,r,n,s){var a=this;void 0===s&&(s=!1),s?Array.isArray(t.category)&&(t.category=parseInt(t.category[0])):(t.category&&(t.categories=t.category.map(function(t){return parseInt(t)})),delete t.category);var u,l={params:JSON.stringify(i({page:e||1},t))};return(!e||e<2)&&(u=this.ux.showLoader()),this.api.get(n||"3/search/stories",l,null,r).map(function(r){u&&u.dismiss();var o=s?r.submissions:r.data,n=s?r.meta.submissions_count:r.meta.total;return o?[o.map(function(t){return a.extractFromNewSearch(t)}),n]:(n||(a.ux.showToast(),console.error("stories.newsearch",[t,e,s])),[[],0])}).catch(function(r){return u&&u.dismiss(),a.ux.showToast(),console.error("stories.newsearch",[t,e,s],r),o.Observable.of([[],0])})},t.prototype.tagsearch=function(t,e,r,o){var n=this,s={params:JSON.stringify({tags:t.q.split(",").map(function(t){return t.trim()})})};return delete t.q,(!e||e<2)&&this.ux.showLoader(),this.api.get(o||"3/tagsportal/by-name",s,null,r).map(function(t){return t.map(function(t){return t.id})}).mergeMap(function(r){var o=i({tags:r,sort_by:t.sort},t);return n.newsearch(o,e,0,"3/tagsportal/stories",!0)})},t.prototype.persist=function(t){var e=Object.assign({},t);delete e.author.stories,this.storage.set(s.i+"_"+t.id,e)},t.prototype.download=function(t){t.downloaded=!0,t.downloadedtimestamp=new Date,t.cached=!0,this.persist(t)},t.prototype.undownload=function(t){t.downloaded=!1,t.downloadedtimestamp=null,this.persist(t)},t.prototype.cache=function(t){t.cached=!0,this.persist(t)},t.prototype.remove=function(t){this.storage.remove(s.i+"_"+t.id)},t.prototype.removeAll=function(t){var e=this;this.stories.forEach(function(r){t&&r.downloaded||e.remove(r)})},t.prototype.extractFromFeed=function(t){var e=this.stories.get(t.what.id);if(e)return e;var r=this.a.extractFromFeed(t.who),o=new n.a({author:r,id:t.what.id.toString(),title:t.what.title,description:t.what.description,category:a(t.what.category_info.name),categoryID:t.what.category,lang:this.g.getLanguage(t.what.language),timestamp:t.when,rating:t.what.rate_all,viewcount:t.what.view_count,url:t.what.url,tags:t.what.tags?t.what.tags.map(function(t){return t.tag}):[],ishot:t.what.is_hot,isnew:t.what.is_new,iswriterspick:t.what.writers_pick,iscontestwinner:t.what.contest_winner,commentsenabled:t.what.enable_comments,ratingenabled:t.what.allow_vote});return this.stories.set(o.id,o),o},t.prototype.extactFromList=function(t){var e=this.stories.get(t.id);if(e)return e;var r=this.a.extractFromFeed(t.author),o=new n.a({author:r,id:t.id.toString(),title:t.title,description:t.description,category:a(t.category_info.name),categoryID:t.category,lang:this.g.getLanguage(t.language),timestamp:Math.round(Date.parse(t.date_added)/1e3),rating:t.rate_all,viewcount:t.view_count,url:t.url,tags:t.tags?t.tags.map(function(t){return t.tag}):[],ishot:t.is_hot,isnew:t.is_new,iswriterspick:t.writers_pick,iscontestwinner:t.contest_winner,commentsenabled:t.enable_comments>0,ratingenabled:t.allow_vote});return this.stories.set(o.id,o),o},t.prototype.extractFromSearch=function(t){var e=this.stories.get(t.id);if(e)return e;var r=this.a.extractFromSearch(t.user),o=new n.a({author:r,id:t.id.toString(),title:t.name,description:t.description,category:t.category.name,categoryID:t.category.id,lang:t.lang,timestamp:t.timestamp_published,rating:t.rate,viewcount:t.view_count,url:t.url,ishot:"no"!==t.is_hot,isnew:"no"!==t.is_new,iswriterspick:"no"!==t.writers_pick,iscontestwinner:"no"!==t.contest_winner,commentsenabled:t.enable_comments>0,ratingenabled:t.allow_vote>0});return this.stories.set(o.id,o),o},t.prototype.extractFromNewSearch=function(t){var e=this.stories.get(t.id);if(e)return e;var r=t.date_approve.split("/"),o=this.a.extractFromNewSearch(t.author),s=new n.a({author:o,id:t.id.toString(),title:t.title,description:t.description,category:a(t.category_info.name),categoryID:t.category,lang:this.g.getLanguage(t.language),timestamp:Math.round(Date.parse(r[2]+"-"+r[0]+"-"+r[1]+"T00:00:00")/1e3),rating:t.rate_all,viewcount:t.view_count,url:t.url,ishot:t.is_hot,isnew:t.is_new,iswriterspick:t.writers_pick,iscontestwinner:t.contest_winner>0,commentsenabled:t.enable_comments>0,ratingenabled:t.allow_vote>0});return this.stories.set(s.id,s),s},t}()},70:function(t,e,r){"use strict";r.d(e,"a",function(){return a});r(0);var o=r(53),n=(r.n(o),r(38),r(42),r(138),r(60),r(39),r(55),r(57)),s=r(375),i=r(204),a=(r(34),function(){function t(t,e,r,o,s,i,a){var u=this;this.api=t,this.platform=e,this.user=r,this.storage=o,this.translate=s,this.browser=i,this.ux=a,this.version=19,this.storage.get(n.k).then(function(t){t&&t!==u.version&&setTimeout(function(){u.ux.showToast("INFO","UPDATED_MSG",15e3),u.user.removeStoredUser()},2e3),u.storage.set(n.k,u.version)}),this.ready=new Promise(function(t,e){u.storage.get(n.b).then(function(e){e?(u.globals=e,t()):u.query().subscribe(function(){t()})})})}return t.prototype.onReady=function(){return this.ready},t.prototype.getLanguage=function(t){var e=this;return this.globals.languages?Object.keys(this.globals.languages).filter(function(r){var o=e.globals.languages[r];if(parseInt(o.id)===t)return o.shortname})[0]:null},t.prototype.getPopularTags=function(){return this.api.get("3/tagsportal/top",{limit:100,periodCheck:!1,period:"all"})},t.prototype.getVersion=function(){return this.version},t.prototype.isWebApp=function(){return!this.platform.is("cordova")&&!s.a.DEV},t.prototype.checkForUpdates=function(t){var e=this;void 0===t&&(t=!1),this.isWebApp()||(t&&this.ux.showToast("INFO","UPDATE_STARTED",2e3),this.api.get("app.json",void 0,void 0,3).catch(function(t){return console.error("globals.checkForUpdates",t),o.Observable.of(!1)}).subscribe(function(r){r?(r.appid!==e.api.appid&&(e.api.appid=r.appid),r.apikey!==e.api.apikey&&(e.api.apikey=r.apikey),r.version>e.version?e.ux.showToast("INFO","UPDATE_MSG",15e3,"DOWNLOAD_BUTTON",!0).then(function(){var t=r.updatelink||"https://theilluminatus.github.io/litapp";e.browser.openUrl(t).catch(function(e){return Object(i.a)(e,function(){return window.open(t)})})}):t&&e.ux.showToast("INFO","UPDATE_ALREADYDONE",void 0,void 0,!0)):e.ux.showToast("ERROR","UPDATE_FAILEDMSG",void 0,void 0,!0)}))},t.prototype.query=function(){var t=this;if(this.globals)return o.Observable.of(this.globals);var e=this.ux.showLoader();return this.api.get("3/constants",null,null,null,1e4).map(function(r){return e&&e.dismiss(),r?(t.globals=r,t.storage.set(n.b,t.globals),t.globals):(t.ux.showToast(),console.error("globals.query"),null)}).catch(function(r){return e&&e.dismiss(),t.ux.showToast(),console.error("globals.query",r),o.Observable.of(null)})},t}())},95:function(t,e,r){"use strict";r(0),r(1),r(60);var o=r(53),n=function(){return function(t){for(var e in t)this[e]=t[e]}}();r(55),r(39),r(34);r.d(e,"a",function(){return s});var s=function(){function t(t,e,r,o){this.api=t,this.user=e,this.loadingCtrl=r,this.ux=o,this.authors=new Map}return t.prototype.getDetails=function(t){var e=this,r=[{property:"user_id",value:t}],s={filter:JSON.stringify(r).trim()},i=this.authors.get(t);if(i&&i.bio)return o.Observable.of(i);var a=this.ux.showLoader();return this.api.get("1/user-bio",s).map(function(t){return a&&a.dismiss(),t.success?(i||(i=new n({id:t.user.profile.id,picture:t.user.profile.userpic,name:t.user.profile.username})),i.storycount=t.user.profile.submissions_count,i.bio=t.user.profile.description,e.authors.set(i.id,i),i):(e.ux.showToast(),console.error("author.getDetails"),null)}).catch(function(r){return a&&a.dismiss(),e.ux.showToast(),console.error("author.getDetails",[t],r),o.Observable.of(null)})},t.prototype.getFollowing=function(){var t=this,e=this.ux.showLoader();return this.api.get("3/users/"+this.user.getId()+"/favorite/authors?params={%22nocache%22:true}").map(function(r){return e&&e.dismiss(),r.length?r.map(function(e){return t.extractFromFeed(e)}):(t.ux.showToast(),console.error("author.getFollowing"),[])}).catch(function(r){return e&&e.dismiss(),t.ux.showToast(),console.error("author.getFollowing",r),o.Observable.of([])})},t.prototype.follow=function(t){var e=this,r=new FormData;return r.append("type","member"),r.append("id",t.id),this.api.post("3/users/follow/"+t.id,{}).map(function(t){return t.success}).catch(function(r){return e.ux.showToast(),console.error("author.follow",[t],r),o.Observable.of(!1)}).subscribe(function(r){r?t.following=!0:(e.ux.showToast(),console.error("author.follow",[t]))})},t.prototype.unfollow=function(t){var e=this;return this.api.delete("3/users/follow/"+t.id).map(function(t){return t.success}).catch(function(r){return e.ux.showToast(),console.error("author.unfollow",[t],r),o.Observable.of(!1)}).subscribe(function(r){r?t.following=!1:(e.ux.showToast(),console.error("author.unfollow",[t]))})},t.prototype.extractFromFeed=function(t){var e=this.authors.get(t.id);return e&&e.updatetimestamp?e:(e||(e=new n({id:t.userid,name:t.username,picture:t.userpic})),e.jointimestamp=t.joindate,e.following=!0,this.authors.set(e.id,e),e)},t.prototype.extractFromSearch=function(t){var e=this.authors.get(t.id);if(e)return e;var r=new n({id:t.id,name:t.username,picture:t.userpic});return this.authors.set(r.id,r),r},t.prototype.extractFromNewSearch=function(t){var e=this.authors.get(t.userid);if(e)return e;var r=new n({id:t.userid,name:t.username,picture:t.userpic});return this.authors.set(r.id,r),r},t}()}},[409]);