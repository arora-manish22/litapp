webpackJsonp([22],{134:function(t,e,n){"use strict";n.d(e,"a",function(){return i});n(0);var o=n(61),r=(n.n(o),n(41),n(400)),a=(n(54),n(66),n(52),n(37),n(69)),i=function(){function t(t,e,n,o,r){var i=this;this.api=t,this.s=e,this.settings=n,this.user=o,this.storage=r,this.ready=new Promise(function(t,e){Promise.all([i.settings.load(),i.user.onReady(),i.s.onReady(),i.storage.get(a.d)]).then(function(e){if(!i.settings.allSettings.cachelists||i.settings.allSettings.offlineMode||!i.user.isLoggedIn())return t(),void(e[3]&&i.storage.remove(a.d));e[3]&&(i.lists=e[3]),i.query(!0).subscribe(function(e){var n=0;e.forEach(function(o,r){i.getById(o.urlname,!0).subscribe(function(o){(n+=1)===e.length&&t()})})})})})}return t.prototype.onReady=function(){return this.ready},t.prototype.query=function(t){var e=this;if(this.lists)return o.Observable.of(this.lists);var n;return t||(n=this.api.showLoader()),this.api.get("3/users/"+this.user.getId()+"/lists").map(function(t){return n&&n.dismiss(),t.error?(e.api.showToast(),[]):(e.lists=t.map(function(t){return new r.a({id:t.id,urlname:t.urlname,name:t.title,description:t.description,visibility:!t.is_private,size:t.stories_count,isdeletable:t.is_deletable,createtimestamp:t.created_at,updatetimestamp:t.updated_at})}),e.storage.set(a.d,e.lists),e.lists)}).catch(function(t){return n&&n.dismiss(),e.api.showToast(),console.error("lists.query",t),o.Observable.of([])})},t.prototype.getById=function(t,e){var n=this,r=this.lists.find(function(e){return e.urlname===t});if(r.stories)return o.Observable.of(r);var i;return e||(i=this.api.showLoader()),o.Observable.create(function(e){var o=function(s,l){n.getListPage(t,i,Object.assign({},l),s).subscribe(function(t){if(t){var u=l;if(l.stories?u.stories=u.stories.concat(t.stories):u=t,t.size>u.stories.length){var c=s+1;n.api.updateLoader(Math.round(u.stories.length/t.size*100)+"%"),o(c,u)}else n.lists[n.lists.indexOf(r)]=u,n.storage.set(a.d,n.lists),i&&i.dismiss(),e.next(u),e.complete()}})};o(1,r)})},t.prototype.getListPage=function(t,e,n,a){var i=this;void 0===a&&(a=1);var s={page:a,sort:"dateadd"};return this.api.get("3/users/"+this.user.getId()+"/lists/"+t,{params:JSON.stringify(s)}).map(function(t){if(!t.works.data)return i.api.showToast(),null;var e=n;return n||(e=new r.a({id:t.list.id,urlname:t.list.urlname,name:t.list.title,description:t.list.description,visibility:!t.list.is_private,size:t.list.stories_count,isdeletable:t.list.is_deletable,createtimestamp:t.list.created_at,updatetimestamp:t.list.updated_at})),e.stories=t.works.data.map(function(t){return i.s.extactFromList(t)}),e}).catch(function(r){return e&&e.dismiss(),i.api.showToast(),console.error("lists.getListPage",[t,n,a],r),o.Observable.of(null)})},t.prototype.addStory=function(t,e){var n=this;return this.api.put("3/stories/"+e.id+"/lists/"+t.id,{}).map(function(t){return t.success||n.api.showToast(),t.success}).catch(function(r){return n.api.showToast(),console.error("lists.addStory",[t,e],r),o.Observable.of(!1)}).subscribe(function(o){o&&(t.stories||(t.stories=[]),t.stories.push(e),t.size+=1,n.storage.set(a.d,n.lists))})},t.prototype.removeStory=function(t,e){var n=this;return this.api.delete("3/stories/"+e.id+"/lists/"+t.id).map(function(t){return t.success||n.api.showToast(),t.success}).catch(function(r){return n.api.showToast(),console.error("lists.removeStory",[t,e],r),o.Observable.of(!1)}).subscribe(function(o){if(o){if(!t.stories)return;t.stories.forEach(function(n,o){n.id===e.id&&t.stories.splice(o,1)}),t.size=-1,n.storage.set(a.d,n.lists)}})},t.prototype.add=function(t){var e=this,n={title:t.name,description:t.description,isPrivate:t.visibility?0:1};return this.api.post("3/users/"+this.user.getId()+"/lists",n,void 0,!1).map(function(t){return t.success?(e.lists.push(new r.a({id:t.list.id,urlname:t.list.urlname,name:t.list.title,description:t.list.description,visibility:!t.list.is_private,size:t.list.stories_count,isdeletable:t.list.is_deletable,createtimestamp:t.list.created_at})),e.storage.set(a.d,e.lists),!0):(e.api.showToast(),!1)}).catch(function(n){return e.api.showToast(),console.error("lists.add",[t],n),o.Observable.of(!1)})},t.prototype.edit=function(t){var e=this;return this.api.patch("3/lists/"+t.id,{title:t.name,description:t.description,isPrivate:t.visibility?0:1}).map(function(n){return n.success?(e.lists.forEach(function(e){e.id===t.id&&(e.name=n.list.title,e.description=n.list.description,e.visibility=!n.list.is_private)}),e.storage.set(a.d,e.lists),!0):(e.api.showToast(n.error),!1)}).catch(function(n){return e.api.showToast(),console.error("lists.edit",[t],n),o.Observable.of(!1)})},t.prototype.delete=function(t){var e=this;return this.api.delete("3/lists/"+t.id).map(function(n){return n.success?(e.lists.forEach(function(n,o){n.urlname===t.urlname&&e.lists.splice(o,1)}),e.storage.set(a.d,e.lists),!0):(e.api.showToast(n.error),!1)}).catch(function(n){return e.api.showToast(),console.error("lists.delete",[t],n),o.Observable.of(!1)})},t.prototype.refresh=function(){return this.storage.remove(a.d),this.lists=null,this.query()},t}()},141:function(t,e,n){"use strict";n.d(e,"a",function(){return r});n(0),n(172),n(68);var o=n(396),r=(n(54),function(){function t(t,e,n){var r=this;this.g=t,this.settings=e,this.googleAnalytics=n,Promise.all([this.settings.load(),this.g.onReady()]).then(function(){if(!r.settings.allSettings.offlineMode)try{Promise.all([r.googleAnalytics.startTrackerWithId("UA-142185587-2",120),r.googleAnalytics.setAnonymizeIp(!0),r.googleAnalytics.setAllowIDFACollection(!1),r.googleAnalytics.setAppVersion(r.g.getVersion().toString())]).then(function(){r.track("Startup")}).catch(function(t){return Object(o.a)(t)})}catch(t){Object(o.a)(t)}})}return t.prototype.track=function(t){console.info("Track",t),this.settings.allSettings.offlineMode||this.googleAnalytics.trackView(t)},t}())},142:function(t,e,n){"use strict";n(0),n(1);var o=n(61),r=(n(41),function(){return function(t){for(var e in t)this[e]=t[e]}}()),a=(n(66),n(94),n(52),n(54),n(69));n(37);n.d(e,"a",function(){return i});var i=function(){function t(t,e,n,o,r,i){var s=this;this.api=t,this.s=e,this.a=n,this.user=o,this.settings=r,this.storage=i,this.timeout=6e5,this.feedtimeout=(new Date).getTime()+this.timeout,this.feedbadge="",this.ready=new Promise(function(t,e){Promise.all([s.settings.load(),s.user.onReady()]).then(function(){s.settings.allSettings.checkforfeedupdates&&!s.settings.allSettings.offlineMode&&s.user.isLoggedIn()?(s.feedbadge="Â·",s.query().subscribe(function(e){e?s.storage.get(a.a).then(function(n){for(var o=0;o<e.length;o+=1)if(n===e[o].id){s.feedbadge=String(o);break}""===s.feedbadge&&(s.feedbadge="15+"),t()}):t()})):t()})})}return t.prototype.onReady=function(){return this.ready},t.prototype.query=function(t,e,n){var a=this;if(void 0===n&&(n=!1),!n&&!t&&this.feed&&(new Date).getTime()<this.feedtimeout)return o.Observable.of(this.feed);t&&this.feed||(this.feed=[]);var i;e&&(i=this.api.showLoader());var s={chunked:1,limit:10};return t&&(s.last_id=t),this.api.get("3/activity/wall?params="+JSON.stringify(s)).map(function(t){if(i&&i.dismiss(),!t.data)return a.api.showToast(),[];var e=t.data.map(function(t){var e="published-story"===t.action;try{return new r({id:t.id,timestamp:t.when,author:a.a.extractFromFeed(t.who),text:e?[]:Array.isArray(t.what)?t.what:["their profile"],story:e?a.s.extractFromFeed(t):void 0})}catch(t){return new r(null)}});return e.forEach(function(t){return a.feed.push(t)}),a.feedtimeout=(new Date).getTime()+a.timeout,e}).catch(function(e){return i&&i.dismiss(),a.api.showToast(),console.error("feed.query",[t],e),o.Observable.of([])})},t}()},191:function(t,e,n){"use strict";n(141),n(37),n(66),n(94),n(134),n(142),n(68);var o=n(54);n(52);n.d(e,"a",function(){return o.a})},243:function(t,e){function n(t){return Promise.resolve().then(function(){throw new Error("Cannot find module '"+t+"'.")})}n.keys=function(){return[]},n.resolve=n,t.exports=n,n.id=243},285:function(t,e,n){function o(t){var e=r[t];return e?n.e(e[1]).then(function(){return n(e[0])}):Promise.reject(new Error("Cannot find module '"+t+"'."))}var r={"../pages/account/account.module.ngfactory":[682,20],"../pages/author/author.module.ngfactory":[683,7],"../pages/explore/explore.module.ngfactory":[684,17],"../pages/feed/feed.module.ngfactory":[685,6],"../pages/following/following.module.ngfactory":[686,10],"../pages/history/history.module.ngfactory":[687,5],"../pages/list-create/list-create.module.ngfactory":[688,13],"../pages/list-list/list-list.module.ngfactory":[689,12],"../pages/list-view/list-view.module.ngfactory":[690,0],"../pages/login/login.module.ngfactory":[691,19],"../pages/search/search-popover.module.ngfactory":[692,15],"../pages/search/search.module.ngfactory":[693,1],"../pages/settings/settings.module.ngfactory":[694,18],"../pages/story-detail/story-detail.module.ngfactory":[695,9],"../pages/story-related/story-related.module.ngfactory":[696,4],"../pages/story-series/story-series.module.ngfactory":[697,3],"../pages/story-view/story-popover.module.ngfactory":[698,14],"../pages/story-view/story-view.module.ngfactory":[699,8],"../pages/tabs/tabs.module.ngfactory":[700,21],"../pages/top-list/top-list.module.ngfactory":[701,2],"../parts/bookmark-popover/bookmark-popover.module.ngfactory":[702,11],"../parts/export-popover/export-popover.module.ngfactory":[703,16]};o.keys=function(){return Object.keys(r)},o.id=285,t.exports=o},37:function(t,e,n){"use strict";n(0);var o=n(153),r=(n(1),n(57),n(50),{CORS_PROXY:"https://litapp-cors.herokuapp.com/"});n.d(e,"a",function(){return i});var a=function(t,e,n,o){throw console.info({url:e,method:o,data:n,type:"API_Error",name:t.name,message:t.message,stack:t.stack}),t},i=function(){function t(t,e,n,o){this.http=t,this.translate=e,this.loadingCtrl=n,this.toastCtrl=o,this.apikey="70b3a71911b398a98d3dac695f34cf279c270ea0",this.appid="24b7c3f9d904ebd679299b1ce5506bc305a5ab40",this.corsProxy=r.CORS_PROXY||"",this.urls=this.getUrls();try{var a=location.search.substring(1),i=JSON.parse('{"'+decodeURI(a).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')+'"}');i.proxy&&(this.corsProxy=i.proxy,this.urls=this.getUrls())}catch(t){}}return t.prototype.getUrls=function(){return[this.corsProxy+"https://literotica.com/api",this.corsProxy+"https://search.literotica.com/api",this.corsProxy+"https://www.literotica.com",this.corsProxy+"https://raw.githubusercontent.com/theilluminatus/litapp/master",this.corsProxy+"https://literotica.com"]},t.prototype.get=function(t,e,n,r,i){var l=n;if(n||(l={params:new o.g({encoder:new s})}),e){l.params=new o.g({encoder:new s});for(var u in e)l.params=l.params.set(u,e[u])}l.withCredentials=!0,l.params=l.params.set("apikey",this.apikey),l.params=l.params.set("appid",this.appid);var c=this.urls[r||0]+"/"+t,p=this.http.get(c,l).catch(function(t){return a(t,c,l.params,"GET")});return i?p.timeout(i):p},t.prototype.post=function(t,e,n,o,r){var i=t;o&&(t.indexOf("?")>-1?i+="&apikey="+this.apikey+"&appid="+this.appid:i+="?apikey="+this.apikey+"&appid="+this.appid);var s=this.urls[r||0]+"/"+i;return this.http.post(s,e,n).catch(function(t){return a(t,s,e,"POST")})},t.prototype.put=function(t,e,n){var o=this.urls[0]+"/"+t;return this.http.put(o,e,n).catch(function(t){return a(t,o,e,"PUT")})},t.prototype.delete=function(t,e,n){var o=this.urls[n||0]+"/"+t;return this.http.delete(o,e).catch(function(t){return a(t,o,{},"DELETE")})},t.prototype.patch=function(t,e,n){var o=this.urls[0]+"/"+t;return this.http.patch(o,e,n).catch(function(t){return a(t,o,e,"PATCH")})},t.prototype.showLoader=function(){var t=this;return this.loader?this.loader:(this.loader=this.loadingCtrl.create({spinner:"crescent"}),this.loader.present(),this.loader.onDidDismiss(function(){t.loader=void 0}),this.loader)},t.prototype.updateLoader=function(t){this.loader&&this.loader.setContent(t)},t.prototype.hideLoader=function(){this.loader&&this.loader.dismiss().catch(function(){})},t.prototype.showToast=function(t,e,n){var o=this;return new Promise(function(r){o.translate.get(["LOAD_ERROR","CLOSE_BUTTON"]).subscribe(function(a){o.translations=a;var i=o.toastCtrl.create({message:t||o.translations.LOAD_ERROR,showCloseButton:!0,closeButtonText:n||o.translations.CLOSE_BUTTON,duration:e||3e3});i.present(),i.onDidDismiss(function(t){r(i)})})})},t}(),s=function(){function t(){}return t.prototype.encodeKey=function(t){return encodeURIComponent(t)},t.prototype.encodeValue=function(t){return encodeURIComponent(t)},t.prototype.decodeKey=function(t){return decodeURIComponent(t)},t.prototype.decodeValue=function(t){return decodeURIComponent(t)},t}()},394:function(t,e,n){"use strict";n.d(e,"a",function(){return o});var o=function(){return function(t){for(var e in t)this[e]=t[e]}}()},396:function(t,e,n){"use strict";n.d(e,"a",function(){return o});var o=function(t,e){if("cordova_not_available"!==t)throw t;e&&e(t)}},400:function(t,e,n){"use strict";n.d(e,"a",function(){return o});var o=function(){return function(t){for(var e in t)this[e]=t[e]}}()},404:function(t,e,n){"use strict";function o(t){return new S.a(t,"./assets/i18n/",".json")}function r(t){return new E.a(t,{checkforfeedupdates:!0,checkforappupdates:!0,cachelists:!0,amoledBlackTheme:!1,offlineMode:!1,enableLock:!1})}function a(t){return c._22(0,[(t()(),c.Z(0,0,null,null,8,"button",[["class","item item-block"],["ion-item",""],["menuClose",""]],null,[[null,"click"]],function(t,e,n){var o=!0,r=t.component;if("click"===e){o=!1!==c._13(t,6).close()&&o}if("click"===e){o=!1!==r.openLinkDialog()&&o}return o},G.b,G.a)),c.Y(1,1097728,null,3,K.a,[q.a,Z.a,c.j,c.z,[2,J.a]],null,null),c._18(335544320,7,{contentLabel:0}),c._18(603979776,8,{_buttons:1}),c._18(603979776,9,{_icons:1}),c.Y(5,16384,null,0,V.a,[],null,null),c.Y(6,16384,null,0,W.a,[X.a],{menuClose:[0,"menuClose"]},null),(t()(),c._20(7,2,["\n              ","\n            "])),c._14(131072,Q.a,[$.a,c.g])],function(t,e){t(e,6,0,"")},function(t,e){t(e,7,0,c._21(e,7,0,c._13(e,8).transform("MENU_OPENLINK")))})}function i(t){return c._22(0,[(t()(),c.Z(0,0,null,null,8,"button",[["class","item item-block"],["ion-item",""],["menuClose",""]],null,[[null,"click"]],function(t,e,n){var o=!0,r=t.component;if("click"===e){o=!1!==c._13(t,6).close()&&o}if("click"===e){o=!1!==r.openPage("AccountPage")&&o}return o},G.b,G.a)),c.Y(1,1097728,null,3,K.a,[q.a,Z.a,c.j,c.z,[2,J.a]],null,null),c._18(335544320,10,{contentLabel:0}),c._18(603979776,11,{_buttons:1}),c._18(603979776,12,{_icons:1}),c.Y(5,16384,null,0,V.a,[],null,null),c.Y(6,16384,null,0,W.a,[X.a],{menuClose:[0,"menuClose"]},null),(t()(),c._20(7,2,["\n              ","\n            "])),c._14(131072,Q.a,[$.a,c.g])],function(t,e){t(e,6,0,"")},function(t,e){t(e,7,0,c._21(e,7,0,c._13(e,8).transform("MENU_ACCOUNT")))})}function s(t){return c._22(0,[(t()(),c.Z(0,0,null,null,60,null,null,null,null,null,null,null)),(t()(),c._20(-1,null,["\n      "])),(t()(),c.Z(2,0,null,null,53,"ion-menu",[["role","navigation"]],null,null,null,tt.b,tt.a)),c._17(6144,null,et.a,null,[nt.a]),c.Y(4,245760,null,2,nt.a,[X.a,c.j,Z.a,ot.a,c.z,rt.a,at.l,it.a,st.a],{content:[0,"content"]},null),c._18(335544320,2,{menuContent:0}),c._18(335544320,3,{menuNav:0}),(t()(),c._20(-1,0,["\n        "])),(t()(),c.Z(8,0,null,0,12,"ion-header",[],null,null,null,null,null)),c.Y(9,16384,null,0,lt.a,[Z.a,c.j,c.z,[2,ut.a]],null,null),(t()(),c._20(-1,null,["\n          "])),(t()(),c.Z(11,0,null,null,8,"ion-toolbar",[["class","toolbar"]],[[2,"statusbar-padding",null]],null,null,ct.b,ct.a)),c.Y(12,49152,null,0,pt.a,[Z.a,c.j,c.z],null,null),(t()(),c._20(-1,3,["\n            "])),(t()(),c.Z(14,0,null,3,4,"ion-title",[],null,null,null,dt.b,dt.a)),c.Y(15,49152,null,0,ht.a,[Z.a,c.j,c.z,[2,pt.a],[2,gt.a]],null,null),(t()(),c._20(-1,0,["Literotica "])),(t()(),c.Z(17,0,null,0,1,"small",[],null,null,null,null,null)),(t()(),c._20(-1,null,["(unofficial)"])),(t()(),c._20(-1,3,["\n          "])),(t()(),c._20(-1,null,["\n        "])),(t()(),c._20(-1,0,["\n\n        "])),(t()(),c.Z(22,0,null,0,32,"ion-content",[],[[2,"statusbar-padding",null],[2,"has-refresher",null]],null,null,ft.b,ft.a)),c.Y(23,4374528,[[2,4]],0,mt.a,[Z.a,ot.a,it.a,c.j,c.z,st.a,rt.a,c.u,[2,ut.a],[2,yt.a]],null,null),(t()(),c._20(-1,1,["\n          "])),(t()(),c.Z(25,0,null,1,28,"ion-list",[],null,null,null,null,null)),c.Y(26,16384,null,0,_t.a,[Z.a,c.j,c.z,ot.a,at.l,it.a],null,null),(t()(),c._20(-1,null,["\n            "])),(t()(),c.Z(28,0,null,null,8,"button",[["class","item item-block"],["ion-item",""],["menuClose",""]],null,[[null,"click"]],function(t,e,n){var o=!0,r=t.component;if("click"===e){o=!1!==c._13(t,34).close()&&o}if("click"===e){o=!1!==r.openPage("TabsPage")&&o}return o},G.b,G.a)),c.Y(29,1097728,null,3,K.a,[q.a,Z.a,c.j,c.z,[2,J.a]],null,null),c._18(335544320,4,{contentLabel:0}),c._18(603979776,5,{_buttons:1}),c._18(603979776,6,{_icons:1}),c.Y(33,16384,null,0,V.a,[],null,null),c.Y(34,16384,null,0,W.a,[X.a],{menuClose:[0,"menuClose"]},null),(t()(),c._20(35,2,["\n              ","\n            "])),c._14(131072,Q.a,[$.a,c.g]),(t()(),c._20(-1,null,["\n\n            "])),(t()(),c.U(16777216,null,null,1,null,a)),c.Y(39,16384,null,0,vt.j,[c.I,c.F],{ngIf:[0,"ngIf"]},null),(t()(),c._20(-1,null,["\n\n            "])),(t()(),c.U(16777216,null,null,1,null,i)),c.Y(42,16384,null,0,vt.j,[c.I,c.F],{ngIf:[0,"ngIf"]},null),(t()(),c._20(-1,null,["\n\n            "])),(t()(),c.Z(44,0,null,null,8,"button",[["class","item item-block"],["ion-item",""],["menuClose",""]],null,[[null,"click"]],function(t,e,n){var o=!0,r=t.component;if("click"===e){o=!1!==c._13(t,50).close()&&o}if("click"===e){o=!1!==r.openPage("SettingsPage")&&o}return o},G.b,G.a)),c.Y(45,1097728,null,3,K.a,[q.a,Z.a,c.j,c.z,[2,J.a]],null,null),c._18(335544320,13,{contentLabel:0}),c._18(603979776,14,{_buttons:1}),c._18(603979776,15,{_icons:1}),c.Y(49,16384,null,0,V.a,[],null,null),c.Y(50,16384,null,0,W.a,[X.a],{menuClose:[0,"menuClose"]},null),(t()(),c._20(51,2,["\n              ","\n            "])),c._14(131072,Q.a,[$.a,c.g]),(t()(),c._20(-1,null,["\n          "])),(t()(),c._20(-1,1,["\n        "])),(t()(),c._20(-1,0,["\n      "])),(t()(),c._20(-1,null,["\n      "])),(t()(),c.Z(57,0,null,null,2,"ion-nav",[["root","TabsPage"]],null,null,null,bt.b,bt.a)),c._17(6144,null,et.a,null,[wt.a]),c.Y(59,4374528,[[1,4],["content",4]],0,wt.a,[[2,ut.a],[2,yt.a],st.a,Z.a,ot.a,c.j,c.u,c.z,c.i,at.l,Tt.a,[2,St.a],it.a,c.k],{root:[0,"root"]},null),(t()(),c._20(-1,null,["\n    "]))],function(t,e){var n=e.component;t(e,4,0,c._13(e,59));t(e,34,0,"");t(e,39,0,!n.settings.allSettings.offlineMode);t(e,42,0,!n.settings.allSettings.offlineMode);t(e,50,0,"");t(e,59,0,"TabsPage")},function(t,e){t(e,11,0,c._13(e,12)._sbPadding);t(e,22,0,c._13(e,23).statusbarPadding,c._13(e,23)._hasRefresher);t(e,35,0,c._21(e,35,0,c._13(e,36).transform("MENU_HOME")));t(e,51,0,c._21(e,51,0,c._13(e,52).transform("MENU_SETTINGS")))})}function l(t){return c._22(0,[c._18(671088640,1,{nav:0}),(t()(),c._20(-1,null,["\n    "])),(t()(),c.U(16777216,null,null,1,null,s)),c.Y(3,16384,null,0,vt.j,[c.I,c.F],{ngIf:[0,"ngIf"]},null),(t()(),c._20(-1,null,["\n  "]))],function(t,e){t(e,3,0,e.component.loggedIn)},null)}Object.defineProperty(e,"__esModule",{value:!0});var u=n(44),c=n(1),p=(n(0),n(153)),d=n(246),h=n(214),g=n(138),f=n(205),m=n(215),y=n(216),_=n(250),v=n(251),b=n(252),w=n(41),T=n(50),S=n(417),O=(n(57),n(199)),P=n(223),N=n(224),k=n(124),L=n(172),C=n(225),I=n(125),E=n(191),F=function(){function t(t,e,n,o,r,a,i,s,l,u,c,p,d,h,g){var f=this;this.platform=t,this.app=e,this.translate=n,this.webIntent=o,this.config=r,this.alertCtrl=a,this.toastCtrl=i,this.settings=s,this.analytics=l,this.api=u,this.g=c,this.s=p,this.l=d,this.f=h,this.faio=g,this.loggedIn=!1,this.initTranslate(),this.settings.load().then(function(){if(f.platform.is("cordova")&&f.settings.allSettings.enableLock&&!f.loggedIn?f.showLockScreen():f.loggedIn=!0,f.settings.allSettings.checkforappupdates&&!f.settings.allSettings.offlineMode&&f.g.checkForUpdates(),f.settings.allSettings.amoledBlackTheme){var t=document.createElement("link");t.setAttribute("href","./assets/black-theme.css"),t.setAttribute("rel","stylesheet"),document.head.appendChild(t)}}),this.catchShareIntent(),this.platform.resume.subscribe(function(){f.catchShareIntent()})}return t.prototype.showLockScreen=function(){var t=this;this.faio.isAvailable().then(function(e){e?t.faio.show({clientId:"litapp",clientSecret:"3}D+v862s4a6c>y5elLFj4xA",disableBackup:!1}).then(function(e){e&&(t.loggedIn=e)}).catch(function(){return t.platform.exitApp()}):t.loggedIn=!0}).catch(function(){return t.loggedIn=!0})},t.prototype.catchShareIntent=function(){var t=this;this.platform.is("cordova")&&this.webIntent.getIntent().then(function(e){"android.intent.action.SEND"===e.action&&e.extras&&t.openURL(e.extras["android.intent.extra.TEXT"])})},t.prototype.initTranslate=function(){var t=this;this.translate.setDefaultLang("en");var e=this.translate.getBrowserLang();if(e)if("zh"===e){var n=this.translate.getBrowserCultureLang();n.match(/-CN|CHS|Hans/i)?this.translate.use("zh-cmn-Hans"):n.match(/-TW|CHT|Hant/i)&&this.translate.use("zh-cmn-Hant")}else this.translate.use(this.translate.getBrowserLang());else this.translate.use("en");this.translate.get(["BACK_BUTTON_TEXT"]).subscribe(function(e){t.config.set("ios","backButtonText",e.BACK_BUTTON_TEXT)})},t.prototype.openPage=function(t){"TabsPage"===t.title?this.nav.setRoot(t):this.nav.push(t)},t.prototype.openLinkDialog=function(t){var e=this;this.translate.get(["MENU_OPENLINK","OPENLINK_DESCRIPTION","OK_BUTTON","CANCEL_BUTTON"]).subscribe(function(t){e.alertCtrl.create({title:t.MENU_OPENLINK,message:t.OPENLINK_DESCRIPTION,inputs:[{name:"url",placeholder:"https://www.literotica.com/..."}],buttons:[{text:t.OK_BUTTON,handler:function(t){e.openURL(t.url)}},{text:t.CANCEL_BUTTON}]}).present()})},t.prototype.openURL=function(t){var e=this,n=/literotica\.com\/s\/([-a-zA-Z0-9._+]*)/g.exec(t);if(n)return this.nav.push("SearchPage",{storyurl:n[1]}),void this.translate.get(["OPENLINK_STORYWARNING"]).subscribe(function(t){e.toastCtrl.create({message:t.OPENLINK_STORYWARNING,duration:2e3,position:"bottom"}).present()});var o=/literotica\.com\/stories\/memberpage\.php\?.*uid=([0-9]*)/g.exec(t);if(o){this.nav.push("AuthorPage",{author:{id:o[1]}})}else this.translate.get(["OPENLINK_UNSUPPORTED"]).subscribe(function(t){e.toastCtrl.create({message:t.OPENLINK_UNSUPPORTED,duration:2e3,position:"bottom"}).present()})},t}(),M=function(){return function(){}}(),x=n(78),A=n(382),D=n(383),U=n(384),R=n(385),B=n(386),j=n(387),H=n(388),Y=n(389),z=n(390),G=n(190),K=n(26),q=n(22),Z=n(3),J=n(58),V=n(85),W=n(170),X=n(33),Q=n(126),$=n(39),tt=n(403),et=n(43),nt=n(96),ot=n(6),rt=n(36),at=n(10),it=n(12),st=n(13),lt=n(129),ut=n(7),ct=n(401),pt=n(53),dt=n(391),ht=n(90),gt=n(51),ft=n(392),mt=n(31),yt=n(30),_t=n(64),vt=n(18),bt=n(402),wt=n(70),Tt=n(42),St=n(23),Ot=n(93),Pt=n(95),Nt=n(54),kt=n(141),Lt=n(37),Ct=n(68),It=n(66),Et=n(134),Ft=n(142),Mt=c.X({encapsulation:2,styles:[],data:{}}),xt=c.V("ng-component",F,function(t){return c._22(0,[(t()(),c.Z(0,0,null,null,1,"ng-component",[],null,null,null,l,Mt)),c.Y(1,49152,null,0,F,[ot.a,st.a,$.a,k.a,Z.a,Ot.a,Pt.a,Nt.a,kt.a,Lt.a,Ct.a,It.a,Et.a,Ft.a,I.a],null,null)],null,null)},{},{},[]),At=n(180),Dt=n(247),Ut=n(133),Rt=n(28),Bt=n(86),jt=n(87),Ht=n(89),Yt=n(88),zt=n(127),Gt=n(166),Kt=n(179),qt=n(40),Zt=n(132),Jt=n(192),Vt=n(80),Wt=n(59),Xt=n(184),Qt=n(108),$t=n(128),te=n(182),ee=n(204),ne=n(52),oe=n(94),re=n(381),ae=n(181),ie=n(171),se=n(183),le=c.W(M,[x.b],function(t){return c._10([c._11(512,c.i,c.S,[[8,[A.a,D.a,U.a,R.a,B.a,j.a,H.a,Y.a,z.a,xt]],[3,c.i],c.s]),c._11(5120,c.r,c._9,[[3,c.r]]),c._11(4608,vt.l,vt.k,[c.r,[2,vt.t]]),c._11(5120,c.b,c._0,[]),c._11(5120,c.p,c._6,[]),c._11(5120,c.q,c._7,[]),c._11(4608,u.c,u.q,[vt.c]),c._11(6144,c.D,null,[u.c]),c._11(4608,u.f,At.a,[]),c._11(5120,u.d,function(t,e,n,o,r){return[new u.k(t,e),new u.o(n),new u.n(o,r)]},[vt.c,c.u,vt.c,vt.c,u.f]),c._11(4608,u.e,u.e,[u.d,c.u]),c._11(135680,u.m,u.m,[vt.c]),c._11(4608,u.l,u.l,[u.e,u.m]),c._11(5120,Dt.a,d.d,[]),c._11(5120,Dt.c,d.e,[]),c._11(4608,Dt.b,d.c,[Dt.a,Dt.c]),c._11(5120,c.B,d.f,[u.l,Dt.b,c.u]),c._11(6144,u.p,null,[u.m]),c._11(4608,c.G,c.G,[c.u]),c._11(4608,u.h,u.h,[vt.c]),c._11(4608,u.i,u.i,[vt.c]),c._11(4608,Ut.b,d.b,[c.B,u.b]),c._11(4608,p.i,p.n,[vt.c,c.w,p.l]),c._11(4608,p.o,p.o,[p.i,p.m]),c._11(5120,p.a,function(t){return[t]},[p.o]),c._11(4608,p.k,p.k,[]),c._11(6144,p.j,null,[p.k]),c._11(4608,p.h,p.h,[p.j]),c._11(6144,p.b,null,[p.h]),c._11(5120,p.f,p.p,[p.b,[2,p.a]]),c._11(4608,p.c,p.c,[p.f]),c._11(4608,Rt.r,Rt.r,[]),c._11(4608,Rt.d,Rt.d,[]),c._11(5120,Bt.b,o,[p.c]),c._11(4608,jt.a,jt.b,[]),c._11(4608,Ht.b,Ht.a,[]),c._11(4608,Yt.b,Yt.a,[]),c._11(4608,zt.a,zt.a,[]),c._11(4608,$.a,$.a,[zt.a,Bt.b,jt.a,Ht.b,Yt.b,$.b,$.c]),c._11(4608,Gt.a,Gt.a,[st.a,Z.a]),c._11(4608,Ot.a,Ot.a,[st.a,Z.a]),c._11(4608,Kt.a,Kt.a,[]),c._11(4608,q.a,q.a,[]),c._11(4608,qt.a,qt.a,[ot.a]),c._11(4608,rt.a,rt.a,[Z.a,ot.a,c.u,it.a]),c._11(4608,Zt.a,Zt.a,[st.a,Z.a]),c._11(5120,vt.g,Jt.c,[vt.r,[2,vt.a],Z.a]),c._11(4608,vt.f,vt.f,[vt.g]),c._11(5120,Vt.b,Vt.d,[st.a,Vt.a]),c._11(5120,St.a,St.b,[st.a,Vt.b,vt.f,Wt.b,c.i]),c._11(4608,Xt.a,Xt.a,[st.a,Z.a,St.a]),c._11(4608,Qt.a,Qt.a,[st.a,Z.a]),c._11(4608,$t.a,$t.a,[st.a,Z.a,St.a]),c._11(4608,te.a,te.a,[Z.a,ot.a,it.a,st.a,at.l]),c._11(4608,Pt.a,Pt.a,[st.a,Z.a]),c._11(4608,Tt.a,Tt.a,[ot.a,Z.a]),c._11(5120,ee.a,ee.c,[ee.b]),c._11(4608,Lt.a,Lt.a,[p.c,$.a,Zt.a,Pt.a]),c._11(5120,Nt.a,r,[ee.a]),c._11(4608,ne.a,ne.a,[Lt.a,Nt.a,ee.a,$.a,Pt.a]),c._11(4608,g.a,g.a,[]),c._11(4608,Ct.a,Ct.a,[Lt.a,ot.a,ne.a,ee.a,$.a,g.a,Pt.a]),c._11(4608,L.a,L.a,[]),c._11(4608,kt.a,kt.a,[Ct.a,Nt.a,L.a]),c._11(4608,oe.a,oe.a,[Lt.a,ne.a,Zt.a,Pt.a]),c._11(4608,It.a,It.a,[Lt.a,oe.a,ne.a,Ct.a,ee.a,$.a]),c._11(4608,Et.a,Et.a,[Lt.a,It.a,Nt.a,ne.a,ee.a]),c._11(4608,Ft.a,Ft.a,[Lt.a,It.a,oe.a,ne.a,Nt.a,ee.a]),c._11(4608,h.a,h.a,[]),c._11(4608,f.a,f.a,[]),c._11(4608,m.a,m.a,[]),c._11(4608,y.a,y.a,[]),c._11(4608,_.a,_.a,[]),c._11(4608,v.a,v.a,[]),c._11(4608,b.a,b.a,[]),c._11(4608,O.a,O.a,[]),c._11(4608,P.a,P.a,[]),c._11(4608,N.a,N.a,[]),c._11(4608,k.a,k.a,[]),c._11(4608,C.a,C.a,[]),c._11(4608,I.a,I.a,[]),c._11(512,vt.b,vt.b,[]),c._11(512,c.k,re.a,[]),c._11(256,Z.b,{preloadModules:!0},[]),c._11(1024,ae.a,ae.b,[]),c._11(1024,ot.a,ot.b,[u.b,ae.a,c.u]),c._11(1024,Z.a,Z.c,[Z.b,ot.a]),c._11(512,it.a,it.a,[ot.a]),c._11(512,X.a,X.a,[]),c._11(512,st.a,st.a,[Z.a,ot.a,[2,X.a]]),c._11(512,at.l,at.l,[st.a]),c._11(256,Vt.a,{links:[{loadChildren:"../pages/account/account.module.ngfactory#AccountPageModuleNgFactory",name:"AccountPage",segment:"account",priority:"low",defaultHistory:[]},{loadChildren:"../pages/author/author.module.ngfactory#AuthorPageModuleNgFactory",name:"AuthorPage",segment:"author",priority:"low",defaultHistory:[]},{loadChildren:"../pages/explore/explore.module.ngfactory#ExplorePageModuleNgFactory",name:"ExplorePage",segment:"explore",priority:"high",defaultHistory:[]},{loadChildren:"../pages/feed/feed.module.ngfactory#FeedPageModuleNgFactory",name:"FeedPage",segment:"feed",priority:"high",defaultHistory:[]},{loadChildren:"../pages/following/following.module.ngfactory#FollowingPageModuleNgFactory",name:"FollowingPage",segment:"following",priority:"low",defaultHistory:[]},{loadChildren:"../pages/history/history.module.ngfactory#HistoryPageModuleNgFactory",name:"HistoryPage",segment:"history",priority:"high",defaultHistory:[]},{loadChildren:"../pages/list-create/list-create.module.ngfactory#ListCreatePageModuleNgFactory",name:"ListCreatePage",segment:"list-create",priority:"low",defaultHistory:[]},{loadChildren:"../pages/list-list/list-list.module.ngfactory#ListListPageModuleNgFactory",name:"ListListPage",segment:"list-list",priority:"high",defaultHistory:[]},{loadChildren:"../pages/list-view/list-view.module.ngfactory#ListViewPageModuleNgFactory",name:"ListViewPage",segment:"list-view",priority:"low",defaultHistory:[]},{loadChildren:"../pages/login/login.module.ngfactory#LoginPageModuleNgFactory",name:"LoginPage",segment:"login",priority:"low",defaultHistory:[]},{loadChildren:"../pages/search/search-popover.module.ngfactory#SearchPopoverModuleNgFactory",name:"SearchPopover",segment:"search-popover",priority:"low",defaultHistory:[]},{loadChildren:"../pages/search/search.module.ngfactory#SearchPageModuleNgFactory",name:"SearchPage",segment:"search",priority:"high",defaultHistory:[]},{loadChildren:"../pages/settings/settings.module.ngfactory#SettingsPageModuleNgFactory",name:"SettingsPage",segment:"settings",priority:"low",defaultHistory:[]},{loadChildren:"../pages/story-detail/story-detail.module.ngfactory#StoryDetailPageModuleNgFactory",name:"StoryDetailPage",segment:"story-detail",priority:"low",defaultHistory:[]},{loadChildren:"../pages/story-related/story-related.module.ngfactory#StoryRelatedPageModuleNgFactory",name:"StoryRelatedPage",segment:"story-related",priority:"low",defaultHistory:[]},{loadChildren:"../pages/story-series/story-series.module.ngfactory#StorySeriesPageModuleNgFactory",name:"StorySeriesPage",segment:"story-series",priority:"low",defaultHistory:[]},{loadChildren:"../pages/story-view/story-popover.module.ngfactory#StoryPopoverModuleNgFactory",name:"StoryPopover",segment:"story-popover",priority:"low",defaultHistory:[]},{loadChildren:"../pages/story-view/story-view.module.ngfactory#StoryViewPageModuleNgFactory",name:"StoryViewPage",segment:"story-view",priority:"low",defaultHistory:[]},{loadChildren:"../pages/tabs/tabs.module.ngfactory#TabsPageModuleNgFactory",name:"TabsPage",segment:"tabs",priority:"high",defaultHistory:[]},{loadChildren:"../pages/top-list/top-list.module.ngfactory#TopListPageModuleNgFactory",name:"TopListPage",segment:"top-list",priority:"low",defaultHistory:[]},{loadChildren:"../parts/bookmark-popover/bookmark-popover.module.ngfactory#BookmarkPopoverModuleNgFactory",name:"BookmarkPopover",segment:"bookmark-popover",priority:"low",defaultHistory:[]},{loadChildren:"../parts/export-popover/export-popover.module.ngfactory#ExportPopoverModuleNgFactory",name:"ExportPopover",segment:"export-popover",priority:"low",defaultHistory:[]}]},[]),c._11(512,c.h,c.h,[]),c._11(512,ie.a,ie.a,[c.h]),c._11(1024,Wt.b,Wt.c,[ie.a,c.o]),c._11(1024,c.c,function(t,e,n,o,r,a,i,s,l,c,p,d,h){return[u.s(t),se.a(e),Kt.b(n,o),te.b(r,a,i,s,l),Wt.d(c,p,d,h)]},[[2,c.t],Z.a,ot.a,it.a,Z.a,ot.a,it.a,st.a,at.l,Z.a,Vt.a,Wt.b,c.u]),c._11(512,c.d,c.d,[[2,c.c]]),c._11(131584,c.f,c.f,[c.u,c.T,c.o,c.k,c.i,c.d]),c._11(512,c.e,c.e,[c.f]),c._11(512,u.a,u.a,[[3,u.a]]),c._11(512,d.a,d.a,[]),c._11(512,p.e,p.e,[]),c._11(512,p.d,p.d,[]),c._11(512,T.a,T.a,[]),c._11(512,Rt.p,Rt.p,[]),c._11(512,Rt.g,Rt.g,[]),c._11(512,Rt.n,Rt.n,[]),c._11(512,Jt.a,Jt.a,[]),c._11(512,w.a,w.a,[]),c._11(512,M,M,[]),c._11(256,p.l,"XSRF-TOKEN",[]),c._11(256,p.m,"X-XSRF-TOKEN",[]),c._11(256,$.c,void 0,[]),c._11(256,$.b,void 0,[]),c._11(256,x.a,F,[]),c._11(256,vt.a,"/",[]),c._11(256,ee.b,null,[])])}),ue=this;window.consoleLog=[],console=new Proxy(console,{get:function(t,e){var n=t[e];return function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];var r=n.apply(ue,t);try{window.consoleLog.push(JSON.parse(JSON.stringify({prop:e,args:t}))),window.consoleLog.length>75&&window.consoleLog.shift()}catch(t){}return r}}}),console.info("App started",(new Date).getTime()),Object(c.M)(),Object(u.j)().bootstrapModuleFactory(le)},52:function(t,e,n){"use strict";n.d(e,"a",function(){return s});n(0);var o=n(61),r=(n.n(o),n(359)),a=(n.n(r),n(681)),i=(n.n(a),n(41),n(57),n(50),n(69)),s=(n(37),n(54),function(){function t(t,e,n,o,r){var a=this;this.api=t,this.settings=e,this.storage=n,this.translate=o,this.toastCtrl=r,this.ready=new Promise(function(t,e){Promise.all([a.settings.load(),a.storage.get(i.i)]).then(function(e){!a.settings.allSettings.offlineMode&&e[1]&&(a.user=e[1],a.user.date+31104e6<(new Date).getTime()&&setTimeout(function(){a.translate.get(["SESSIONTIMEOUT_MSG","CLOSE_BUTTON"]).subscribe(function(t){a.toastCtrl.create({message:t.SESSIONTIMEOUT_MSG,showCloseButton:!0,closeButtonText:t.CLOSE_BUTTON,duration:15e3}).present(),a.removeStoredUser()})},2e3)),t()})})}return t.prototype.onReady=function(){return this.ready},t.prototype.login=function(t){var e=this,n=this.api.showLoader(),r=new FormData;return r.append("username",t.username),r.append("password",String(a.Md5.hashStr(t.password))),this.api.post("2/auth/login",r,void 0,!0).map(function(r){if(!r.success)throw n&&n.dismiss(),o.Observable.throw(r);e.processAndGetMoreInfo(r,t),n&&n.dismiss()})},t.prototype.processAndGetMoreInfo=function(t,e){this.user={id:t.login.user.user_id,username:t.login.user.username,session:t.login.session_id,date:(new Date).getTime()},this.storage.set(i.i,this.user);var n=new FormData;n.append("command","Login"),n.append("uname",e.username),n.append("pwd",e.password),this.api.post("members/login.php",n,{withCredentials:!0},void 0,2).subscribe()},t.prototype.isLoggedIn=function(){return this.user&&!this.settings.allSettings.offlineMode},t.prototype.getId=function(){return this.user.id},t.prototype.getName=function(){return this.user.username},t.prototype.getSession=function(){return this.user.session},t.prototype.getDetails=function(){return this.user},t.prototype.checkIfEverythingIsFucked=function(){var t=this;return new Promise(function(e){t.storage.get(i.i).then(function(n){JSON.stringify(t.user)!==JSON.stringify(n)?e(!0):e(!1)})})},t.prototype.removeStoredUser=function(){this.storage.remove(i.i),this.storage.remove(i.a)},t.prototype.logout=function(){this.user=null,this.removeStoredUser(),window.location.reload()},t}())},54:function(t,e,n){"use strict";n.d(e,"a",function(){return o});n(0),n(41);var o=function(){function t(t,e){this.storage=t,this.SETTINGS_KEY="_settings",this.settings={},this._defaults=e}return t.prototype.load=function(){var t=this;return this.storage.get(this.SETTINGS_KEY).then(function(e){return e?(t.settings=e,t._mergeDefaults(t._defaults)):t.setAll(t._defaults).then(function(e){t.settings=e})})},t.prototype._mergeDefaults=function(t){for(var e in t)e in this.settings||(this.settings[e]=t[e]);return this.setAll(this.settings)},t.prototype.merge=function(t){for(var e in t)this.settings[e]=t[e];return this.save()},t.prototype.setValue=function(t,e){return this.settings[t]=e,this.storage.set(this.SETTINGS_KEY,this.settings)},t.prototype.setAll=function(t){return this.storage.set(this.SETTINGS_KEY,t)},t.prototype.getValue=function(t){return this.storage.get(this.SETTINGS_KEY).then(function(e){return e[t]})},t.prototype.save=function(){return this.setAll(this.settings)},Object.defineProperty(t.prototype,"allSettings",{get:function(){return this.settings},enumerable:!0,configurable:!0}),t}()},66:function(t,e,n){"use strict";n.d(e,"a",function(){return l});n(0);var o=n(61),r=(n.n(o),n(41),n(50),n(394)),a=n(69),i=(n(94),n(52),n(68),n(37),this&&this.__assign||Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++){e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t}),s=function(t){var e=document.createElement("textarea");e.innerHTML=t;return e.value},l=function(){function t(t,e,n,o,r,i){var s=this;this.api=t,this.a=e,this.user=n,this.g=o,this.storage=r,this.translate=i,this.stories=new Map,this.ready=new Promise(function(t,e){s.storage.keys().then(function(e){if(e.length<1)t();else{var n=e.length-1;s.storage.forEach(function(e,o,r){0===o.indexOf(a.h)&&s.stories.set(e.id,e),r===n&&t()})}})})}return t.prototype.onReady=function(){return this.ready},t.prototype.searchStory=function(t,e,n,o){var r=i({q:t},e);return e.astags?this.tagsearch(r,n):this.newsearch(r,n)},t.prototype.getSeries=function(t){var e=[{property:"series_id",value:parseInt(t)}];return this.search(e)},t.prototype.getRelated=function(t){var e=[{property:"related_id",value:parseInt(t)}];return this.search(e)},t.prototype.getAuthorStories=function(t,e){var n=[{property:"user_id",value:parseInt(t)},{property:"type",value:"story"}];return this.search(n,e,null,null,"1/user-submissions")},t.prototype.getAuthorFavs=function(t,e){var n=[{property:"user_id",value:parseInt(t)},{property:"type",value:"story"}];return this.search(n,e,null,null,"1/user-favorites")},t.prototype.getTop=function(t,e){var n=[{property:"type",value:"story"}];return t&&n.push({property:"category_id",value:parseInt(t)}),this.search(n,e,null,null,"1/top")},t.prototype.getNew=function(t,e){var n=[{property:"type",value:"story"},{property:"newonly",value:"yes"}];return t&&n.push({property:"category_id",value:parseInt(t)}),this.search(n,e)},t.prototype.getById=function(t,e,n){var a=this;void 0===e&&(e=!1),void 0===n&&(n=!1);var i=this.stories.get(t);if(i&&!e&&i.length)return o.Observable.of(i);var s=[{property:"submission_id",value:parseInt(t)}],l={filter:JSON.stringify(s).trim()},u=this.api.showLoader();return this.api.get("2/submissions/pages",l).map(function(t){if(u&&!n&&u.dismiss(),!t.success)return a.api.showToast(),null;i?e&&(i.title=t.pages[0].name,i.url=t.pages[0].url,i.ratingenabled=t.pages[0].allow_vote):i=new r.a({id:t.pages[0].submission_id,title:t.pages[0].name,url:t.pages[0].url,ratingenabled:t.pages[0].allow_vote});var o=t.pages[0].tags?t.pages[0].tags.sort(function(t,e){return e.submission_count-t.submission_count}).map(function(t){return t.name}):[];return i.series=t.pages[0].series_id,i.lang=t.pages[0].lang,i.length=t.total,i.tags=o,i.content=t.pages.map(function(t){return t.content}),a.stories.set(i.id,i),i}).catch(function(e){return u&&u.dismiss(),a.api.showToast(),console.error("stories.getById",[t],e),o.Observable.of(null)})},t.prototype.rate=function(t,e){var n=this,r=[{property:"submission_id",value:parseInt(t.id)}],a=new FormData;a.append("user_id",this.user.getId()),a.append("session_id",this.user.getSession()),a.append("vote",String(e)),a.append("filter",JSON.stringify(r)),this.api.post("2/submissions/vote",a,void 0,!0).catch(function(n){return console.error("stories.rate",[t,e],n),o.Observable.throw(n)}).subscribe(function(o){o.success?t.myrating=e:o.error?n.api.showToast(o.error):n.api.showToast()})},t.prototype.downloadSeries=function(t){var e=this;return this.api.showLoader(),new Promise(function(n){var o=function(r){if(r>=t.length)return e.api.hideLoader(),void n();t[r].cached?(e.download(t[r]),e.api.updateLoader(Math.round(r+1/t.length*100)+"%"),o(r+1)):e.getById(t[r].id,!1,!0).subscribe(function(n){if(!n)return e.translate.get(["SERIES_DOWNLOAD_ERROR"]).subscribe(function(t){e.api.showToast(t.SERIES_DOWNLOAD_ERROR)}),void e.api.hideLoader();e.download(n),e.api.updateLoader(Math.round(r+1/t.length*100)+"%"),o(r+1)})};o(0)})},t.prototype.search=function(t,e,n,r,a){var i,s=this,l={page:e||1,filter:JSON.stringify(t)};return(!e||e<2)&&(i=this.api.showLoader()),this.api.get(a||"1/submissions",l,null,r).map(function(t){return i&&i.dismiss(),t.success||t.submissions?[t.submissions?t.submissions.map(function(t){return s.extractFromSearch(t)}):[],t.total]:(t.hasOwnProperty("total")||s.api.showToast(),[[],0])}).catch(function(r){return i&&i.dismiss(),s.api.showToast(),console.error("stories.search",[t,e,n],r),o.Observable.of([[],0])})},t.prototype.newsearch=function(t,e,n,r,a){var s=this;void 0===a&&(a=!1),a?Array.isArray(t.category)&&(t.category=parseInt(t.category[0])):(t.category&&(t.categories=t.category.map(function(t){return parseInt(t)})),delete t.category);var l,u={params:JSON.stringify(i({page:e||1},t))};return(!e||e<2)&&(l=this.api.showLoader()),this.api.get(r||"3/search/stories",u,null,n).map(function(t){l&&l.dismiss();var e=a?t.submissions:t.data,n=a?t.meta.submissions_count:t.meta.total;return e?[e.map(function(t){return s.extractFromNewSearch(t)}),n]:(n||s.api.showToast(),[[],0])}).catch(function(n){return l&&l.dismiss(),s.api.showToast(),console.error("stories.newsearch",[t,e,a],n),o.Observable.of([[],0])})},t.prototype.tagsearch=function(t,e,n,o){var r=this,a={params:JSON.stringify({tags:t.q.split(",").map(function(t){return t.trim()})})};return delete t.q,(!e||e<2)&&this.api.showLoader(),this.api.get(o||"3/tagsportal/by-name",a,null,n).map(function(t){return t.map(function(t){return t.id})}).mergeMap(function(n){var o=i({tags:n,sort_by:t.sort},t);return r.newsearch(o,e,0,"3/tagsportal/stories",!0)})},t.prototype.download=function(t){t.downloaded=!0,t.downloadedtimestamp=new Date,t.cached=!0,this.storage.set(a.h+"_"+t.id,t)},t.prototype.undownload=function(t){t.downloaded=!1,t.downloadedtimestamp=null,t.cached?this.storage.set(a.h+"_"+t.id,t):this.storage.remove(a.h+"_"+t.id)},t.prototype.cache=function(t){t.cached=!0,this.storage.set(a.h+"_"+t.id,t)},t.prototype.uncache=function(t){t.cached=!1,t.downloaded=!1,this.storage.remove(a.h+"_"+t.id)},t.prototype.extractFromFeed=function(t){var e=this.stories.get(t.what.id);if(e)return e;var n=this.a.extractFromFeed(t.who),o=new r.a({author:n,id:t.what.id.toString(),title:t.what.title,description:t.what.description,category:s(t.what.category_info.name),lang:this.g.getLanguage(t.what.language),timestamp:t.when,rating:t.what.rate_all,viewcount:t.what.view_count,url:t.what.url,tags:t.what.tags?t.what.tags.map(function(t){return t.tag}):[],ishot:t.what.is_hot,isnew:t.what.is_new,iswriterspick:t.what.writers_pick,iscontestwinner:t.what.contest_winner,commentsenabled:t.what.enable_comments,ratingenabled:t.what.allow_vote});return this.stories.set(o.id,o),o},t.prototype.extactFromList=function(t){var e=this.stories.get(t.id);if(e)return e;var n=this.a.extractFromFeed(t.author),o=new r.a({author:n,id:t.id.toString(),title:t.title,description:t.description,category:s(t.category_info.name),lang:this.g.getLanguage(t.language),timestamp:Math.round(Date.parse(t.date_added)/1e3),rating:t.rate_all,viewcount:t.view_count,url:t.url,tags:t.tags?t.tags.map(function(t){return t.tag}):[],ishot:t.is_hot,isnew:t.is_new,iswriterspick:t.writers_pick,iscontestwinner:t.contest_winner,commentsenabled:t.enable_comments>0,ratingenabled:t.allow_vote});return this.stories.set(o.id,o),o},t.prototype.extractFromSearch=function(t){var e=this.stories.get(t.id);if(e)return e;var n=this.a.extractFromSearch(t.user),o=new r.a({author:n,id:t.id.toString(),title:t.name,description:t.description,category:t.category.name,lang:t.lang,timestamp:t.timestamp_published,rating:t.rate,viewcount:t.view_count,url:t.url,ishot:"no"!==t.is_hot,isnew:"no"!==t.is_new,iswriterspick:"no"!==t.writers_pick,iscontestwinner:"no"!==t.contest_winner,commentsenabled:t.enable_comments>0,ratingenabled:t.allow_vote>0});return this.stories.set(o.id,o),o},t.prototype.extractFromNewSearch=function(t){var e=this.stories.get(t.id);if(e)return e;var n=t.date_approve.split("/"),o=this.a.extractFromNewSearch(t.author),a=new r.a({author:o,id:t.id.toString(),title:t.title,description:t.description,category:s(t.category_info.name),lang:this.g.getLanguage(t.language),timestamp:Math.round(Date.parse(n[2]+"-"+n[0]+"-"+n[1]+"T00:00:00")/1e3),rating:t.rate_all,viewcount:t.view_count,url:t.url,ishot:t.is_hot,isnew:t.is_new,iswriterspick:t.writers_pick,iscontestwinner:t.contest_winner>0,commentsenabled:t.enable_comments>0,ratingenabled:t.allow_vote>0});return this.stories.set(a.id,a),a},t}()},68:function(t,e,n){"use strict";n.d(e,"a",function(){return a});n(0);var o=n(61),r=(n.n(o),n(41),n(50),n(138),n(57),n(37),n(52),n(69)),a=function(){function t(t,e,n,o,a,i,s){var l=this;this.api=t,this.platform=e,this.user=n,this.storage=o,this.translate=a,this.browser=i,this.toastCtrl=s,this.version=16,this.storage.get(r.j).then(function(t){t&&t!==l.version&&setTimeout(function(){l.translate.get(["UPDATED_MSG","CLOSE_BUTTON"]).subscribe(function(t){l.toastCtrl.create({message:t.UPDATED_MSG,showCloseButton:!0,closeButtonText:t.CLOSE_BUTTON,duration:15e3}).present(),l.user.removeStoredUser()})},2e3),l.storage.set(r.j,l.version)}),this.ready=new Promise(function(t,e){l.storage.get(r.b).then(function(e){e?(l.globals=e,t()):l.query().subscribe(function(){t()})})})}return t.prototype.onReady=function(){return this.ready},t.prototype.getCategories=function(){return[{id:"37",name:"Anal"},{id:"31",name:"BDSM"},{id:"27",name:"Celebrities & Fan Fiction"},{id:"28",name:"Chain Stories"},{id:"2",name:"Erotic Couplings"},{id:"51",name:"Erotic Horror"},{id:"4",name:"Exhibitionist & Voyeur"},{id:"5",name:"Fetish"},{id:"40",name:"First Time"},{id:"6",name:"Gay Male"},{id:"7",name:"Group Sex"},{id:"8",name:"How To"},{id:"34",name:"Humor & Satire"},{id:"45",name:"Illustrated"},{id:"9",name:"Incest/Taboo"},{id:"10",name:"Interracial Love"},{id:"11",name:"Lesbian Sex"},{id:"53",name:"Letters & Transcripts"},{id:"12",name:"Loving Wives"},{id:"26",name:"Mature"},{id:"29",name:"Mind Control"},{id:"32",name:"Non-English"},{id:"35",name:"Non-Erotic"},{id:"13",name:"NonConsent/Reluctance"},{id:"14",name:"NonHuman"},{id:"33",name:"Novels and Novellas"},{id:"3",name:"Reviews & Essays"},{id:"15",name:"Romance"},{id:"38",name:"Sci-Fi & Fantasy"},{id:"39",name:"Text With Audio"},{id:"16",name:"Toys & Masturbation"},{id:"48",name:"Transsexuals & Crossdressers"}]},t.prototype.getLanguage=function(t){var e=this;return this.globals.languages?Object.keys(this.globals.languages).filter(function(n){var o=e.globals.languages[n];if(parseInt(o.id)===t)return o.shortname})[0]:null},t.prototype.getPopularTags=function(){return this.api.get("3/tagsportal/top",{limit:100,periodCheck:!1,period:"all"})},t.prototype.getVersion=function(){return this.version},t.prototype.checkForUpdates=function(){var t=this;this.api.get("app.json",void 0,void 0,3).catch(function(t){return console.error("globals.checkForUpdates",t),o.Observable.of(!1)}).subscribe(function(e){t.translate.get(["UPDATE_FAILEDMSG","UPDATE_MSG","DOWNLOAD_BUTTON"]).subscribe(function(n){e?(e.appid!==t.api.appid&&(t.api.appid=e.appid),e.apikey!==t.api.apikey&&(t.api.apikey=e.apikey),e.version>t.version&&t.platform.is("cordova")&&t.api.showToast(n.UPDATE_MSG,15e3,n.DOWNLOAD_BUTTON).then(function(n){t.browser.openUrl(e.updatelink||"https://theilluminatus.github.io/litapp")})):t.api.showToast(n.UPDATE_FAILEDMSG)})})},t.prototype.query=function(){var t=this;if(this.globals)return o.Observable.of(this.globals);var e=this.api.showLoader();return this.api.get("3/constants",null,null,null,1e4).map(function(n){return e&&e.dismiss(),n?(t.globals=n,t.storage.set(r.b,t.globals),t.globals):(t.api.showToast(),null)}).catch(function(n){return e&&e.dismiss(),t.api.showToast(),console.error("globals.query",n),o.Observable.of(null)})},t}()},69:function(t,e,n){"use strict";n.d(e,"f",function(){return o}),n.d(e,"e",function(){return r}),n.d(e,"g",function(){return a}),n.d(e,"c",function(){return i}),n.d(e,"h",function(){return s}),n.d(e,"i",function(){return l}),n.d(e,"a",function(){return u}),n.d(e,"d",function(){return c}),n.d(e,"b",function(){return p}),n.d(e,"j",function(){return d});var o="_queries",r="_recentqueries",a="_storystyle",i="_history",s="_story",l="_user",u="_feed",c="_list",p="_globals",d="_version"},94:function(t,e,n){"use strict";n(0),n(1),n(57);var o=n(61),r=function(){return function(t){for(var e in t)this[e]=t[e]}}();n(52),n(37);n.d(e,"a",function(){return a});var a=function(){function t(t,e,n,o){this.api=t,this.user=e,this.loadingCtrl=n,this.toastCtrl=o,this.authors=new Map}return t.prototype.getDetails=function(t){var e=this,n=[{property:"user_id",value:t}],a={filter:JSON.stringify(n).trim()},i=this.authors.get(t);if(i&&i.bio)return o.Observable.of(i);var s=this.api.showLoader();return this.api.get("1/user-bio",a).map(function(t){return s&&s.dismiss(),t.success?(i||(i=new r({id:t.user.profile.id,picture:t.user.profile.userpic,name:t.user.profile.username})),i.storycount=t.user.profile.submissions_count,i.bio=t.user.profile.description,e.authors.set(i.id,i),i):(e.api.showToast(),null)}).catch(function(n){return s&&s.dismiss(),e.api.showToast(),console.error("author.getDetails",[t],n),o.Observable.of(null)})},t.prototype.getFollowing=function(){var t=this,e=this.api.showLoader();return this.api.get("3/users/"+this.user.getId()+"/favorite/authors?params={%22nocache%22:true}").map(function(n){return e&&e.dismiss(),n.length?n.map(function(e){return t.extractFromFeed(e)}):(t.api.showToast(),[])}).catch(function(n){return e&&e.dismiss(),t.api.showToast(),console.error("author.getFollowing",n),o.Observable.of([])})},t.prototype.follow=function(t){var e=this,n=new FormData;return n.append("type","member"),n.append("id",t.id),this.api.post("3/users/follow/"+t.id,{}).map(function(t){return t.success||e.api.showToast(),t.success}).catch(function(n){return e.api.showToast(),console.error("author.follow",[t],n),o.Observable.of(!1)}).subscribe(function(n){n?t.following=!0:e.api.showToast()})},t.prototype.unfollow=function(t){var e=this;return this.api.delete("3/users/follow/"+t.id).map(function(t){return t.success||e.api.showToast(),t.success}).catch(function(n){return e.api.showToast(),console.error("author.unfollow",[t],n),o.Observable.of(!1)}).subscribe(function(e){e&&(t.following=!1)})},t.prototype.extractFromFeed=function(t){var e=this.authors.get(t.id);return e&&e.updatetimestamp?e:(e||(e=new r({id:t.userid,name:t.username,picture:t.userpic})),e.jointimestamp=t.joindate,e.following=!0,this.authors.set(e.id,e),e)},t.prototype.extractFromSearch=function(t){var e=this.authors.get(t.id);if(e)return e;var n=new r({id:t.id,name:t.username,picture:t.userpic});return this.authors.set(n.id,n),n},t.prototype.extractFromNewSearch=function(t){var e=this.authors.get(t.userid);if(e)return e;var n=new r({id:t.userid,name:t.username,picture:t.userpic});return this.authors.set(n.id,n),n},t}()}},[404]);